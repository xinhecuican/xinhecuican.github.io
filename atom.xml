<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Xinhecuican&#39;s Blog</title>
  
  
  <link href="http://xinhecuican.github.io/atom.xml" rel="self"/>
  
  <link href="http://xinhecuican.github.io/"/>
  <updated>2021-04-23T10:23:35.198Z</updated>
  <id>http://xinhecuican.github.io/</id>
  
  <author>
    <name>星河璀璨</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hadoop和Spark</title>
    <link href="http://xinhecuican.github.io/post/8ecb5fd.html"/>
    <id>http://xinhecuican.github.io/post/8ecb5fd.html</id>
    <published>2021-04-22T00:12:00.000Z</published>
    <updated>2021-04-23T10:23:35.198Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="mapreduce"><a class="markdownIt-Anchor" href="#mapreduce"></a> Mapreduce</h1><p>mapreduce是一种编程模型，它的基本思想就是分而治之。</p><p>map()负责将一个任务分解成若干个小的任务，这些小的任务可以交给不同的计算节点去处理，Reduce()负责把这些计算结果进行合并。</p><p>例如统计词频：</p><figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">a</span> <span class="selector-tag">a</span> <span class="selector-tag">a</span></span><br><span class="line"><span class="selector-tag">aa</span> </span><br><span class="line"><span class="selector-tag">aaa</span></span><br><span class="line"><span class="selector-tag">bc</span></span><br><span class="line"><span class="selector-tag">de</span></span><br><span class="line"><span class="selector-tag">bc</span></span><br><span class="line"><span class="selector-tag">abc</span></span><br><span class="line"><span class="selector-tag">abc</span></span><br><span class="line">想要统计这些次出现的次数</span><br><span class="line"></span><br><span class="line">首先进行<span class="selector-tag">map</span>，例如有<span class="selector-tag">4</span>个工作节点，我们可以把每两行给一个工作节点，然后这些工作节点就会进行词频统计，最后得到</span><br><span class="line"></span><br><span class="line">(<span class="string">&#x27;a&#x27;</span>, <span class="number">3</span>), (<span class="string">&#x27;aa&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">(<span class="string">&#x27;aaa&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;bc&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">(<span class="string">&#x27;de&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;bc&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">(<span class="string">&#x27;abc&#x27;</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">之后把这些计算结果发给主节点，然后主节点进行<span class="selector-tag">reduce</span>， 也就是把各个工作节点产生的结果组合到一起。</span><br><span class="line"></span><br><span class="line">(<span class="string">&#x27;a&#x27;</span>, <span class="number">3</span>), (<span class="string">&#x27;aa&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;aaa&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;bc&#x27;</span>, <span class="number">2</span>), (<span class="string">&#x27;de&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;abc&#x27;</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>map和reduce都可以并行化执行，也就是说map结果可以发给多个节点，然后多个节点每个处理部分工作。</p><h1 id="hadoop"><a class="markdownIt-Anchor" href="#hadoop"></a> hadoop</h1><p>hadoop是mapreduce思想的具体实现，它有自己专门的文件管理系统和任务分配系统。</p><h2 id="分布式文件系统hdfs"><a class="markdownIt-Anchor" href="#分布式文件系统hdfs"></a> 分布式文件系统（HDFS)</h2><p><img src="/images/Hadoop1.jpg" alt="" /></p><ul><li>block： hdfs中数据存储的基本单位事一个block，一般来说block的大小是64mb。块大小这么大的好处有： （1） 减少磁盘寻道时间，增加读取效率 （2）减少namenode存储开销 （3） 减少建立网络的连接成本。 但是如果里面全是小文件的话，会造成大量的空间浪费</li><li>NameNode: namenode是数据的管理者，它存储着文件的metadata<sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="存储着块位置，块大小和块权限信息">[1]</span></a></sup>。一个block对应着namenode中的一条记录。并且他会不定时的存储到本地磁盘上，但不保存metadata的位置信息，而是由datanode上传这些信息</li><li>datanode： 具体存储block数据。它负责数据的读写操作。datanode会定时发送心跳报告存储的数据块信息</li><li>client： 需要获取文件的应用程序</li></ul><p>写入文件过程：</p><ol><li>client向namenode发起文件写入请求</li><li>namenode创建一个文件，并且把blockid和要写入的datanode列表发给client</li><li>client接收到信息后，会把文件写入datanodes<ol><li>客户端写入第一个datanodes</li><li>第一个datanodes写入第二个datanodes，以此类推。每次写入都会发送确认给前一个datanode，最后第一个datanode发送给客户端确认信息</li><li>客户端给namenode发送确认信息</li></ol></li></ol><p><img src="/images/dadoop2.png" alt="" /></p><p>读取文件过程：</p><ol><li>客户端向namenode发送请求</li><li>namenode返回该文件的所有block和block所在的datanodes</li><li>客户端直接读取</li></ol><p>hdfs还有一些安全策略，如检验和，副本（一般是三个副本），心跳检测，机架感知等等</p><h2 id="资源管理系统yarn"><a class="markdownIt-Anchor" href="#资源管理系统yarn"></a> 资源管理系统（yarn）</h2><p>旧有的资源管理系统</p><p><img src="/images/hadoop3.jpg" alt="" /></p><ul><li>Jobtracker: 负责资源管理，跟踪资源消耗和可用性，作业生命周期管理（调度作业任务，跟踪进度，为任务提供容错）</li><li>tasktracker: 加载或关闭任务，报告任务状态</li></ul><p>但是他有一些问题：</p><ul><li>Jobtracker存在单点故障，如果它出问题整个系统都不能运行</li><li>jobtracker完成了太多任务</li><li>tasktracker将任务强制划分成了map slot和reduce slot。如果系统中只有map或reduce就会带来资源的浪费</li></ul><p>yarn针对这些问题做出了一些改进，他将jobtracker的职责进行了拆分，分成了资源管理和任务调度两个部分。</p><p><img src="/images/hadoop4.jpg" alt="" /></p><ul><li>ResourceManager: 全局资源调度</li><li>NodeNamager： 单个节点的资源管理</li><li>ApplicationManager： 单个作业管理。主要是创建一系列的监控进程来跟踪作业的进度，同时获取输入分片，为每一个分片创建一个 Map task 和相应的 reduce task Application Master 还决定如何运行作业，如果作业很小（可配置），则直接在同一个 JVM 下运行</li><li>container： 资源申请的单位和任务运行的容器</li></ul><p>具体步骤</p><ol><li>Job submission： 从ResourceManager中获得一个Application ID来检测作业输出配置，计算输入分片，拷贝作业资源（job jar， 配置文件， 分片信息）到HDFS， 以便后面任务的执行</li><li>Job initialization： ResourceManager把作业递交给schedule并且schedule分配一个<strong>container</strong>， 然后ResourceManager加载一个<strong>ApplicationManager</strong>并且给<strong>nodeManager</strong></li><li>taskAssignment： ApplicationManager向Resource Manager申请资源</li><li>task execution: ApplicationMaster 根据 ResourceManager 的分配情况，在对应的 NodeManager 中启动 Container 从 HDFS 中读取任务所需资源（job jar，配置文件等），然后执行该任务</li><li>定时将任务的进度和状态报告给 ApplicationMaster Client 定时向 ApplicationMaster 获取整个任务的进度和状态。client也会定时检测整个作业是否完成，会清空临时文件，目录等。</li></ol><h2 id="mapreduce-2"><a class="markdownIt-Anchor" href="#mapreduce-2"></a> mapreduce</h2><p>大致流程<br /><img src="/images/hadoop6.png" alt="" /></p><p>首先通过inputformat决定数据类型，然后拆分成一个个inputsplit，每一个inpusplit交给一个map执行，RecoderReader读取inputsplit提交给map</p><p><strong>inputformat</strong></p><p>功能：</p><ul><li>验证文件的正确性</li><li>将输入文件进行逻辑分片</li><li>提供RecoderReader的实现，读取inputsplit提交给mapper</li></ul><p>一般是每一行代表一个记录</p><p><strong>inputsplit</strong></p><p>inputsplit并没有真正分片，只是提供了分片的方法，也就是location和length</p><p><strong>map</strong></p><p>当RecoderReader真正将文件分片并且提交到每一个mapper后，mapper开始工作。</p><p>每一个mapper都有循环内存缓冲区（默认100mb），当缓存内容达到80%后，后台线程开始百内容写到文件，同时mapper还可以使用剩下20%的内存。</p><p>每次写文件时都是产生一个新的文件进行写入，并且在写入文件前还会按照reduce的要求进行分区和排序，之后在map结束之后会把这些文件进行合并。合并完成之后reduce就可以来拷贝数据了。</p><p><strong>reduce</strong></p><p>reduce的输入数据就是map的输出数据，这些数据是分布在集群中的，所以只要有任务完成，reduce就会把数据进行拷贝，默认拷贝线程为5.</p><p>当所有map的数据都获得之后，就会开始归并，这个阶段可能要进行多次。例如每次把十个文件归并成1个，如果总共50个文件，那么第一次归并成5个文件，但是第二次就不会再归并了，直接提交给reduce函数。</p><h1 id="spark"><a class="markdownIt-Anchor" href="#spark"></a> spark</h1><p>hadoopmap中间结果需要存入硬盘，即使使用了循环内存缓冲区，但是速度还是很慢。而spark中间结果存储在内存中，并且采用了先进的架构，因此它的速度比hadoop<strong>快十倍到百倍不等</strong>。</p><p>spark支持python和java两种语言，并且它实际上是hadoop的补充，因此也可以用在hadoop上</p><h2 id="rdd"><a class="markdownIt-Anchor" href="#rdd"></a> RDD</h2><p><a href="https://www.cnblogs.com/qingyunzong/p/8899715.html">RDD主要是从这篇博客中学习的</a></p><p>RDD叫弹性分布式数据集，是spark中对数据的抽象，这些数据可以全部或者部分缓存在内存中，在多次计算之间重复利用。</p><p>RDD属性：</p><ul><li>分片（Partition）： 是数据集的基本单位。每一个分片都会当做一个计算任务处理。用户可以在创建RDD时指定分片数目。如果没有指定，其数目为程序所分配的cpu数目。</li><li>计算函数： 每个分片都会运行这个函数</li><li>依赖关系： RDD每次转换都会产生新的RDD，在分区数据丢失时，RDD通过这个依赖关系恢复数据。</li><li>分片函数： 只有(key, value)类型的才会有分片函数。分片函数可以是哈希也可以是一个range</li></ul><p><img src="/images/spark1.png" alt="" /></p><p><strong>创建</strong></p><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">data_from_file</span> = sc.textfile(filename)//从文件中创建</span><br><span class="line"><span class="attr">data</span> = sc.parallelize(array)<span class="comment">; //从集合中创建（可以是数据，也可以是map）</span></span><br></pre></td></tr></table></figure><p><strong>RDD持久化</strong></p><p>如果一个rdd被多次使用，则需要考虑持久化</p><p>持久化之后，下次查询rdd时，就可以被快速访问，不需要计算</p><p>可以使用persist或cache方法进行持久化</p><h2 id="rdd的操作"><a class="markdownIt-Anchor" href="#rdd的操作"></a> RDD的操作</h2><p><img src="/images/spark2.PNG" alt="" /></p><p>RDD的任何transform都是惰性的，也就是说transform时并不会真正执行，只有运行action后才会真正执行。</p><h3 id="transform"><a class="markdownIt-Anchor" href="#transform"></a> transform</h3><p>transform作用在一个RDD上，产生一个新的RDD</p><ul><li>map(func): 返回一个新的rdd，新的rdd中每一个元素都由func转化得来</li><li>filter(func): 新rdd中元素由func计算得true而来</li><li>mapPartitions(func): 类似于map，但是独立的在每一个分片上进行</li><li>mapPartitionsWithIndex(func)</li><li>sample(withReplacement, fraction, seed): 按照fraction比例进行采样，可以指定是否使用随机数进行替换，seed是随机数种子</li><li>union(otherDataset): 合并</li><li>intersection(otherDataset): 交集</li><li>distinct([numtasks]): 补集</li><li>groupByKey([numtasks]): 在一个（K， V）的RDD上调用，返回一个（K，Iterator(V))的RDD</li><li>sortByKey([ascending], [numtasks]): ascending是排序方式，</li><li>sortBy(func, [ascending], [numtasks]):</li><li>join(otherDataset, [numtasks]): 在类型为(K,V)和(K,W)的RDD上调用，返回一个相同key对应的所有元素对在一起的(K,(V,W))的RDD  相当于内连接（求交集）</li><li>pipe(command, [envVars]): 调用外部程序</li><li>reparation(num): 重新分区，num是分区数量</li></ul><h3 id="action"><a class="markdownIt-Anchor" href="#action"></a> Action</h3><ul><li>reduce(func): 通过func</li><li>collect(): 以数组形式返回所有元素</li><li>count(): 返回元素个数</li><li>first(): 返回第一个元素</li><li>take(n): 返回前n个元素</li><li>takesample(): 和上面一样</li><li>saveAsTextFile(filepath):</li><li>countByKey(): 返回一个(K, int)类型的map</li><li>foreach(func): 在数据集每一个元素上，运行func进行更新</li><li>reduce(func): 并行整理RDD中的每个元素，例如RDD中元素为(1, 2, 3, 3),则<code>rdd.reduce((x, y) =&gt; x + y);</code>结果为9</li></ul><h2 id="spark执行过程"><a class="markdownIt-Anchor" href="#spark执行过程"></a> spark执行过程</h2><p>spark的执行可以看成一个DAG（有向无环图）</p><p><img src="/images/spark3.PNG" alt="" /></p><p>我们可以把这些RDD之间的依赖关系分为两种，宽依赖和窄依赖</p><ul><li>窄依赖： 一个父RDD最多被一个子RDD调用，例如map，fliter，union等</li><li>宽依赖： 指子RDD分区依赖于父RDD的所有分区。例如grouByKey, reduceByKey, sort等</li></ul><p><img src="/images/spark4.PNG" alt="" /></p><p>根据依赖关系的不同，spark将一个job分解成不同的stage，stage之间的依赖关系就形成了DAG图。</p><p>一般遇到了宽依赖就划分一个新的stage<div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">存储着块位置，块大小和块权限信息<a href="#fnref:1" rev="footnote"> ↩</a></span></li></ol></div></div></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;mapreduce&quot;&gt;&lt;a class=&quot;markdownIt-A</summary>
      
    
    
    
    <category term="并行计算" scheme="http://xinhecuican.github.io/categories/%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97/"/>
    
    
  </entry>
  
  <entry>
    <title>时序逻辑设计</title>
    <link href="http://xinhecuican.github.io/post/30a5dc7e.html"/>
    <id>http://xinhecuican.github.io/post/30a5dc7e.html</id>
    <published>2021-04-20T10:40:00.000Z</published>
    <updated>2021-04-24T07:04:59.959Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>时序逻辑电路的输出是由上一刻的输出和这一刻的输入共同决定，也就是说时序电路带有记忆。</p><h1 id="锁存器和触发器"><a class="markdownIt-Anchor" href="#锁存器和触发器"></a> 锁存器和触发器</h1><h2 id="双稳态电路"><a class="markdownIt-Anchor" href="#双稳态电路"></a> 双稳态电路</h2><p><img src="/images/%E6%97%B6%E5%BA%8F%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A11.png" alt="" /></p><p>例如Q是1，则经过L1后变为0，因此<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145499999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span> 为0，然后又给L2输入，再回到Q还是1。所以Q始终为1，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145499999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>始终为0，因此称为双稳态电路。</p><p><img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF2.png" alt="" /></p><p>这是它的等价形式，注意这张图是有问题的，L1和L2要变换位置。</p><h2 id="sr锁存器"><a class="markdownIt-Anchor" href="#sr锁存器"></a> SR锁存器</h2><p>上面的双稳态电路不方便输入，因此SR锁存器在双稳态电路上做了改进。<br /><img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF3.png" alt="" /></p><p>如图，添加了R和S两个输入端，当R和S为下列值时，Q输出为</p><table><thead><tr><th>R(reset)</th><th>S(set)</th><th><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">Q^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9657709999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>(Q下一时刻状态)</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>Q</td></tr><tr><td>0</td><td>1</td><td>1</td></tr><tr><td>1</td><td>0</td><td>0</td></tr><tr><td>1</td><td>1</td><td>x</td></tr></tbody></table><p>主要是二者都为1的情况。二者都为1时，Q和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145499999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>都是0，这就违背了Q和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145499999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>的本意。</p><p>并且在二者变成0之后，如果是同时变成0，那么Q和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145499999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>先同时变成1，然后同时变成0，这样来回震荡。</p><p>当然同时改变时不可能的，如果R先变成0，那么Q为1，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145499999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>为0。反之Q为0，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145499999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">Q</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>为1.</p><p>因此二者同时为1时会造成电路不稳定，因此二者同时为一是禁止的。</p><h2 id="d锁存器"><a class="markdownIt-Anchor" href="#d锁存器"></a> D锁存器</h2><p><img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF4.png" alt="" /></p><ul><li>CLK=0, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">Q^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9657709999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span> = Q，也就是锁存器的值不会变化，锁存器是不透明的</li><li>CLK=1， <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">Q^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9657709999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span> = D, 这时候可以把它当成一根导线，锁存器是透明的（没有作用）。</li></ul><p><img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF5.png" alt="" /></p><p>这是他的原理图，他在SR锁存器上做了一些补充，避免了因为S和R同时为1导致的一些奇奇怪怪的现象。</p><h2 id="d触发器"><a class="markdownIt-Anchor" href="#d触发器"></a> D触发器</h2><p><img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF6.png" alt="" /></p><p>D触发器时在CLK从0到1的瞬间对D进行采样，然后一直保持这个状态，知道下一次从0到1才会重新改变。</p><p><img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF7.png" alt="" /></p><p>当CLK=0时，主锁存器开启，也就是说D的状态就是N1的状态，但是从锁存器关闭，总的输出还是上一时刻的输出。</p><p>CLK=1，从0到1的一瞬间把主锁存器关闭，也就是说N1的状态就是D最后时刻的状态，然后从锁存器打开，N1的状态直接输出</p><h3 id="寄存器"><a class="markdownIt-Anchor" href="#寄存器"></a> 寄存器</h3><p>寄存器是由一个共享的CLK控制多个D触发器组成。<img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF8.png" alt="" /></p><h3 id="带使能端的触发器"><a class="markdownIt-Anchor" href="#带使能端的触发器"></a> 带使能端的触发器</h3><p>EN=0时，使能端处于保持状态（也就是CLK=0的状态）。EN=1时，不影响正常工作。</p><p><img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF9.png" alt="" /> <img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF10.png" alt="" /></p><p>如图是两种使能端的实现方式。看起来第二种方法要好，但实际上第一种方法更优。因为第二种方法会影响CLK工作（不同的与门所需时间不同），可能导致原本的同步电路变成异步电路（如上面的寄存器）</p><h3 id="带复位或置位功能的触发器"><a class="markdownIt-Anchor" href="#带复位或置位功能的触发器"></a> 带复位或置位功能的触发器</h3><p>当复位为1时，触发器被置0, 复位为0时不影响电路正常工作。</p><p>复位分为两种形式：</p><ul><li>同步复位： 只在上升沿复位</li><li>异步复位： 只要reset位置1就进行复位</li></ul><p><img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF11.png" alt="" /><br />如图是一种同步复位的实现方式。</p><p>而置位就是将触发器置为1，和复位大致相同。</p><h1 id="同步时序电路"><a class="markdownIt-Anchor" href="#同步时序电路"></a> 同步时序电路</h1><p>同步时序电路中有一个时钟输入，时钟的上升沿表示电路发生改变的时间。当前状态称为<strong>现态</strong>，下一个状态称为<strong>次态</strong>。</p><p>同步时序电路的组成规则</p><ul><li>电路中的模块是寄存器或组合逻辑电路</li><li>模块中至少包含一个寄存器</li><li>所有寄存器都共用一个信号</li><li>电路的每个环路都至少包含一个寄存器</li></ul><p>例如<img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF12.png" alt="" />是同步时序电路，而</p><p><img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF13.png" alt="" />不是时序逻辑电路</p><p>两种常见的同步时序电路： 有限状态机和流水线</p><h2 id="有限状态机"><a class="markdownIt-Anchor" href="#有限状态机"></a> 有限状态机</h2><p><img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF14.png" alt="" /></p><p>这两种有限状态机都受时钟信号的控制，寄存器前面是用来决定下一个状态的，它由输入和当前状态共同决定。而触发器后面就是处理信号模块。</p><p>moore机的输出信号不由输入信号直接决定，并且它只有在时钟上升沿才会发生改变。</p><p>mealy机的输出信号直接由输入信号决定，并且它在任意时刻输出都有可能改变。</p><p>例如： 交通信号灯的设计</p><p>输入： 两个交通传感器 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mi>A</mi></msub><mo separator="true">,</mo><msub><mi>T</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">T_A , T_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.当有人经过时返回True</p><p>输出，两个交通信号灯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mi>A</mi></msub><mo separator="true">,</mo><msub><mi>L</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">L_A , L_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.他们都有红绿黄三种状态</p><p>有一个5s的时钟，当时钟到达时，根据传感器的情况进行改变。此外还有一个复位键。</p><p><img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF15.png" alt="" /></p><ul><li>画状态转换图.如果当前是绿灯并且有行人通过不做改变，如果没有行人通过就变成黄灯，5s后变成红灯</li></ul><p><img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF16.PNG" alt="" /></p><ul><li>画出状态转换图纸后，将其转换为状态转换表</li></ul><table>   <tr>     <td colspan="2">现态</td>     <td colspan="2">输入</td>     <td colspan="2">次态</td>   </tr>   <tr>     <td>S1</td>     <td>S0</td>     <td>Ta</td>     <td>Tb</td>      <td>S1'</td>     <td>S0'</td>   </tr>   <tr>     <td>0</td>     <td>0</td>     <td>0</td>     <td>x</td>     <td>0</td>     <td>1</td>   </tr>   <tr>     <td>0</td>     <td>0</td>     <td>1</td>     <td>x</td>     <td>0</td>     <td>0</td>   </tr>   <tr>     <td>0</td>     <td>1</td>     <td>x</td>     <td>x</td>     <td>1</td>     <td>0</td>   </tr>   <tr>     <td>1</td>     <td>0</td>     <td>x</td>     <td>0</td>     <td>1</td>     <td>1</td>   </tr>   <tr>     <td>1</td>     <td>0</td>     <td>x</td>     <td>1</td>     <td>1</td>     <td>0</td>   </tr>   <tr>     <td>1</td>     <td>1</td>     <td>x</td>     <td>x</td>     <td>0</td>     <td>0</td>   </tr></table><p>我们认为00是S0状态，01是S1状态，以此类推。也就是说四种状态需要两个二进制位，需要两个触发器。</p><p>同理，我们可以画出输出的状态转换表</p><p><img src="/images/%E6%97%B6%E5%BA%8F%E7%94%B5%E8%B7%AF18.png" alt="" /></p><p>由于输出有红绿黄三种状态，所以同样需要两位输出表示状态。用00表示绿，01表示黄，10表示红。</p><ul><li>化简</li></ul><p>当我们把真值表画出来后，就可以用卡诺图或者直接进行化简了。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>S</mi><mn>1</mn><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>S</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>S</mi><mn>0</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msubsup><mi>S</mi><mn>0</mn><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>S</mi><mn>1</mn></msub><msub><mi>S</mi><mn>0</mn></msub><msub><mi>T</mi><mi>A</mi></msub><mo>+</mo><msub><mi>S</mi><mn>1</mn></msub><msub><mi>S</mi><mn>0</mn></msub><msub><mi>T</mi><mi>B</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>L</mi><mrow><mi>A</mi><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>S</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>L</mi><mrow><mi>A</mi><mn>0</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>S</mi><mn>1</mn></msub><msub><mi>S</mi><mn>0</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>L</mi><mrow><mi>B</mi><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>S</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>L</mi><mrow><mi>B</mi><mn>0</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>S</mi><mn>1</mn></msub><msub><mi>S</mi><mn>0</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}S_1^{&#x27;} &amp;= S_1 \oplus S_0\\S_0^{&#x27;} &amp;= S_1 S_ 0 T_A + S_1 S_0 T_B\\L_{A1} &amp;= S_1\\L_{A0} &amp;= S_1 S_0\\L_{B1} &amp;= S_1\\L_{B0} &amp;= S_1 S_0\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.304960000000001em;vertical-align:-4.40248em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.902480000000001em;"><span style="top:-6.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9924799999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.25752em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9924799999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.7575200000000004em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.2575200000000004em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.7575200000000009em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:0.7424799999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.40248em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.902480000000001em;"><span style="top:-6.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-5.25752em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.7575200000000004em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.2575200000000004em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.7575200000000009em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:0.7424799999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.40248em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;p&gt;时序逻辑电路的输出是由上一刻的输出和这一刻的输入共同决定，也就是说时序电路带</summary>
      
    
    
    
    <category term="逻辑电路" scheme="http://xinhecuican.github.io/categories/%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF/"/>
    
    
  </entry>
  
  <entry>
    <title>Unity旋转</title>
    <link href="http://xinhecuican.github.io/post/bcf345af.html"/>
    <id>http://xinhecuican.github.io/post/bcf345af.html</id>
    <published>2021-04-11T01:28:00.000Z</published>
    <updated>2021-04-11T13:05:49.823Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="向量旋转"><a class="markdownIt-Anchor" href="#向量旋转"></a> 向量旋转</h1><p>首先我们需要知道旋转的角度，设为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span></p><p><img src="/images/Unity%E6%97%8B%E8%BD%AC1.PNG" alt="" /></p><p>例如把AB旋转到AC，设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∠</mi><mi>X</mi><mi>A</mi><mi>B</mi><mo>=</mo><mi>σ</mi></mrow><annotation encoding="application/x-tex">\angle XAB = \sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69224em;vertical-align:0em;"></span><span class="mord">∠</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>, B的坐标(x, y), C的坐标(a, b),半径为R,则</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>A</mi><mi>B</mi><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>R</mi><mo>=</mo><mfrac><mi>x</mi><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mi>y</mi><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>A</mi><mi>C</mi><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>R</mi><mo>=</mo><mfrac><mi>a</mi><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>σ</mi><mo>+</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mi>b</mi><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>σ</mi><mo>+</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>a</mi><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>R</mi><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>σ</mi><mo>+</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>R</mi><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mfrac><mi>x</mi><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>−</mo><mfrac><mi>y</mi><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>x</mi><mo>×</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>y</mi><mo>×</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>b</mi><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>R</mi><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>σ</mi><mo>+</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>+</mo><mi>R</mi><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>y</mi><mo>×</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mo>×</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}AB =&amp; R = \frac{x}{cos(\sigma)} = \frac{y}{sin(\sigma)}\\AC =&amp; R = \frac{a}{cos(\sigma + \theta)} = \frac{b}{sin(\sigma + \theta)}\\a =&amp; R * cos(\sigma + \theta) = R * cos(\sigma)cos(\theta) - R * sin(\sigma)sin(\theta)\\ =&amp; \frac{x}{cos(\sigma)} cos(\sigma)cos(\theta) - \frac{y}{sin(\sigma)}sin(\sigma)sin(\theta)\\ =&amp; x \times cos(\theta) - y \times sin(\theta)\\ b =&amp; R * cos(\sigma + \theta) = R * sin(\sigma)cos(\theta) + R * cos(\sigma)sin(\theta)\\ =&amp; y \times cos(\theta) + x \times sin(\theta)\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:13.29456em;vertical-align:-6.39728em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.89728em;"><span style="top:-9.16116em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-6.55372em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-4.47772em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-2.7101599999999992em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mrel">=</span></span></span><span style="top:-0.6341599999999996em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mrel">=</span></span></span><span style="top:0.8658400000000004em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:2.3658400000000004em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.39728em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.89728em;"><span style="top:-9.16116em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-6.55372em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.47772em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span><span style="top:-2.7101599999999992em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span><span style="top:-0.6341599999999996em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span><span style="top:0.8658400000000004em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span><span style="top:2.3658400000000004em;"><span class="pstrut" style="height:3.3714399999999998em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.39728em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>由上式可得 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>=</mo><mi>x</mi><mo>×</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>y</mi><mo>×</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>b</mi><mo>=</mo><mi>y</mi><mo>×</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mo>×</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a = x \times cos(\theta) - y \times sin(\theta), b = y \times cos(\theta) + x \times sin(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span></p><p>也就是说我们可以用x来替换<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">cos(\sigma)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span></span></span></span>, 用y来替换<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">sin(\sigma)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span></span></span></span>，然后根据和角公式进行对应替换就可以了</p><p>如果AC角小于AB角也可以用同样的方法进行求解。结果为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>=</mo><mi>x</mi><mo>×</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>+</mo><mi>y</mi><mo>×</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>b</mi><mo>=</mo><mi>y</mi><mo>×</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>−</mo><mi>x</mi><mo>×</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a = x \times cos(\theta) + y \times cos(\theta), b = y \times cos(\theta) - x \times sin(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span></p><p>在Unity中可以使用Quaternion.LookRotation的方法进行旋转，它的输入就是旋转之后的向量，其中y可以不变，只需要旋转x和z。</p><h1 id="欧拉角"><a class="markdownIt-Anchor" href="#欧拉角"></a> 欧拉角</h1><p><a href="https://blog.csdn.net/AndrewFan/article/details/60866636">欧拉角的定义</a></p><p><a href="https://blog.csdn.net/AndrewFan/article/details/60981437">欧拉角的万向节死锁</a></p><h1 id="transform"><a class="markdownIt-Anchor" href="#transform"></a> transform</h1><p><a href="https://linxinfa.blog.csdn.net/article/details/110005470">transform</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;向量旋转&quot;&gt;&lt;a class=&quot;markdownIt-Anchor</summary>
      
    
    
    
    <category term="Unity" scheme="http://xinhecuican.github.io/categories/Unity/"/>
    
    
  </entry>
  
  <entry>
    <title>MPI编程</title>
    <link href="http://xinhecuican.github.io/post/bb25e9a9.html"/>
    <id>http://xinhecuican.github.io/post/bb25e9a9.html</id>
    <published>2021-04-01T23:18:00.000Z</published>
    <updated>2021-04-24T12:22:23.378Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h1><p>MPI是一种编程规范，它的实现是一个库，主要在Fortran和c语言上实现。它的目的是实现进程间通讯。</p><h1 id="mpi基本函数"><a class="markdownIt-Anchor" href="#mpi基本函数"></a> MPI基本函数</h1><h2 id="开始与结束"><a class="markdownIt-Anchor" href="#开始与结束"></a> 开始与结束</h2><ul><li>MPI_Init(&amp;argc, &amp;argv): 利用输入进来的参数进行初始化</li><li>MPI_Finalize(): MPI终止时调用</li></ul><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;mpi.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span> <span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> err;err = MPI_Init(&amp;argc, &amp;argv);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello world!\n&quot;</span>);</span><br><span class="line">    err = MPI_Finalize();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行</span><br><span class="line"></span><br><span class="line">mpirun -n <span class="number">4</span> ./hello.c</span><br></pre></td></tr></table></figure><h2 id="身份标识"><a class="markdownIt-Anchor" href="#身份标识"></a> 身份标识</h2><ul><li>MPI_COMM_WORLD: 获得通信域(也就是同一组内的进程，例如上面mpirun -4代表启动4个进程，他们属于同一组）</li><li>MPI_Comm_size(MPI_COMM_WORLD, &amp;size): 获得进程个数，赋值给size</li><li>MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank): 获得此进程在通信域内的编号，赋值给rank</li></ul><h2 id="数据类型"><a class="markdownIt-Anchor" href="#数据类型"></a> 数据类型</h2><p>基本数据类型有：<br /><img src="/images/MPI%E7%BC%96%E7%A8%8B6.PNG" alt="" /></p><p>自定义结构体：</p><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">typedef <span class="keyword">struct</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> a<span class="literal">[<span class="number">4</span>]</span>;</span><br><span class="line">    double b<span class="literal">[<span class="number">4</span>]</span>;</span><br><span class="line">&#125;node;</span><br><span class="line"></span><br><span class="line">types<span class="literal">[<span class="number">0</span>]</span> = MPI_INT;</span><br><span class="line">length<span class="literal">[<span class="number">0</span>]</span> = <span class="number">4</span>;</span><br><span class="line">displacements<span class="literal">[<span class="number">0</span>]</span> = <span class="number">0</span>;</span><br><span class="line">types<span class="literal">[<span class="number">1</span>]</span> = MPI_DOUBLE;</span><br><span class="line">length<span class="literal">[<span class="number">1</span>]</span> = <span class="number">4</span>;</span><br><span class="line">displacements<span class="literal">[<span class="number">1</span>]</span> = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="constructor">MPI_Type_struct(2, <span class="params">lengths</span>, <span class="params">displacements</span>, <span class="params">types</span>, &amp;<span class="params">buff_datatype</span>)</span>;</span><br><span class="line"><span class="constructor">MPI_Type_commit(&amp;<span class="params">buff_datatype</span>)</span>;</span><br><span class="line">然后就可以使用buff_dtattype这种类型了，这种类型也就表示了node </span><br></pre></td></tr></table></figure><h2 id="信息传递"><a class="markdownIt-Anchor" href="#信息传递"></a> 信息传递</h2><ul><li><p><code>int MPI_Send( void *buff, int count, MPI_Datatype datatype, int dest, int tag, MPI_Comm comm)</code>：</p><ul><li>buff: 是存储消息缓存的起始地址（一般用数组）</li><li>count： 传递定义数据类型的多少项</li><li>datatype: 传递的数据类型</li><li>dest： 是目的进程的编号（由对方的MPI_Comm_rank获得的）</li><li>tag： 消息标签，接收方的消息标签要和发送方的消息标签相同才可以接受，一两位目的进程可能不知接收一条信息，它需要标签进行区分。</li><li>标识通信域，一般使用MPI_Comm_WORLD</li></ul></li><li><p><code>int MPI_Recv( void *buff, int count, MPI_Datatype datatype, int source, int tag, MPI_Comm comm, MPI_Status *status)</code>:</p><ul><li>buff： 用来接收消息的缓冲区</li><li>接收的最大项数</li><li></li><li>source： 消息来源进程编号</li><li>tag： 双方约定的信号量（这个源和目的地都应该相同，不然收不到）</li><li>status： 状态信息，包括消息的源进程标识，消息标签，包含的数据项个数等。Status.MPI_SOURCE, Status.MPI_TAG , MPI_Get_count(&amp;Status, MPI_INT, &amp;C)可以读出</li></ul></li></ul><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">#<span class="keyword">include</span> <span class="string">&quot;mpi.h&quot;</span></span><br><span class="line"><span class="built_in">int</span> foo(<span class="built_in">int</span> i)&#123;...&#125;</span><br><span class="line">main(<span class="built_in">int</span> argc,<span class="built_in">char</span>* argv<span class="literal">[]</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> i, tmp, sum=<span class="number">0</span>, group_size, my_rank, N;</span><br><span class="line">    <span class="constructor">MPI_Init(&amp;<span class="params">argc</span>, &amp;<span class="params">argv</span>)</span>;</span><br><span class="line">    <span class="constructor">MPI_Comm_size(MPI_COMM_WORLD, &amp;<span class="params">group_size</span>)</span>;</span><br><span class="line">    <span class="constructor">MPI_Comm_rank(MPI_COMM_WORLD, &amp;<span class="params">my_rank</span>)</span>;</span><br><span class="line">    <span class="keyword">if</span> (my_rank==<span class="number">0</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        printf(<span class="string">&quot;Enter N:&quot;</span>);</span><br><span class="line">        scanf(<span class="string">&quot;%d&quot;</span>,&amp;N);</span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;group_size;i++) </span><br><span class="line">            <span class="constructor">MPI_Send(&amp;N, 1, MPI_INT, <span class="params">i</span>, <span class="params">i</span>, MPI_COMM_WORLD)</span>;</span><br><span class="line">        <span class="keyword">for</span> (i=my_rank;i&lt;N;i=i+group_size) </span><br><span class="line">            sum=sum+tmp;</span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;group_size;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="constructor">MPI_Recv(&amp;<span class="params">tmp</span>,1,MPI_INT,<span class="params">i</span>,<span class="params">i</span>,MPI_COMM_WORLD,&amp;<span class="params">status</span>)</span>;</span><br><span class="line">            sum=sum+tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        printf(<span class="string">&quot;\n The result = %d&quot;</span>, sum);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="constructor">MPI_Recv(&amp;N,1,MPI_INT,0,<span class="params">my_rank</span>,MPI_COMM_WORLD,&amp;<span class="params">status</span>)</span>;</span><br><span class="line">        <span class="keyword">for</span> (i=my_rank;i&lt;N;i=i+group_size)  </span><br><span class="line">            sum=sum+foo(i);</span><br><span class="line">        <span class="constructor">MPI_Send(&amp;<span class="params">sum</span>,1,MPI_INT,0,<span class="params">my_rank</span>,MPI_COMM_WORLD)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="constructor">MPI_Finalize()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>int MPI_Sendrecv(void *sendbuf, int sendcount,MPI_Datatype sendtype, int ，dest, int sendtag, <code>void *recvbuf, int recvcount, MPI_Datatype recvtype, int source, int recvtag, MPI_Comm comm, MPI_Status *status</code>): 它的作用是捆绑发送接收，他可以避免由于发送接收次序错误而造成的死锁。同时它可以接收单个MPI_Send发来的消息也可以呗：MPI_Recv接收到</p></li><li><p>MPI_PROC_NULL: 虚拟进程，当一个进程向这个进程发送消息时，会立刻成功返回，接收消息时也会立刻成功返回并且缓冲区没有任何改变。<strong>它可以写在source或dest中</strong></p></li></ul><h2 id="组通信"><a class="markdownIt-Anchor" href="#组通信"></a> 组通信</h2><ul><li>MPI_Bcast( void* data, int count, MPI_Datatype datatype, int root,MPI_Comm communicator): 标号为root的进程给其他所有进程发送消息，包括他自己，对于root来说，data即是发送缓冲又是接收缓冲</li></ul><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="constructor">MPI_Init( &amp;<span class="params">argc</span>, &amp;<span class="params">argv</span> )</span>;</span><br><span class="line"><span class="constructor">MPI_Comm_rank( MPI_COMM_WORLD, &amp;<span class="params">rank</span> )</span>;</span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (rank<span class="operator"> == </span><span class="number">0</span>) </span><br><span class="line">        scanf( <span class="string">&quot;%d&quot;</span>, &amp;value );</span><br><span class="line">    <span class="constructor">MPI_Bcast( &amp;<span class="params">value</span>, 1, MPI_INT, 0, MPI_COMM_WORLD )</span>;<span class="comment">//其他进程也要写，用来接收</span></span><br><span class="line">    printf( <span class="string">&quot;Process %d got %d\n&quot;</span>, rank, value );</span><br><span class="line">&#125; <span class="keyword">while</span> (value &gt;= <span class="number">0</span>);</span><br><span class="line"><span class="constructor">MPI_Finalize( )</span>;</span><br></pre></td></tr></table></figure><ul><li>MPI_Scatter(<br />void* send_data,<br />int send_count,<br />MPI_Datatype send_datatype,<br />void* recv_data,<br />int recv_count,<br />MPI_Datatype recv_datatype,<br />int root,<br />MPI_Comm communicator)<ul><li>root发送给每个分组缓冲区中的一部分信息，非root进程会忽略发送缓冲。它是将每个接收缓冲区填满之后才会发给下一个进程，而不是平均分。</li></ul></li></ul><p><img src="/images/MPI%E7%BC%96%E7%A8%8B1.png" alt="" /></p><ul><li>MPI_Gather(<br />void* send_data,<br />int send_count,<br />MPI_Datatype send_datatype,<br />void* recv_data,<br />int recv_count,<br />MPI_Datatype recv_datatype,<br />int root,<br />MPI_Comm communicator)<ul><li>只有root进程的recv_buf是有效的，其他可以随便传</li><li>它是接受所有进程的信息汇总到root进程中（包括它自己的信息).</li><li>接收信息是按照序号进行排列的，并且recv_count只需要填写一个进程接收的信息就可以了</li></ul></li></ul><p>例如：</p><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span> *recv_buf;</span><br><span class="line"><span class="keyword">if</span>(rank<span class="operator"> == </span><span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    recv_buf = (<span class="built_in">int</span>*)malloc(sizeof(<span class="built_in">int</span>)<span class="operator"> * </span>all<span class="operator"> * </span>all);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">int</span> *send_buf = (<span class="built_in">int</span>*)malloc(sizeof(<span class="built_in">int</span>)<span class="operator"> * </span>add_sum<span class="operator"> * </span>add_sum);</span><br><span class="line"><span class="built_in">int</span> beginx = rank<span class="operator"> / </span>sqrt_num<span class="operator"> * </span>add_sum;</span><br><span class="line"><span class="built_in">int</span> beginy = rank % sqrt_num<span class="operator"> * </span>add_sum;</span><br><span class="line"><span class="built_in">int</span> flag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">int</span> i=beginx; i&lt;beginx+add_sum; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> k=beginy; k&lt;beigny+add_sum; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        send_buf<span class="literal">[<span class="identifier">flag</span><span class="operator">++</span>]</span> = i<span class="operator"> * </span>add_sum + k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="constructor">MPI_Gather(<span class="params">send_buf</span>, <span class="params">add_sum</span> <span class="operator">*</span> <span class="params">add_sum</span>, MPI_INT, <span class="params">recv_buf</span>, <span class="params">add_sum</span> <span class="operator">*</span> <span class="params">add_sum</span>, MPI_INT, 0, MPI_COMM_WORLD)</span>;</span><br></pre></td></tr></table></figure><ul><li>MPI_Allgather(<br />void* send_data,<br />int send_count,<br />MPI_Datatype send_datatype,<br />void* recv_data,<br />int recv_count,<br />// v: int* recvcnt, int* disp<br />MPI_Datatype recv_datatype,<br />MPI_Comm communicator):<ul><li>每个进程都把自己的信息发给其他所有进程，完成之后所有进程都有信息的聚合</li></ul></li></ul><p><img src="/images/MPI%E9%80%9A%E4%BF%A12.png" alt="" /></p><ul><li>MPI_Reduce(inbuf,result,count,datatype,op,root,comm): 进行聚合之后还进行了一次归约操作，归约操作有MAX, MIN, SUM, PROD, LAND, BAND(按位与), LOR, BOR, LXOR, BXOR, MAXLOC, MINLOC等。这是每一个数据每一个数据进行归约</li><li>MPI_AllReduce: 和MPI_Reduce类似，没有root参数</li><li>MPI_Reduce_Scattar(void* send_data, void* recv_data, int recvcounts, Op, Comm): 对数据进行归约之后再分给每个进程。</li><li>MPI_Scan(void* sendbuf, void* recvbuf, int count, MPI_Datatype datatype, MPI_Op op, MPI_Comm comm): 每个进程都对它前面的进程进行归约，类似前缀和</li></ul><p><img src="/images/MPI%E7%BC%96%E7%A8%8B4.PNG" alt="" /></p><ul><li>int MPI_Alltoall(void *sendbuf, int sendcount, MPI_Datatype senddatatype, void *recvbuf, int recvcount, MPI_Datatype recvdatatype, MPI_Comm comm): 每个进程把第i块数据发送给第i个进程，又从第j个进程接收数据到自己的第j块中。</li></ul><p>例如： 进程1把自己第二块数据发送给进程2， 进程2接收到来自进程1的数据放到 第一块中，类似于矩阵转置。</p><ul><li>MPI_Comm(Comm): 等待同一群组中所有进程到达屏障时候才进行下一步操作</li></ul><p><img src="/images/MPI%E7%BC%96%E7%A8%8B5.PNG" alt="" /></p><h1 id="多线程mpi"><a class="markdownIt-Anchor" href="#多线程mpi"></a> 多线程MPI</h1><ul><li><code>MPI_INIT_THREAD(int *argc, char ***argv, int required, int *provided)</code><ul><li>required: 是线程的需求级别，它决定了那些线程可以进行MPI通信<ul><li>MPI_THREAD_SINGLE: 单线程</li><li>MPI_THREAD_FUNNELED: 只有主线程可以进行MPI通信</li><li>MPI_THREAD_SERIALIZED: 同一时刻只有一个线程可以进行MPI通信</li><li>MPI_THREAD_MULTIPLE: 任何线程都可以随意进行通信</li></ul></li><li>provided： 可以提供的线程</li><li>设定了级别之后就可以在MPI内部用多线程了</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;简介&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; </summary>
      
    
    
    
    <category term="并行" scheme="http://xinhecuican.github.io/categories/%E5%B9%B6%E8%A1%8C/"/>
    
    
  </entry>
  
  <entry>
    <title>硬件描述语言</title>
    <link href="http://xinhecuican.github.io/post/b75632a1.html"/>
    <id>http://xinhecuican.github.io/post/b75632a1.html</id>
    <published>2021-03-24T13:00:00.000Z</published>
    <updated>2021-04-07T13:53:15.766Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="硬件描述语言hdl大致功用"><a class="markdownIt-Anchor" href="#硬件描述语言hdl大致功用"></a> 硬件描述语言(HDL)大致功用</h1><p>硬件描述语言和逻辑电路之间的关系类似于c语言和机器代码。c语言通过编译器编译成机器码，而硬件描述语言通过<strong>硬件描述语言综合器</strong>变成<strong>硬件电路网表文件</strong>。</p><p>硬件描述语言和高级语言的一大区别是硬件描述语言的基本运行逻辑是<strong>并行</strong>，而高级语言是顺序执行</p><blockquote><p>在HDL中，只有一部分是可以综合的，称为可综合的HDL。另外一部分主要用于仿真验证（例如等几秒后再进行下一步）</p></blockquote><p>综合器大致工作过程为：</p><ul><li>将RTL描述通过EDA工具翻译成未经过优化的设计约束</li><li>然后进行逻辑优化。去除冗余逻辑</li><li>之后根据工艺库实现逻辑电路及其布线。工艺库由中芯国际和台积电等公司提供</li></ul><h1 id="语法基础"><a class="markdownIt-Anchor" href="#语法基础"></a> 语法基础</h1><p>框架：</p><figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> mux2(<span class="keyword">input</span> <span class="keyword">logic</span> D0, D1, sel, <span class="keyword">output</span> <span class="keyword">logic</span> y);</span><br><span class="line">    <span class="keyword">logic</span> a, b;</span><br><span class="line">    <span class="keyword">assign</span> a = D0 &amp; (~sel);</span><br><span class="line">    <span class="keyword">assign</span> b = D0 &amp; sel;</span><br><span class="line">    <span class="keyword">assign</span> y = a | b;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><ul><li>module endmodule: 定义了一个模块，注意module后面有一个<code>;</code>,而endmodule后面没有</li><li><code>input/output/inout [类型] [位宽] 端口名1, 端口名2</code>: 这是模块的输入和输出。端口定义还可以有其他一些形式，如：</li></ul><figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> mux2(<span class="keyword">input</span> D0, <span class="keyword">output</span> <span class="keyword">logic</span> y);</span><br><span class="line">    <span class="keyword">logic</span> D0, y;</span><br><span class="line">    </span><br><span class="line">或</span><br><span class="line"><span class="keyword">module</span> mux2(D0, y);</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> D0;</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">logic</span> y;</span><br><span class="line">    </span><br><span class="line">推荐使用框架中的那种</span><br></pre></td></tr></table></figure><ul><li>内部变量定义： 类型 [位宽] 变量名1, 变量名2: 这和端口定义基本类似，除了没有input和output</li></ul><h1 id="变量-常量-运算符"><a class="markdownIt-Anchor" href="#变量-常量-运算符"></a> 变量、常量、运算符</h1><blockquote><p>注释和c语言相同，也是<code>//</code>和<code>/*</code></p></blockquote><h2 id="常量"><a class="markdownIt-Anchor" href="#常量"></a> 常量</h2><p>常量的格式为： <code>&lt;+/-&gt;&lt;位宽&gt;’&lt;进制&gt;&lt;数值&gt;</code></p><ul><li>+/-: 表示正负， EDA工具默认使用无符号数，也就是说加了<code>+</code>号和不加<code>+</code>号是不同的含义</li><li>位宽： 指的数据最多有多少个bit</li><li><code>'</code>： 位宽后面的标识</li><li>进制： b或B是二进制， o或O是八进制， d或D是十进制， h或H是十六进制.<strong>如果没有给出进制，默认为有符号数</strong></li><li>数值：数值间可以加下划线方便阅读。例如：<code>1100_0101</code></li></ul><p>例如：</p><figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">-<span class="number">4</span>&#x27;b<span class="number">0011</span>: 首先转换成补码，为<span class="number">1101</span>，然后是4位，所以结果就是<span class="number">1101</span></span><br><span class="line">-4&#x27;d10: 转换成补码为<span class="number">10110</span>（因为是负数，最高位一定是<span class="number">1</span>），之后取<span class="number">4</span>位，结果为<span class="number">0110</span>。和我们想要得到的结果不同</span><br></pre></td></tr></table></figure><h2 id="数据类型"><a class="markdownIt-Anchor" href="#数据类型"></a> 数据类型</h2><p>大体上可以分为变量和线网两种类型。变量只能有一个驱动源，线网必须是多驱动源(也就是可能有多个输入碰到一起），线网通常被解释为连线，而变量既可以被解释为连线，也可以被解释为寄存器。<br /><img src="/images/%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%801.PNG" alt="" /></p><p>线网类型主要有wire和tri。其中wire因为也是单驱动源，已经被废弃（端口信号可能是线网类型）。tri可以用于定义多驱动源信号。</p><p><strong>变量</strong></p><ul><li>logic: 格式为：<code>logic &lt;位宽&gt; &lt;signed&gt; 信号名1, 信号名2, …, 信号名n</code>.logic可以表示4中状态，0,1，x，z。</li></ul><blockquote><p>默认logic位宽是1</p></blockquote><p>例如：</p><figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">logic</span> [<span class="number">16</span> : <span class="number">0</span>] addrbus, databus;   <span class="comment">//定义了两个（无符号）的16位向量信号</span></span><br><span class="line"><span class="keyword">logic</span> [<span class="number">16</span> : <span class="number">0</span>] <span class="keyword">signed</span> addrbus;            <span class="comment">// 定义了两个（有符号）的16位向量信号</span></span><br><span class="line"><span class="keyword">logic</span> a, b;<span class="comment">//定义了两个1位标量信号，相当于logic [0 : 0] a, b;</span></span><br></pre></td></tr></table></figure><p>logic可以进行域选（即任意把一些位赋给另一些位）</p><figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">logic temp = z;</span><br><span class="line">logic[<span class="number">7</span> : 0] <span class="keyword"><span class="keyword">out</span></span>, <span class="keyword"><span class="keyword">in</span></span>;</span><br><span class="line">assign <span class="keyword">out</span>[<span class="number">7</span> : 4] = <span class="keyword"><span class="keyword">in</span></span>[3 : 0];</span><br><span class="line">assign <span class="keyword">out</span>[<span class="number">3</span>] = <span class="keyword">in</span>[<span class="number">2</span> : 2];</span><br></pre></td></tr></table></figure><ul><li>bit: 和logic类似，但是他<strong>只有0,1两种取值，下面几种变量也都只有两种取值</strong></li><li>byte: 定义8位信号，但是它一次就赋8位，不能进行域选</li><li>shortint: 定义16位信号，和byte类型</li><li>int： 定义32位信号</li></ul><h2 id="运算符"><a class="markdownIt-Anchor" href="#运算符"></a> 运算符</h2><p><img src="/images/%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%802.PNG" alt="" /></p><p>大致和c语言相同，但是有一些还是略有区别。</p><p><strong>缩减运算</strong></p><p>例如：</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">logic</span> [<span class="number">7</span> : <span class="number">0</span>] a;</span><br><span class="line"><span class="attribute">assign</span> &amp;a;</span><br></pre></td></tr></table></figure><p>等同于 a[0] &amp; a[1] &amp; a[2] &amp; a[3] &amp; a[4] &amp; a[5] &amp; a[6] &amp; a[7];(不全是1结果就是0）</p><p>assign ^a;</p><p>^是半加法器，也就是1的个数为偶数时结果为0，为奇数时结果为1.</p><p><strong>拼接和复制</strong></p><p>SystemVerilog允许将多个数据进行组合，合成为一个数据</p><p>格式：{ 信号1[n1 : m1],信号1[n2 : m2], …,信号n[nn : mn] }</p><p>并且这些信号必须是确定位数，因此不可以出现未确定位数的常数，如1。</p><p>例如：</p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">logic [<span class="number">1</span> : <span class="number">0</span>] B, C; <span class="regexp">//</span> 假设B = <span class="number">2</span>’b00，C = <span class="number">2</span>’b11，</span><br><span class="line">logic [<span class="number">3</span>: <span class="number">0</span>] Y;</span><br><span class="line">Y = &#123;B, C&#125;;<span class="regexp">//</span> 正确，结果Y = <span class="number">4</span>’b0011</span><br><span class="line">Y = &#123;B[<span class="number">0</span>], C[<span class="number">1</span>], <span class="number">2</span>’b10&#125;;<span class="regexp">//</span> 正确，结果Y = <span class="number">4</span>’b0110，注意，常数的位宽不能缺省</span><br><span class="line">Y = &#123;B, <span class="number">5</span>&#125;;<span class="regexp">//</span> 错误，因为常数<span class="number">5</span>的位宽不确定</span><br><span class="line">Y = &#123;<span class="number">2</span>&#123;C&#125;&#125;;<span class="regexp">//</span> 正确，结果Y = <span class="number">4</span>’b1111</span><br><span class="line">Y = &#123;B[<span class="number">0</span>], C[<span class="number">1</span>], &#123;<span class="number">2</span>&#123;B[<span class="number">1</span>]&#125;&#125;&#125;;<span class="regexp">//</span> 正确，结果Y = <span class="number">4</span>’b0100</span><br></pre></td></tr></table></figure><p>最后两个中出现了 数字加{C}的方式，这是将这个信号进行复制，格式为：<code>&#123;n&#123;A&#125;&#125;</code></p><h1 id="行为建模"><a class="markdownIt-Anchor" href="#行为建模"></a> 行为建模</h1><h2 id="持续性赋值语句的建模"><a class="markdownIt-Anchor" href="#持续性赋值语句的建模"></a> 持续性赋值语句的建模</h2><p>持续性赋值语句即使用<strong>assign</strong>的赋值语句，它是并行的，因此哪条语句在前哪条语句在后没有关系。它的使用方法如下：</p><blockquote><p>assign &lt;#延迟量&gt; 信号名 = 表达式,延迟量以纳秒为单位</p></blockquote><p>例如：<code>assign #5 out2 = ~(A&amp;B)</code></p><p>持续性赋值语句的含义是只要右侧变量发生变化，则立刻把该值赋给左侧变量，对应到电路就是输入输出的关系。此外<strong>延迟量仅用于仿真，不能被综合</strong>。</p><h2 id="基于过程块的建模"><a class="markdownIt-Anchor" href="#基于过程块的建模"></a> 基于过程块的建模</h2><p>过程块内部的基本逻辑是顺序执行，每条语句之间有逻辑上的前后顺序（但是实际综合的时候可能会影响顺序）</p><p>它由关键字initial或always定义，通过begin…end(相当于c语言中的{…})包围代码块。initial主要用于仿真验证。因此这里之间always</p><p>always表示总是，也就是这个代码块处于无限循环当中，只要条件改变就会导致变化（always包围的代码块和掐他assign也是并行的）。</p><p>always可以看成c语言中的代码块，它的参数就是外面的输入和它所影响的输出。一旦外面对应数值发生改变里面也会立刻对应改变</p><h3 id="always_comb描述组合逻辑"><a class="markdownIt-Anchor" href="#always_comb描述组合逻辑"></a> always_comb（描述组合逻辑）</h3><p>模板：</p><figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line">      <span class="keyword">always_comb</span>   <span class="keyword">begin</span></span><br><span class="line">            过程赋值语句;</span><br><span class="line">            高级语言结构，如<span class="keyword">if</span>…<span class="keyword">else</span>, <span class="keyword">for</span>等</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">      </span><br><span class="line">      例如</span><br><span class="line">      <span class="keyword">module</span> mux2 (<span class="keyword">input</span>  <span class="keyword">logic</span> D0, D1, sel, </span><br><span class="line">                        <span class="keyword">output</span> <span class="keyword">logic</span> out);</span><br><span class="line">   <span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line">      <span class="comment">// 高级语言结构if…else</span></span><br><span class="line">      <span class="keyword">if</span> (sel == <span class="number">0</span>)</span><br><span class="line">         <span class="comment">// 过程赋值语句</span></span><br><span class="line">         out = D0;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">         out = D1;</span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在过程赋值语句中，<code>=</code>表示阻塞性赋值，也就是这条语句没有完成不进行下一步。并且左边<strong>必须是变量类型，不能是线网类型</strong>，这一点可能会导致一些错误</p><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">module</span> <span class="title">adder</span> <span class="params">(input a, b, <span class="built_in">cin</span>, output [<span class="number">1</span> : <span class="number">0</span>] out)</span></span>; </span><br><span class="line">      logic half_sum, half_carry;</span><br><span class="line">      always_comb <span class="built_in">begin</span></span><br><span class="line">            half_sum = a ^ b ^ <span class="built_in">cin</span>;<span class="comment">// 正确</span></span><br><span class="line">            half_carry = a &amp; b | a &amp; ~b &amp; <span class="built_in">cin</span> | ~a &amp; b &amp; <span class="built_in">cin</span>;<span class="comment">// 正确</span></span><br><span class="line">            out = &#123;half_carry, half_sum&#125;;<span class="comment">//错误</span></span><br><span class="line">      <span class="built_in">end</span></span><br><span class="line">endmodule</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>最后一个错误是因为out并没有赋予它类型，因此它是默认的wire类型，是一种线网类型。</p><p>=号只在逻辑上是阻塞，实际上不一定是串行。</p><figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> mux2 (<span class="keyword">input</span> <span class="keyword">logic</span> D0, D1, sel, <span class="keyword">output</span> <span class="keyword">logic</span> y)</span><br><span class="line">      <span class="keyword">logic</span> a, b;</span><br><span class="line">      <span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line">            a = D0 &amp; ~sel;<span class="comment">// 阻塞赋值</span></span><br><span class="line">            b = D1 &amp; sel;<span class="comment">// 阻塞赋值</span></span><br><span class="line">            y = a | b;<span class="comment">// 阻塞赋值</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line">这是一个多路选择器，它的两个端口是 同时进行选择的，也就是说a和b是同时进行赋值的，但是这里使用阻塞性语句也可以综合成电路</span><br></pre></td></tr></table></figure><p><strong>分支结构</strong></p><p>SystemVerilog也支持if-else语句和case语句。如果其中有多行代码要使用begin-end<br />包围，尤其是case在c语言中不需要而在这里需要。</p><p>例如：</p><figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> mux2 (<span class="keyword">input</span>  <span class="keyword">logic</span> D0, D1, sel, </span><br><span class="line">                        <span class="keyword">output</span> <span class="keyword">logic</span> y);</span><br><span class="line">   <span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line">      <span class="comment">// 高级语言结构if…else</span></span><br><span class="line">      <span class="keyword">if</span> (sel == <span class="number">0</span>)</span><br><span class="line">         y = D0;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">         y = D1;</span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> mux2 (<span class="keyword">input</span>  <span class="keyword">logic</span> D0, D1, s, </span><br><span class="line">                         <span class="keyword">output</span> <span class="keyword">logic</span> y);</span><br><span class="line">   <span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line">      <span class="keyword">case</span> (s)</span><br><span class="line">         <span class="number">1</span>’b0: y = D0;</span><br><span class="line">         <span class="number">1</span>’b1: y = D1;</span><br><span class="line">      <span class="keyword">endcase</span></span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><p><strong>注意</strong>： if语句和case语句都尽量考虑到所有情况，否则将综合处带有锁存器的时序电路，效率大为降低。<img src="/images/%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%803.PNG" alt="" /></p><p>因此对于不完整分支，将剩下项补全，多余的项的内容可以随意设置。</p><p>在case语句中，可以使用?表示无关项，也就是该项即可以取零又可以取1.例如：</p><figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> dec2to4(<span class="keyword">input</span> <span class="keyword">logic</span> EN, <span class="keyword">input</span> <span class="keyword">logic</span> [<span class="number">1</span> : <span class="number">0</span>] A, <span class="keyword">output</span> <span class="keyword">logic</span> [<span class="number">3</span> : <span class="number">0</span>] Y);</span><br><span class="line">      <span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">casez</span>(&#123;EN, A&#125;)</span><br><span class="line">                  <span class="number">3</span>’b100:      Y = <span class="number">4</span>’b0001;</span><br><span class="line">                  <span class="number">3</span>’b101:      Y = <span class="number">4</span>’b0010;</span><br><span class="line">                  <span class="number">3</span>’b110:      Y = <span class="number">4</span>’b0100;</span><br><span class="line">                  <span class="number">3</span>’b111:      Y = <span class="number">4</span>’b1000;</span><br><span class="line">                  <span class="number">3</span>’b0??:       Y = <span class="number">4</span>’b0000;</span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><p><strong>循环结构</strong></p><ul><li>for语句：其用法是<code>for (循环变量初始化; 条件表达式; 修改循环变量表达式)语句块</code></li><li>repeat语句：一种预先指定循环次数的循环语句，其用法是<code>repeat (循环次数表达式) 语句块</code></li><li>while语句：其用法是<code>while (条件表达式) 语句块</code></li><li>forever语句：一种无限循环语句，其用法是<code>forever 语句块</code></li></ul><blockquote><p>在这四种语句中，只有for语句是可综合的</p></blockquote><p>例如：</p><figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> loop_demo(<span class="keyword">input</span> <span class="keyword">logic</span> [<span class="number">2</span> : <span class="number">0</span>] din, </span><br><span class="line">                                <span class="keyword">output</span> <span class="keyword">logic</span> [<span class="number">1</span> : <span class="number">0</span>] out);</span><br><span class="line">      <span class="keyword">int</span> num_bits</span><br><span class="line">      <span class="keyword">always_comb</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">int</span> i;</span><br><span class="line">            num_bits = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) <span class="keyword">begin</span></span><br><span class="line">                  <span class="keyword">if</span> (din[i] == <span class="number">1</span>) </span><br><span class="line">                        num_bits = numbits + <span class="number">1</span>;</span><br><span class="line">                  <span class="keyword">else</span> num_bits = numbits;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">assign</span> out = num_bits;</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><h3 id="模块实例化"><a class="markdownIt-Anchor" href="#模块实例化"></a> 模块实例化</h3><p>创建模块之后可以在其他模块之中被调用，调用格式为：</p><p><code>模块名 实例化名 （信息列表）</code></p><ul><li>信息列表也就是参数列表，他有两种书写形式<ul><li>位置关联： 每个参数都依照模块定义时的接口进行填入</li><li>名称关联： 这种方法就可以不按顺序了。它的格式为<code>.端口号(信号)</code>, <code>.端口号</code><br />是模块端口的名字，而信号这传入的参数的名字</li><li>位置关联和名称关联一次只可以使用一种，不可以部分位置关联部分名称关联</li></ul></li></ul><p>例如：</p><figure class="highlight plain"><figcaption><span>mux2 (input  logic D0, D1, sel,</span></figcaption><table><tr><td class="code"><pre><span class="line">                        output logic y);</span><br><span class="line">   always_comb begin</span><br><span class="line">      if (sel &#x3D;&#x3D; 0)   out &#x3D; D0;</span><br><span class="line">      else   out &#x3D; D1;</span><br><span class="line">   end</span><br><span class="line">endmodule</span><br><span class="line">mux2 finalmux (low, high, sel[1], y);&#x2F;&#x2F;位置关联</span><br><span class="line">mux2 beginmux(.y(y), .D0(low), .D1(high), .sel(sel[1]));</span><br></pre></td></tr></table></figure><p>其中<code>mux2</code>是这个模块的名字，也就相当于类名，finalmux是实例化后的名字，注意实例化后就立刻开始执行，不需要写额外的代码。</p><p>模块和assign或者always语句是同一级别的，他们之间都是并行的</p><p>此外系统一般还会提供一些非常基础的模块，如and, or等，这些模块可以不写实例化名字</p><h3 id="参数化建模"><a class="markdownIt-Anchor" href="#参数化建模"></a> 参数化建模</h3><p><strong>参数化模块</strong></p><p>在SystemVerilog HDL中，可以使用<strong>parameter</strong>来标识一个常量，除此之外他还可以用作传入模块的一个预定义变量</p><p>例如：</p><figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> mux2</span><br><span class="line">   #(<span class="keyword">parameter</span> WIDTH = <span class="number">8</span>)</span><br><span class="line">   (<span class="keyword">input</span> <span class="keyword">logic</span> [WIDTH-<span class="number">1</span>:<span class="number">0</span>] D0, D1,   </span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> s, </span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">logic</span> [WIDTH-<span class="number">1</span>:<span class="number">0</span>] y);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> y = s? D0 : D1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> mux4_32</span><br><span class="line">        (<span class="keyword">input</span> <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] D0, D1, D2, D3,    </span><br><span class="line">         <span class="keyword">input</span> <span class="keyword">logic</span> [<span class="number">1</span>:<span class="number">0</span>] s, </span><br><span class="line">         <span class="keyword">output</span> <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] y);</span><br><span class="line">    <span class="keyword">logic</span> [<span class="number">31</span>:<span class="number">0</span>] low, hi;</span><br><span class="line">    mux2 <span class="variable">#(32) lowmux(D0, D1, s[0], low)</span>;</span><br><span class="line">    mux2 <span class="variable">#(32) himux(D2, D3, s[0], hi)</span>;</span><br><span class="line">    mux2 <span class="variable">#(32) outmux(low, hi, s[1], y)</span>;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><p>注意后面的<code>mux2 #(32)</code>.这就是把<code>#(parameter WIDTH=8)</code>中的WIDTH进行修改，并用更改后的WIDTH当做模块的参数，和c++中的模板类类似。</p><p>此外还可以把parameter写入内部，当做一个常量使用</p><figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> mux2 (<span class="keyword">input</span> D0, D1, s,  </span><br><span class="line">                        <span class="keyword">output</span> y);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">parameter</span> WIDTH = <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">logic</span> [WIDTH-<span class="number">1</span>:<span class="number">0</span>] D0, D1, y;</span><br><span class="line">    <span class="keyword">logic</span> s;</span><br><span class="line">    <span class="keyword">assign</span> y = s? D0 : D1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>但是引入常量还可以使用`define语句，它可以用`include导入</p><figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="meta">`<span class="meta-keyword">define</span> WIDTH 8   //结尾不需要“;”</span></span><br><span class="line"><span class="meta">`<span class="meta-keyword">define</span> ENABLE 1</span></span><br><span class="line"><span class="meta">`<span class="meta-keyword">define</span> INIT 16’h000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">`<span class="meta-keyword">include</span> “<span class="meta-keyword">define</span>.sv”</span></span><br><span class="line"><span class="keyword">module</span> mux2</span><br><span class="line">   (<span class="keyword">input</span> <span class="keyword">logic</span> [WIDTH-<span class="number">1</span>:<span class="number">0</span>] D0, D1,   </span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">logic</span> s, </span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">logic</span> [WIDTH-<span class="number">1</span>:<span class="number">0</span>] y);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> y = s? D0 : D1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><p><strong>generate语句</strong></p><p>generate通常和for，if，case配合使用，它可以自动生成代码</p><figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> andN #(<span class="keyword">parameter</span> WIDTH = <span class="number">4</span>) (<span class="keyword">input</span> <span class="keyword">logic</span> [WIDTH – <span class="number">1</span> : <span class="number">0</span>] a, <span class="keyword">output</span> <span class="keyword">logic</span> y);</span><br><span class="line">      <span class="keyword">genvar</span> i;</span><br><span class="line">      <span class="keyword">logic</span> [WIDTH – <span class="number">1</span> : <span class="number">0</span>] x;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">generate</span></span><br><span class="line">            <span class="keyword">assign</span> x[<span class="number">0</span>] = a[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; WIDTH; i = i+<span class="number">1</span>) <span class="keyword">begin</span> : forloop</span><br><span class="line">                  <span class="keyword">assign</span> x[i] = a[i] &amp; x[i - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">      <span class="keyword">endgenerate</span></span><br><span class="line">             <span class="keyword">assign</span> y = x[WIDTH - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><p>注意想要使用generate，在for语句中必须写上begin和end，并且begin后面还要加上forloop.并且循环变量的类型是genvar.</p><h1 id="测试"><a class="markdownIt-Anchor" href="#测试"></a> 测试</h1><p>例如：</p><figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">`timescale <span class="number">1</span>ns/<span class="number">1</span>ns// 预编译指令，定义时间单位和时间精度</span><br><span class="line"><span class="keyword">module</span> sillyfunction_tb ( )<span class="comment">;   // 测试程序没有输入/输出端口</span></span><br><span class="line">   logic a<span class="punctuation">,</span> b<span class="punctuation">,</span> <span class="keyword">c</span><span class="punctuation">,</span> y<span class="comment">;</span></span><br><span class="line">   sillyfunction dut (.a(a)<span class="punctuation">,</span> .b(b)<span class="punctuation">,</span> .<span class="keyword">c</span>(<span class="keyword">c</span>)<span class="punctuation">,</span> .y(y))<span class="comment">;   // 实例化待测模块</span></span><br><span class="line">   initial <span class="keyword">begin</span>// 给出激励信号</span><br><span class="line">      a <span class="operator">=</span> <span class="number">0</span><span class="comment">; b = 0; c = 0; #10;</span></span><br><span class="line">      <span class="keyword">c</span> <span class="operator">=</span> <span class="number">1</span><span class="comment">; #10;</span></span><br><span class="line">      b <span class="operator">=</span> <span class="number">1</span><span class="comment">; c = 0; #10;</span></span><br><span class="line">      <span class="keyword">c</span> <span class="operator">=</span> <span class="number">1</span><span class="comment">; #10;</span></span><br><span class="line">      a <span class="operator">=</span> <span class="number">1</span><span class="comment">; b = 0; c = 0; #10;</span></span><br><span class="line">      <span class="keyword">c</span> <span class="operator">=</span> <span class="number">1</span><span class="comment">; #10;</span></span><br><span class="line">      b <span class="operator">=</span> <span class="number">1</span><span class="comment">; c = 0; #10;</span></span><br><span class="line">      <span class="keyword">c</span> <span class="operator">=</span> <span class="number">1</span><span class="comment">; #50;</span></span><br><span class="line">      $finish</span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line">   initial <span class="keyword">begin</span>// 输出结果，否则只产生波形</span><br><span class="line">      $monitor ($time<span class="punctuation">,</span> “a <span class="operator">=</span> <span class="variable">%a</span><span class="punctuation">,</span> b <span class="operator">=</span> <span class="variable">%b</span><span class="punctuation">,</span> <span class="keyword">c</span> <span class="operator">=</span> <span class="variable">%c</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="variable">%y</span>”<span class="punctuation">,</span> a<span class="punctuation">,</span> b<span class="punctuation">,</span> <span class="keyword">c</span><span class="punctuation">,</span> y)<span class="comment">;</span></span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line">endmodule</span><br></pre></td></tr></table></figure><h2 id="initial语句"><a class="markdownIt-Anchor" href="#initial语句"></a> initial语句</h2><p>initial语句广泛应用于测试程序之中，它的特点就是所有语句都只会执行一次。</p><p>但是需要注意的是多个initial语句时并发执行，如果有某一时刻两个initial语句对用一个变量进行赋值那么就会产生错误。</p><h2 id="通过文件给予激励"><a class="markdownIt-Anchor" href="#通过文件给予激励"></a> 通过文件给予激励</h2><p>我们可以把输入输出放到一个文件之中，然后程序从文件中获得激励信号并进行比对。</p><figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> sillyfunction_tb ( )<span class="comment">;</span></span><br><span class="line">   logic a<span class="punctuation">,</span> b<span class="punctuation">,</span> <span class="keyword">c</span><span class="punctuation">,</span> y<span class="comment">;</span></span><br><span class="line">   logic [<span class="number">2</span> : <span class="number">0</span>] stim [<span class="number">7</span> : <span class="number">0</span>]<span class="comment">;// 声明一个logic类型的数组</span></span><br><span class="line">   int i<span class="comment">;</span></span><br><span class="line">   sillyfunction dut (.a(a)<span class="punctuation">,</span> .b(b)<span class="punctuation">,</span> .<span class="keyword">c</span>(<span class="keyword">c</span>)<span class="punctuation">,</span> .y(y))<span class="comment">; </span></span><br><span class="line">   initial <span class="keyword">begin</span></span><br><span class="line">      $readmemb (“testvector.txt”<span class="punctuation">,</span> stim)<span class="comment">;// 将所有激励读入数组stim</span></span><br><span class="line">      for (i <span class="operator">=</span> <span class="number">0</span><span class="comment">; i &lt; 8; i = i + 1) begin</span></span><br><span class="line">            &#123;a<span class="punctuation">,</span> b<span class="punctuation">,</span> <span class="keyword">c</span>&#125; <span class="operator">=</span> stim[i]<span class="comment">;   #10;// 依次测试各个激励</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line">   initial <span class="keyword">begin</span></span><br><span class="line">      $monitor ($time<span class="punctuation">,</span> “a <span class="operator">=</span> <span class="variable">%a</span><span class="punctuation">,</span> b <span class="operator">=</span> <span class="variable">%b</span><span class="punctuation">,</span> <span class="keyword">c</span> <span class="operator">=</span> <span class="variable">%c</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="variable">%y</span>”<span class="punctuation">,</span> a<span class="punctuation">,</span> b<span class="punctuation">,</span> <span class="keyword">c</span><span class="punctuation">,</span> y)<span class="comment">;</span></span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line">endmodule</span><br></pre></td></tr></table></figure><p><strong>输入文件格式</strong></p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="number">0000</span>_0000</span><br><span class="line"><span class="number">0110</span>_0001 <span class="number">0011</span>_0010</span><br><span class="line"><span class="regexp">//</span> 地址<span class="number">3</span>~<span class="number">255</span>没有定义</span><br><span class="line">@<span class="number">100</span> <span class="regexp">//</span> hex</span><br><span class="line"><span class="number">1111</span>_1100</span><br><span class="line"><span class="regexp">//</span>地址<span class="number">257</span>~<span class="number">1022</span>没有定义</span><br><span class="line">@<span class="number">3</span>FF</span><br><span class="line"><span class="number">1110</span>_0010</span><br></pre></td></tr></table></figure><ul><li>可以使用<code>_</code>进行分隔，便于观察</li><li>使用空格或者换行来区分单个数据</li><li>使用<code>@+地址</code>来表示之后从第几位开始，注意这里不是第几个bit，而是第几个数据</li></ul><h2 id="系统任务函数"><a class="markdownIt-Anchor" href="#系统任务函数"></a> 系统任务（函数）</h2><table><thead><tr><th>名称</th><th>作用</th></tr></thead><tbody><tr><td>$time</td><td>显示仿真时间，也就是第几十纳秒</td></tr><tr><td>$stime</td><td>返回32位时间</td></tr><tr><td>$realtime</td><td>显示实数的时间（有小数）</td></tr><tr><td>$display</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy="false">(</mo><mi mathvariant="normal">“</mi><mi mathvariant="normal">显</mi><mi mathvariant="normal">示</mi><mi mathvariant="normal">格</mi><mi mathvariant="normal">式</mi><mi mathvariant="normal">控</mi><mi mathvariant="normal">制</mi><mi mathvariant="normal">符</mi><mi mathvariant="normal">”</mi><mo separator="true">,</mo><mo>&lt;</mo><mi mathvariant="normal">输</mi><mi mathvariant="normal">出</mi><mi mathvariant="normal">变</mi><mi mathvariant="normal">量</mi><mi mathvariant="normal">（</mi><mi mathvariant="normal">信</mi><mi mathvariant="normal">号</mi><mi mathvariant="normal">）</mi><mi mathvariant="normal">列</mi><mi mathvariant="normal">表</mi><mo>&gt;</mo><mo stretchy="false">)</mo><mo separator="true">;</mo><mo separator="true">,</mo><mi mathvariant="normal">例</mi><mi mathvariant="normal">如</mi><mi mathvariant="normal">‘</mi></mrow><annotation encoding="application/x-tex">display (“显示格式控制符”, &lt;输出变量（信号）列表&gt;);,例如`</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord">“</span><span class="mord cjk_fallback">显</span><span class="mord cjk_fallback">示</span><span class="mord cjk_fallback">格</span><span class="mord cjk_fallback">式</span><span class="mord cjk_fallback">控</span><span class="mord cjk_fallback">制</span><span class="mord cjk_fallback">符</span><span class="mord">”</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord cjk_fallback">输</span><span class="mord cjk_fallback">出</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">（</span><span class="mord cjk_fallback">信</span><span class="mord cjk_fallback">号</span><span class="mord cjk_fallback">）</span><span class="mord cjk_fallback">列</span><span class="mord cjk_fallback">表</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mclose">)</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">例</span><span class="mord cjk_fallback">如</span><span class="mord">‘</span></span></span></span>display ($time, &quot; a = %b b = %b c = %b y = %b&quot;, a, b, c, y);``%`</td></tr><tr><td>$moniter</td><td>和display作用类似，都是输出到控制台，不同的是display只有运行到display语句才会执行，而moniter只要显示的量改变就会执行</td></tr><tr><td>$finish / $finish(n)</td><td>中断仿真， n是中断仿真的时间</td></tr><tr><td>$stop</td><td>和finish用法相同</td></tr><tr><td>$readmemb</td><td>从文件中读取二进制数据，$readmemb (“数据文件名”, 数组（存储器）名, &lt;起始地址&gt;, &lt;结束地址&gt;);</td></tr><tr><td>$readmemb</td><td>从文件中读取十六进制数据</td></tr><tr><td>$fopen</td><td>$fopen(“文件名“, “操作模式“); 打开文件，操作模式有w,w+, a, a+。fopen会返回一个int型值，可以被fclose用来关闭文件</td></tr><tr><td>$fclose</td><td>关闭文件</td></tr></tbody></table><p><strong>打开文件将控制台输入导入文件示例</strong></p><figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">int MCD;</span><br><span class="line">MCD = <span class="symbol">$</span>fopen(“文件名“, “操作模式“);</span><br><span class="line"><span class="meta"><span class="meta-keyword">$fdisplay</span>( MCD, “显示格式控制符”, &lt;输出变量（信号）列表&gt;);</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$fmonitor</span>( MCD, “显示格式控制符”, &lt;输出变量（信号）列表&gt;);</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$fclose</span>( MCD);</span></span><br></pre></td></tr></table></figure><p>display的<code>%</code>后面的参数可以为</p><table><thead><tr><th>%h</th><th>%o</th><th>%d</th><th>%b</th><th>%c</th><th>%s</th><th>%t</th><th>%m</th></tr></thead><tbody><tr><td>16进制</td><td>8</td><td>10</td><td>2</td><td>ASCII</td><td>字符串</td><td>时间</td><td>模块名</td></tr></tbody></table><h1 id="算术电路"><a class="markdownIt-Anchor" href="#算术电路"></a> 算术电路</h1><h2 id="加法器"><a class="markdownIt-Anchor" href="#加法器"></a> 加法器</h2><p><strong>半加法器</strong></p><p>半加法器很容易想到使用异或操作，但是半加法器也有一个进位的输出，它的真值表为：</p><table><thead><tr><th>A</th><th>B</th><th><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th>S</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>0</td><td>1</td><td>0</td><td>1</td></tr><tr><td>1</td><td>0</td><td>0</td><td>1</td></tr><tr><td>1</td><td>1</td><td>1</td><td>0</td></tr></tbody></table><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">S</span> = A ^ B</span><br><span class="line"><span class="attr">C_out</span> = A &amp; B //只有两个都是<span class="number">1</span>才会进位</span><br></pre></td></tr></table></figure><p><strong>全加器</strong></p><p>全加器相比于半加器还把上一个加法器来的进位考虑进去了<br /><img src="/images/%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%806.png" alt="" /></p><p>它的表达式为：</p><figure class="highlight dns"><table><tr><td class="code"><pre><span class="line">S = <span class="keyword">A</span> ^ B ^ C</span><br><span class="line">C_out = <span class="keyword">A</span> &amp; B + (<span class="keyword">A</span> ^ B) &amp; C_in<span class="comment">;</span></span><br><span class="line"><span class="keyword">A</span> &amp; B表示a和b同时为<span class="number">1</span>时产生进位。 </span><br><span class="line"><span class="keyword">A</span> ^ B表示<span class="keyword">A</span>，B有一个为<span class="number">1</span>时结果为<span class="number">1</span>，与上C_in就表示<span class="keyword">A</span>和B中有一个为<span class="number">1</span>并且C_in为<span class="number">1</span>就进位。</span><br><span class="line"></span><br><span class="line">其实(<span class="keyword">A</span> | B) &amp; C_in也可以，但是前面已经有一个<span class="keyword">A</span> ^ B了，在电路中我们可以直接拉一根导线然后和C_in相与，这样就少了一个或的器件</span><br></pre></td></tr></table></figure><h3 id="行波进位加法器"><a class="markdownIt-Anchor" href="#行波进位加法器"></a> 行波进位加法器</h3><p>这是一种最为朴素的多位加法器，就是上一个加法器计算完成之后将进位给下一个加法器，直到最后一个加法器计算完成。</p><p><img src="/images/%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%807.PNG" alt="" /></p><p>如图是一个四位的行波进位加法器，每个方框代表一个加法器，而红色部分代表关键路径</p><h3 id="先行进位加法器"><a class="markdownIt-Anchor" href="#先行进位加法器"></a> 先行进位加法器</h3><p>先行进位比行波进位更为快速，但消耗的硬件资源更多。</p><p>公式推导</p><figure class="highlight dns"><table><tr><td class="code"><pre><span class="line">可以把S = <span class="keyword">A</span> &amp; B 看成 G</span><br><span class="line">把(<span class="keyword">A</span> ^ B) 看成P</span><br><span class="line">于是 C_out = G + P C_in<span class="comment">;</span></span><br></pre></td></tr></table></figure><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mn>3</mn></mrow></msub><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>G</mi><mn>3</mn></msub><mo>+</mo><msub><mi>P</mi><mn>3</mn></msub><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mn>2</mn></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mn>2</mn></mrow></msub><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>G</mi><mn>2</mn></msub><mo>+</mo><msub><mi>P</mi><mn>2</mn></msub><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mn>1</mn></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mn>1</mn></mrow></msub><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>G</mi><mn>1</mn></msub><mo>+</mo><msub><mi>P</mi><mn>1</mn></msub><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mn>1</mn></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mn>0</mn></mrow></msub><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>G</mi><mn>0</mn></msub><mo>+</mo><msub><mi>P</mi><mn>1</mn></msub><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mn>3</mn></mrow></msub><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>G</mi><mn>3</mn></msub><mo>+</mo><msub><mi>P</mi><mn>3</mn></msub><mo stretchy="false">(</mo><msub><mi>G</mi><mn>2</mn></msub><mo>+</mo><msub><mi>P</mi><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi>G</mi><mn>1</mn></msub><mo>+</mo><msub><mi>P</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub><mi>G</mi><mn>0</mn></msub><mo>+</mo><msub><mi>P</mi><mn>0</mn></msub><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>G</mi><mn>3</mn></msub><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>G</mi><mn>3</mn></msub><mo>+</mo><msub><mi>P</mi><mn>3</mn></msub><mo stretchy="false">(</mo><msub><mi>G</mi><mn>2</mn></msub><mo>+</mo><msub><mi>P</mi><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi>G</mi><mn>1</mn></msub><mo>+</mo><msub><mi>P</mi><mn>1</mn></msub><msub><mi>G</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>P</mi><mn>3</mn></msub><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>P</mi><mn>3</mn></msub><msub><mi>P</mi><mn>2</mn></msub><msub><mi>P</mi><mn>1</mn></msub><msub><mi>P</mi><mn>0</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}C_{out3} =&amp; G_3 + P_3 C_{out2}\\C_{out2} =&amp; G_2 + P_2 C_{out1}\\C_{out1} =&amp; G_1 + P_1 C_{out1}\\C_{out0} =&amp; G_0 + P_1 C_{in}\\C_{out3} =&amp; G_3 + P_3 (G_2 + P_2 (G_1 + P_1 (G_0 + P_0 C_{in})))\\G_3 =&amp; G_3 + P_3 (G_2 + P_2 (G_1 + P_1 G_0 ))\\P_3 =&amp; P_3 P_2 P_1 P_0\\\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.500000000000004em;vertical-align:-5.000000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.500000000000001em;"><span style="top:-7.660000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-6.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-4.659999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-3.1599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-0.15999999999999837em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:1.3400000000000016em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.000000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.500000000000001em;"><span style="top:-7.660000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-6.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.659999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.1599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span><span style="top:-0.15999999999999837em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span><span style="top:1.3400000000000016em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.000000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>通过上面我们可以看到，先行进位可以通过计算G和P快速得到进位。</p><p><img src="/images/%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%808.PNG" alt="" /></p><p>这是先行进位加法器的电路图。例如把32位的加法器分成8组，每组四个加法器。</p><ul><li>一旦开始通电，则每组的G和P都可以并行计算得到，总共需要的时间为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{pg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>(这是计算<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>G</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">G_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>所需要的时间，也就是一个与门或者是或门所需要的时间。还有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mrow><mi>p</mi><msub><mi>g</mi><mi>b</mi></msub><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{pg_block}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>,这段时间是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>G</mi><mrow><mn>3</mn><mo>:</mo><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">G_{3:0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mrel mtight">:</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>所需要的时间，也就是6个与或门所需要的时间</li><li>一旦上一个先行进位计算完成，就可以传输到下一个先行进位计算器，到最后一个先行进位计算器所需要的时间为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>t</mi><mrow><mi>p</mi><msub><mi>g</mi><mi>b</mi></msub><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi></mrow></msub><mo>+</mo><mn>7</mn><mo>∗</mo><msub><mi>t</mi><mrow><mi>a</mi><mi>n</mi><msub><mi>d</mi><mi>o</mi></msub><mi>r</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{pg} + t_{pg_block} + 7 * t_{and_or}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.86518em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">n</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span></span></span></span>.前面两个是第一段计算G和P的时间，因为是同步计算，所以第一个计算完G和P的时候其他的也计算完了。其他的只需要等待进位到来就可以计算。而<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mrow><mi>a</mi><mi>n</mi><msub><mi>d</mi><mi>o</mi></msub><mi>r</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{and_or}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.86518em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">n</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mi mathvariant="normal">到</mi><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{in}到C_{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">到</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>那一段。</li><li>最后一个先行进位计算完成之后，给最后一组四个加法器进行计算，加法器内部使用的是行波进位，我们可以把行波进位时间设为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mrow><mi>F</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{FA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li></ul><p>因此总时间为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mrow><mi>p</mi><mi>g</mi></mrow></msub><mo>+</mo><msub><mi>t</mi><mrow><mi>p</mi><msub><mi>g</mi><mi>b</mi></msub><mi>l</mi><mi>o</mi><mi>c</mi><mi>k</mi></mrow></msub><mo>+</mo><mn>7</mn><mo>∗</mo><msub><mi>t</mi><mrow><mi>a</mi><mi>n</mi><msub><mi>d</mi><mi>o</mi></msub><mi>r</mi></mrow></msub><mo>+</mo><msub><mi>t</mi><mrow><mi>F</mi><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{pg} + t_{pg_block} + 7 * t_{and_or} + t_{FA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.86518em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">n</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;硬件描述语言hdl大致功用&quot;&gt;&lt;a class=&quot;markdown</summary>
      
    
    
    
    <category term="逻辑电路" scheme="http://xinhecuican.github.io/categories/%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF/"/>
    
    
  </entry>
  
  <entry>
    <title>GPU编程</title>
    <link href="http://xinhecuican.github.io/post/8e75958d.html"/>
    <id>http://xinhecuican.github.io/post/8e75958d.html</id>
    <published>2021-03-21T06:30:00.000Z</published>
    <updated>2021-03-21T07:47:50.770Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="gpu结构"><a class="markdownIt-Anchor" href="#gpu结构"></a> GPU结构</h1><p>每个GPU中有若干个<strong>GPC（图形计算簇）</strong>，每个GPC中又有若干个<strong>TPC（Texture Processing cluster)</strong>, 每个TPC中有若干个<strong>SM（Stream Multiprocessor)</strong>,每个SM中有若干个block，在block中有各种各样的核和寄存器。</p><blockquote><p>在GPU编程中，通常把cpu称作host，把gpu称作device。</p></blockquote><p>计算过程：</p><ul><li>数据从cpu拷贝到gpu显存中</li><li>加载GPU程序并运行</li><li>将运行完后的数据又送回CPU中</li></ul><h1 id="cuda编程"><a class="markdownIt-Anchor" href="#cuda编程"></a> CUDA编程</h1><p>基本结构：</p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">malloc();</span><br><span class="line">cudamalloc(); <span class="regexp">//</span>分配显存</span><br><span class="line">cudaMemcpy(): <span class="regexp">//</span>将内存中的内容放到显存中</span><br><span class="line">kernelName&lt;&lt;&lt;gridSize, blockSize&gt;&gt;&gt;(input_params);<span class="regexp">//</span>计算过程，input_params是运行的函数</span><br><span class="line"></span><br><span class="line">cudaMemcpy();</span><br><span class="line">cudaFree();</span><br></pre></td></tr></table></figure><p>例如：</p><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">__global__ void add(<span class="built_in">int</span> *a, <span class="built_in">int</span> *b, <span class="built_in">int</span> *c)</span><br><span class="line">&#123;</span><br><span class="line">    *c = *a + *b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main(void) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> a, b, c;<span class="comment">// host copies of a, b, c</span></span><br><span class="line">    <span class="built_in">int</span> *d_a, *d_b, *d_c;<span class="comment">// device copies of a, b, c</span></span><br><span class="line">    <span class="keyword">in</span> tsize = sizeof(<span class="built_in">int</span>);<span class="comment">// Allocate space for device copies of a, b, c，</span></span><br><span class="line">    </span><br><span class="line">    分配内存</span><br><span class="line">    cuda<span class="constructor">Malloc((<span class="params">void</span><span class="operator">**</span>)</span>&amp;d_a, size);</span><br><span class="line">    cuda<span class="constructor">Malloc((<span class="params">void</span><span class="operator">**</span>)</span>&amp;d_b, size);</span><br><span class="line">    cuda<span class="constructor">Malloc((<span class="params">void</span><span class="operator">**</span>)</span>&amp;d_c, size);<span class="comment">// Setup input values，</span></span><br><span class="line">    </span><br><span class="line">    设置输入数据</span><br><span class="line">    a = <span class="number">2</span>;</span><br><span class="line">    b = <span class="number">7</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Copy inputs to device，拷贝数据到GPU的显存</span></span><br><span class="line">    cuda<span class="constructor">Memcpy(<span class="params">d_a</span>, &amp;<span class="params">a</span>, <span class="params">size</span>, <span class="params">cudaMemcpyHostToDevice</span>)</span>;</span><br><span class="line">    cuda<span class="constructor">Memcpy(<span class="params">d_b</span>, &amp;<span class="params">b</span>, <span class="params">size</span>, <span class="params">cudaMemcpyHostToDevice</span>)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Launch add() kernel on GPU，执行kernel</span></span><br><span class="line">    add&lt;&lt;&lt;<span class="number">1</span>,<span class="number">1</span>&gt;&gt;&gt;(d_a, d_b, d_c);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Copy result back to host，数据拷贝回host内存</span></span><br><span class="line">    cuda<span class="constructor">Memcpy(&amp;<span class="params">c</span>, <span class="params">d_c</span>, <span class="params">size</span>, <span class="params">cudaMemcpyDeviceToHost</span>)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Cleanup，释放内存cudaFree(d_a); </span></span><br><span class="line">    cuda<span class="constructor">Free(<span class="params">d_b</span>)</span>; cuda<span class="constructor">Free(<span class="params">d_c</span>)</span>;return <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>函数前的标识：</strong></p><ul><li><code>__global__</code>: 表示在device上执行，从host中调用。它的返回类型必须是void，并且它不会等待函数执行完主线程就会进行下一步。</li><li><code>__device__</code>: 在device上执行，并且从device中调用</li><li><code>__host__</code>: host执行，host调用，默认值</li></ul><p><strong>函数中变量类型：</strong></p><ul><li><p><code>__device__</code>: grid中所有线程都可以访问</p></li><li><p><code>__constant__</code>: 常量内存</p></li><li><p><code>__shared__</code>: 只有同一个block中的线程才可以访问</p></li><li><p>&lt;&lt;&lt;gridsize, blocksize&gt;&gt;&gt;: 调用的基本结构为 grid(网格）-&gt;block(块)-&gt;thread(线程).例如&lt;&lt;&lt;1, 1&gt;&gt;&gt;代表这个网格中有一个块，这个块中有一个线程。</p></li></ul><p>grid和thread都是dim3型变量，dim3可以看成包含三个整数的结构体。我们可以自由的定义grid或thread为一维、二维或三维,他们的默认值都是1。例如：</p><figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">dim3 </span><span class="keyword">block(3, </span><span class="number">3</span>);</span><br><span class="line"><span class="keyword">add&lt;&lt;&lt;1, </span><span class="keyword">block&gt;&gt;&gt;(...);</span></span><br><span class="line"><span class="keyword">表示有一个块，每块中有(3, </span><span class="number">3</span>)个线程</span><br><span class="line"></span><br><span class="line">上面的例子可以变成</span><br><span class="line"><span class="keyword">add&lt;&lt;&lt;N, </span><span class="number">1</span>&gt;&gt;&gt;(d_a, d_b, d_c);</span><br><span class="line"></span><br><span class="line">__global__ void <span class="keyword">add(int </span>*a, int *<span class="keyword">b, </span>int *c)</span><br><span class="line">&#123;</span><br><span class="line">    c[<span class="keyword">blockIdx.x] </span>= a[<span class="keyword">blockIdx.x] </span>+ <span class="keyword">b[blockIdx.x];</span></span><br><span class="line"><span class="keyword">&#125;</span></span><br></pre></td></tr></table></figure><p>每一个线程都可以用(blockIdx, threadIdx)进行标识，这两个变量都是dim3类型的，因此上面的例子中就可以使用blockIdx.x表示这是第几个block.</p><p>变量：</p><ul><li>gridDim: grid维度,dim3型</li><li>blockDim: block维度</li><li>blockIdx:</li><li>threadIdx:</li><li>warpSize: 大小固定为32</li></ul><p>每个grid都是在一个SM上的，而SM空间有限，因此每次可以使用的线程是有上限的，一般是1024.</p><p><strong>内存分配：</strong></p><p>内存分为两种</p><ul><li>可分配内存： malloc()/new() 操作所得到的内存，这种内存由cpu进行管理，可能被分页机制换下</li><li>分页锁定内存： 这种内存受gpu控制，不受cpu调度影响，可以使用dma直接读取<ul><li><code>cudaMallocHost(void **ptr, size_t size)</code></li><li><code>cudaHostAlloc(void **pHost, size_t size, unsigned int flags)</code>:<ul><li>cudaHostAllocPortable：多个CPU线程都可访问</li><li>cudaHostAllocWriteCombined：数据传输快，但只允许host写（读速度慢)</li><li>cudaHostAllocMapped：CPU/GPU都可访，属于内存映射</li></ul></li><li><code>cudaHostRegister( void* ptr, size_tsize, unsigned intflags )</code>: 可分页内存转换为分页锁定内存</li></ul></li></ul><p><strong>显存分配</strong></p><ul><li>cudaMalloc()： 一维数组，数据连续存储</li><li>cudaMallocPitch()： 二维数组，会自动对齐，可能会浪费部分内存空间</li><li>cudaMalloc3D()：三维数组</li></ul><p><strong>统一寻址</strong></p><p>统一寻址指的是系统自动在host和device之间搬运数据，同时保证host和device都可访问，并且需要进行显式同步。（因为系统会在运行函数时同时进行下一步）</p><p>例如：</p><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line">__global__ void <span class="keyword">add</span>(<span class="keyword">int</span> *<span class="keyword">ret</span>, <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">ret</span>[threadIdx<span class="number">.</span>x] = a + b + threadIdx<span class="number">.</span>x<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> *<span class="keyword">ret</span><span class="comment">;</span></span><br><span class="line">    cudaMallocManaged(&amp;<span class="keyword">ret</span>, <span class="number">1000</span> * sizeof(<span class="keyword">int</span>))<span class="comment">;//自动进行显存内存分配及数据搬运</span></span><br><span class="line">    <span class="keyword">add</span>&lt;&lt;&lt;<span class="number">1</span>, <span class="number">1000</span>&gt;&gt;&gt;(<span class="keyword">ret</span>, <span class="number">10</span>, <span class="number">100</span>)<span class="comment">;</span></span><br><span class="line">    cudaDeviceSynchronized()<span class="comment">;//进行同步</span></span><br><span class="line">    for(<span class="keyword">int</span> i=<span class="number">0</span><span class="comment">; i&lt;1000; i++)</span></span><br><span class="line">    &#123;</span><br><span class="line">        printf(<span class="string">&quot;%d&quot;</span>, <span class="keyword">ret</span>[i])<span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line">    cudaFree(<span class="keyword">ret</span>)<span class="comment">;</span></span><br><span class="line">    return <span class="number">0</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;gpu结构&quot;&gt;&lt;a class=&quot;markdownIt-Ancho</summary>
      
    
    
    
    <category term="并行" scheme="http://xinhecuican.github.io/categories/%E5%B9%B6%E8%A1%8C/"/>
    
    
  </entry>
  
  <entry>
    <title>OpenMP并行编程</title>
    <link href="http://xinhecuican.github.io/post/75223936.html"/>
    <id>http://xinhecuican.github.io/post/75223936.html</id>
    <published>2021-03-16T13:17:00.000Z</published>
    <updated>2021-03-24T13:01:30.874Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="基础"><a class="markdownIt-Anchor" href="#基础"></a> 基础</h1><p>OpenMP是一种面向共享内存以及分布式共享内存的多处理器多线程并行编程模型。它支持c++, c, Fortran语言。</p><p>它在最开始的时候只有主线程，在需要的时候又可以分出多个线程进行计算，计算完毕之后又可以变成一个线程。</p><p>它的头文件是<code>omp.h</code></p><p>一个例子:</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;omp.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> res[<span class="number">1000</span>];</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">pragma</span> omp parallel for</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">1000</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            do_huge_comp(res[i]);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="编译制导语句"><a class="markdownIt-Anchor" href="#编译制导语句"></a> 编译制导语句</h1><h1 id="同步与作用域"><a class="markdownIt-Anchor" href="#同步与作用域"></a> 同步与作用域</h1><ul><li><p><code>#pragma omp master</code>: 表明该区域只能由主线程执行</p></li><li><p><code>#pragma omp critical (name)</code>: 临界区，一次只能由一个线程执行</p></li><li><p><code>#pragma omp barrier</code>: 用来同步所有线程，先到达的会等待，直到所有线程到达</p></li><li><p><code>#pragma omp atomic</code>: 表明该语句是原子指令</p></li><li><p><code>#pragma omp flush(list)</code>: flush用来同步内存，他会在如for退出或进入critical区域时隐含执行，使用nowait除外</p></li><li><p><code>#pragma omp ordered</code>: 将让循环在这片区域内按次序进行</p></li><li><p>private： 线程在这片区域内私有，并且会自动初始为0</p></li><li><p>shared： 所有线程共享。<strong>使用并行区域外部的变量时默认是共享的</strong></p></li><li><p>default: 确定变量在并行域的初始值</p></li><li><p>firstprivate: 私有变量的初始值是外部变量的值</p></li><li><p>lastprivate: 将最后的私有变量的值赋给全局变量（也就是主线程的）</p></li><li><p>reduction： 在sections中讲了</p></li><li><p>threadprivate: 这是线程在进程整个生命周期中都拥有的变量，一般写在main前面。例如一个变量声明为threadprivate,在一个parallel语句内部改变了，在下一个parallel语句中使用改变了的值</p></li><li><p>copyin: 为线程中所有threadprivate变量赋相同的值（可以使用外部的变量进行赋值）</p></li><li></li></ul><h2 id="并行域"><a class="markdownIt-Anchor" href="#并行域"></a> 并行域</h2><p>并行域表示在并行域中的代码将会由多个线程执行</p><p>格式：</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> omp parallel [clause...]</span></span><br><span class="line"></span><br><span class="line">clause = </span><br><span class="line"><span class="keyword">if</span>()</span><br><span class="line"><span class="keyword">private</span>()： 表明变量在这个并行区域内是线程私有的</span><br><span class="line">firstprivate()</span><br><span class="line"><span class="keyword">default</span>(shared | none)</span><br><span class="line">shared()</span><br><span class="line">copyin()</span><br><span class="line">reduction()</span><br><span class="line">num_threads(): 指开启的线程数</span><br><span class="line"></span><br><span class="line">例如：</span><br><span class="line"><span class="keyword">int</span> nthreads, tid;</span><br><span class="line"><span class="meta"># pargma omp parallel private(tid)</span></span><br><span class="line">&#123;</span><br><span class="line">    tid = omp_get_thread_num();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello thread=%d\n&quot;</span>, tid);</span><br><span class="line">    <span class="keyword">if</span>(tid == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        nthreads = omp_get_num_threads();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;num of threads = %d\n&quot;</span>, nthreads);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="for语句"><a class="markdownIt-Anchor" href="#for语句"></a> for语句</h2><p>for语句指定它后面的for将会由线程组执行。但是它只可以并行化执行for循环，而不会执行while循环。实际上如果中间有break也不能用for语句</p><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">格式：</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> omp for [clause]</span></span><br><span class="line"></span><br><span class="line">clause:</span><br><span class="line">Schedule(type[, chunk]): chunk表示一个线程每次会得到多少循环次数.type有<span class="keyword">static</span> </span><br><span class="line">   和<span class="built_in">dynamic</span>。<span class="keyword">static</span>是按照chunk预先分配，<span class="built_in">dynamic</span>是执行完这个chunk向系统再要一</span><br><span class="line">   个chunk</span><br><span class="line">ordered</span><br><span class="line">lastprivate()</span><br><span class="line">nowait</span><br><span class="line">上面的除了<span class="literal">default</span>， copyin, num_threads()</span><br></pre></td></tr></table></figure><p><img src="/images/OpenMP%E5%B9%B6%E8%A1%8C%E7%BC%96%E7%A8%8B1.PNG" alt="" /></p><h2 id="sections语句"><a class="markdownIt-Anchor" href="#sections语句"></a> Sections语句</h2><p>Sections语句规定每个线程完成不同任务</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">格式：</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> omp sections [clause..]</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">pragma</span> omp section</span></span><br><span class="line">    &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">#<span class="meta-keyword">pragma</span> omp section</span></span><br><span class="line">    &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">clause:</span><br><span class="line"></span><br><span class="line">* <span class="keyword">private</span>()</span><br><span class="line">* firstprivate()</span><br><span class="line">* lastprivate()</span><br><span class="line">* reduction(<span class="keyword">operator</span>: <span class="built_in">list</span>)： reduction内的变量时区域私有变量(也就是说不用加<span class="keyword">private</span>了），并且reduction在每个线程结束时将私有变量进行运算。例如： reduction(+: ans)就是将每个线程的ans私有变量相加，然后赋值给全局ans</span><br><span class="line">* nowait</span><br></pre></td></tr></table></figure><h1 id="single语句"><a class="markdownIt-Anchor" href="#single语句"></a> single语句</h1><p>single指名该区域只能有一个线程执行。线程组中没有执行single语句会等待内部线程结束，使用nowait除外。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;基础&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; </summary>
      
    
    
    
    <category term="并行" scheme="http://xinhecuican.github.io/categories/%E5%B9%B6%E8%A1%8C/"/>
    
    
  </entry>
  
  <entry>
    <title>组合逻辑设计</title>
    <link href="http://xinhecuican.github.io/post/70d4f4af.html"/>
    <id>http://xinhecuican.github.io/post/70d4f4af.html</id>
    <published>2021-03-07T07:46:00.000Z</published>
    <updated>2021-03-19T11:59:44.009Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="组合电路和时序电路"><a class="markdownIt-Anchor" href="#组合电路和时序电路"></a> 组合电路和时序电路</h1><ul><li>组合电路： 由当前输入值决定输出值</li><li>时序电路： 由当前输入值和前一阶段的输入值共同决定输出</li></ul><p>例如:</p><p><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A11.jpg" alt="" /></p><p>图b和图f属于时序电路，因为它的输出转化为了下一次的输入。图f中的符号是组合电路</p><p>图d是一个错误电路，因为到n6点可能会冲突</p><h1 id="布尔表达式"><a class="markdownIt-Anchor" href="#布尔表达式"></a> 布尔表达式</h1><p>一些术语：</p><ul><li><code>*</code>: 与符号，取交集，也叫相乘</li><li><code>+</code>： 或符号，取并集，也叫相加</li><li>项： 变量或者它的反</li><li>最小项： 一个包含全部输入变量的乘积项。例如有三个变量A、B、C，则ABC是一个最小项（也就是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>∩</mo><mi>B</mi><mo>∩</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A \cap B \cap C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>), 而AB不是</li><li>最大项： 包含全部输入的和。 例如 A + B + C(也就是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>∪</mo><mi>B</mi><mo>∪</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A \cup B \cup C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>)是一个最大项</li><li>蕴涵项： 多个项相乘</li></ul><h2 id="与或式与或与式"><a class="markdownIt-Anchor" href="#与或式与或与式"></a> 与或式与或与式</h2><p><strong>与或式</strong></p><table><thead><tr><th>A</th><th>B</th><th>Y</th><th>最小项</th><th>最小项名称</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{A} \bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">m_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>0</td><td>1</td><td>1</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mi>B</mi></mrow><annotation encoding="application/x-tex">\bar{A} B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">m_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>1</td><td>0</td><td>0</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">A \bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">m_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>1</td><td>1</td><td>0</td><td>A B</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>m</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">m_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr></tbody></table><blockquote><p>真值表每一项都和一个为 TRUE的最小项相关联，并且它的编号正好是AB的二进制值，例如AB = 10 则为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">m_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p></blockquote><p>只有当AB为真时对应的最小项才为真，其他都为假。例如只有当A = 0 ，B = 1时<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mi>B</mi></mrow><annotation encoding="application/x-tex">\bar{A} B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>才为真。</p><p>所有函数都可以写成有表中最小项相与所构成的表达式。例如 Y = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">A\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span> + BA.由于这种先与后或的表达方式所以被称为与或式。</p><p>因此也可以使用最小项的序号进行表达，如 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mo>∑</mo><mo stretchy="false">(</mo><msub><mi>m</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>m</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mo>∑</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(A, B) = \sum (m_1 , m_3 ) = \sum (1, 3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span></p><blockquote><p>如果给出了真值表那么可以唯一的用一个与或式表达，例如上面与或式为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mi>B</mi></mrow><annotation encoding="application/x-tex">\bar{A} B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>，因为只有在A为0，B为1时为真，其他都是0</p></blockquote><p>也可以使用或与式进行表达：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mo>+</mo><mi>B</mi><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mo>+</mo><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Y = (A + B) * (\bar{A} + B) * (\bar{A} + \bar{B})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.07011em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.07011em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.07011em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>可以看出与或式与或与式正好相反，编号相同的与或式和或与式互为反函数。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub><mo>=</mo><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mover accent="true"><mi>C</mi><mo>ˉ</mo></mover><mo>=</mo><mover accent="true"><mrow><mi>A</mi><mo>+</mo><mi>B</mi><mo>+</mo><mi>C</mi></mrow><mo stretchy="true">‾</mo></mover><mo>=</mo><mover accent="true"><mi>M</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">m_0 = \bar{A}\bar{B}\bar{C} = \overline{A + B +C} = \bar{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9666600000000001em;vertical-align:-0.08333em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.08333em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span></span></p><p><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A13.PNG" alt="" /></p><p><strong>或与式</strong></p><table><thead><tr><th>A</th><th>B</th><th>Y</th><th>最大项</th><th>最小项名称</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td>A + B</td><td>$ M_0 $</td></tr><tr><td>0</td><td>1</td><td>1</td><td>A + <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">M_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>1</td><td>0</td><td>0</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span></span></span></span> + B</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">M_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>1</td><td>1</td><td>1</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mo>+</mo><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{A} + \bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9034399999999999em;vertical-align:-0.08333em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>M</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">M_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr></tbody></table><p>这里要求最大项输出为假</p><h2 id="定理"><a class="markdownIt-Anchor" href="#定理"></a> 定理</h2><table><thead><tr><th>编号</th><th>定理</th><th>编号</th><th>对偶定理</th><th>名称</th></tr></thead><tbody><tr><td>T1</td><td>B * 1 = B</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><msup><mn>1</mn><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msup></mrow><annotation encoding="application/x-tex">T1^{&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.94248em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-2.94248em;margin-right:0.05em;"><span class="pstrut" style="height:2.57948em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></td><td>B + 0 = B</td><td>同一性定理</td></tr><tr><td>T2</td><td>B * 0 = 0</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><msup><mn>2</mn><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msup></mrow><annotation encoding="application/x-tex">T2^{&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.94248em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-2.94248em;margin-right:0.05em;"><span class="pstrut" style="height:2.57948em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></td><td>B + 1 = 1</td><td>零元定理</td></tr><tr><td>T3</td><td>B * B = B</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><msup><mn>3</mn><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msup></mrow><annotation encoding="application/x-tex">T3^{&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.94248em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-2.94248em;margin-right:0.05em;"><span class="pstrut" style="height:2.57948em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></td><td>B + B = B</td><td>重叠定理</td></tr><tr><td>T4</td><td></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mo>ˉ</mo></mover><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">\bar{\bar{B}} = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9568899999999998em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9568899999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span><span style="top:-3.38911em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span></td><td></td><td>回旋定理</td></tr><tr><td>T5</td><td>B * <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span> = 0</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><msup><mn>5</mn><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msup></mrow><annotation encoding="application/x-tex">T5^{&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.94248em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-2.94248em;margin-right:0.05em;"><span class="pstrut" style="height:2.57948em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></td><td>B + <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span> = 1</td><td>互补定理</td></tr><tr><td>T6</td><td>B * C = C * B</td><td>…</td><td>B + C  = C + B</td><td>交换律</td></tr><tr><td>T7</td><td>（B * C) * D = B * （C * D）</td><td>…</td><td>(B + C) + D  = B + (C + D)</td><td>结合律</td></tr><tr><td>T8</td><td>(B * C) + (B * D) = B * (C + D)</td><td>…</td><td>(B + C) * (B + D) = B + (C * D)</td><td>分配律</td></tr><tr><td>T9</td><td>B * (B + C) = B</td><td>…</td><td>B + (B * C) = B</td><td>吸收律</td></tr><tr><td>T10</td><td>(B * C) + (B * <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>C</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span>) = B</td><td>…</td><td>(B + C) * (B + <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>C</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span>) = B</td><td>合并律</td></tr><tr><td>T11</td><td>（B * C) + (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span> * D) + (C * D) = B * C + <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span> * D</td><td>…</td><td>(B + C) * (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span> + D) * (C + D)= (B + C) * (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span> + D)</td><td>一致律</td></tr><tr><td>T12</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><msub><mi>B</mi><mn>0</mn></msub><mo>∗</mo><msub><mi>B</mi><mn>1</mn></msub><mo>∗</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{B_{0} * B_{1} * ...}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03333em;vertical-align:-0.15em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span> = (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><msub><mi>B</mi><mn>0</mn></msub><mo>ˉ</mo></mover><mo>+</mo><mover accent="true"><msub><mi>B</mi><mn>1</mn></msub><mo>ˉ</mo></mover><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\bar{B_{0}} + \bar{B_{1}} ...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701099999999999em;vertical-align:-0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9701099999999999em;vertical-align:-0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span>)</td><td>…</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><msub><mi>B</mi><mn>0</mn></msub><mo>+</mo><msub><mi>B</mi><mn>1</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{B_{0} + B_{1} ... }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03333em;vertical-align:-0.15em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span> = (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><msub><mi>B</mi><mn>0</mn></msub><mo>ˉ</mo></mover><mo>∗</mo><mover accent="true"><msub><mi>B</mi><mn>1</mn></msub><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{B_{0}} * \bar{B_{1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701099999999999em;vertical-align:-0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9701099999999999em;vertical-align:-0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span>)</td><td>的摩根定律</td></tr></tbody></table><blockquote><p>使用这些定律就可以将一些式子简化了</p></blockquote><p>最小化式中最长使用的是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>A</mi><mo>+</mo><mi>P</mi><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mo>=</mo><mi>P</mi></mrow><annotation encoding="application/x-tex">PA + P\bar{A} = P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span>来合并项。我们称使用了最少蕴涵项的等式为<strong>最小与或式</strong>。如果蕴涵项数量相同，那么具有最少项数的与或式是最小与或式。</p><p>例如最小化等式： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mover accent="true"><mi>C</mi><mo>ˉ</mo></mover><mo>+</mo><mi>A</mi><mo>∗</mo><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mover accent="true"><mi>C</mi><mo>ˉ</mo></mover><mo>+</mo><mi>A</mi><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mi>C</mi></mrow><annotation encoding="application/x-tex">\bar{A} \bar{B} \bar{C} + A * \bar{B} \bar{C} + A \bar{B} C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9034399999999999em;vertical-align:-0.08333em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9034399999999999em;vertical-align:-0.08333em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mover accent="true"><mi>C</mi><mo>ˉ</mo></mover><mo>+</mo><mi>A</mi><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mover accent="true"><mi>C</mi><mo>ˉ</mo></mover><mo>+</mo><mi>A</mi><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mi>C</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mover accent="true"><mi>C</mi><mo>ˉ</mo></mover><mo>+</mo><mi>A</mi><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mover accent="true"><mi>C</mi><mo>ˉ</mo></mover><mo>+</mo><mi>A</mi><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mover accent="true"><mi>C</mi><mo>ˉ</mo></mover><mo>+</mo><mi>A</mi><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mi>C</mi><mi mathvariant="normal">重</mi><mi mathvariant="normal">叠</mi><mi mathvariant="normal">定</mi><mi mathvariant="normal">律</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mover accent="true"><mi>C</mi><mo>ˉ</mo></mover><mo>+</mo><mi>A</mi><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\bar{A} \bar{B} \bar{C} + A \bar{B} \bar{C} + A \bar{B} C &amp;= \bar{A} \bar{B} \bar{C} + A \bar{B} \bar{C} + A \bar{B} \bar{C} + A \bar{B} C 重叠定律\\&amp;= \bar{B} \bar{C} + A \bar{B}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0000000000000004em;vertical-align:-1.2500000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">A</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">A</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">A</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">A</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">A</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord cjk_fallback">重</span><span class="mord cjk_fallback">叠</span><span class="mord cjk_fallback">定</span><span class="mord cjk_fallback">律</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">A</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h1 id="从逻辑到门"><a class="markdownIt-Anchor" href="#从逻辑到门"></a> 从逻辑到门</h1><p>例如：<br /><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A12.jpg" alt="" /></p><p>这种排线还是很清晰的。为了便于观察，画图时最好遵循以下规范</p><p><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A13.jpg" alt="" /></p><ul><li>输入在左边（或上面）， 输出在右边（或下面）</li><li>门从左往右流</li><li>最好用直线</li></ul><h2 id="多级逻辑"><a class="markdownIt-Anchor" href="#多级逻辑"></a> 多级逻辑</h2><h3 id="减少硬件"><a class="markdownIt-Anchor" href="#减少硬件"></a> 减少硬件</h3><p>例如：<img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A14.PNG" alt="" /></p><p>这是一个三输入的异或门（异或又叫半加法，即不进位的加法，因此有奇数个1输出为1），可以看到里面使用了30个MOS晶体管（与门或者是或门需要6个晶体管）。</p><p>如果我们使用两个异或器件就可以减少到20个晶体管（异或最好的实现需要10个晶体管）</p><p>一个极端的例子是8输入的异或。这意味着我们需要128个8输入与门和一个128输入的或门，这是不可想象的。但是可以把它变成三级异或。</p><h3 id="推气泡"><a class="markdownIt-Anchor" href="#推气泡"></a> 推气泡</h3><p>例如：<img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A16.PNG" alt="" /></p><p>这个其实是异或操作。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>A</mi><mi>B</mi></mrow><mo stretchy="true">‾</mo></mover><mo>=</mo><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mo>+</mo><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\overline{AB} = \bar{A} + \bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833300000000001em;vertical-align:0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9034399999999999em;vertical-align:-0.08333em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span>,之后那两个气泡又可以抵消变成了我们常见的先与后或。但是这种只需要与非就可以完成并且比先与后或少用了晶体管。</p><h2 id="x-和-z"><a class="markdownIt-Anchor" href="#x-和-z"></a> x 和 z</h2><p><strong>x</strong></p><p>x表示<strong>未知</strong>或<strong>非法</strong>值，这通常表现在0和1汇合到一起的时候。<img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A17.PNG" alt="" /></p><p>除此之外，他还可以用来表示无关项，也就是这个输入是0是1对输出没有影响。例如：<br /><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A18.PNG" alt="" /></p><p><strong>z</strong></p><p>z表示浮空值，也叫开路、短路等。常见的产生浮空的原因是忘记将输入端接入电压（这时一般是0，但是如果什么东西接触就可能导致1），但是这并不代表浮空值一定是0，他可能是0或1，也可能是非法值。</p><p>浮空值的一个应用是<strong>三态缓冲器</strong><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A119.png" alt="" /></p><p>它的真值表为：</p><table><thead><tr><th>E</th><th>A</th><th>Y</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>Z</td></tr><tr><td>0</td><td>1</td><td>Z</td></tr><tr><td>1</td><td>0</td><td>0</td></tr><tr><td>1</td><td>0</td><td>1</td></tr></tbody></table><h1 id="卡诺图"><a class="markdownIt-Anchor" href="#卡诺图"></a> 卡诺图</h1><p><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A110.jpg" alt="" /></p><p>右边的就是一个卡诺图了。这里注意AB的顺序是00、 01、 11、 10而不是10、11。这种编码方式称为格雷码。</p><p>格雷码和普通的编码不同在于相邻元素<strong>只有一个变量不同</strong>并且<strong>起始元素和最后一个元素</strong>也只有一个变量不同，例如01和11只有第二个1不同，但是如果是00、01、10、11其中01和10就有两个不同了。</p><p>我们来看三个格雷码的构造：</p> <figure class="highlight tap"><table><tr><td class="code"><pre><span class="line">00<span class="number"> 01 </span>11<span class="number"> 10 </span>(对称轴)<span class="number"> 10 </span>11<span class="number"> 01 </span>00</span><br><span class="line">000<span class="number"> 001 </span>011<span class="number"> 010 </span>(对称轴）<span class="number"> 110 </span>111<span class="number"> 101 </span>100</span><br><span class="line"></span><br><span class="line">首先由对称轴对称分布之后在对称轴左边的添0右边添1</span><br><span class="line"></span><br><span class="line">一位的格雷码<span class="number"> 0 </span>1</span><br><span class="line"></span><br><span class="line">两位的格雷码 <span class="number"> 0 </span>1 (对称轴）<span class="number"> 1 </span>0</span><br><span class="line">00<span class="number"> 01 </span>（对称轴）<span class="number"> 11 </span>10</span><br></pre></td></tr></table></figure><p>在卡诺图中也可以使用对称轴的方式进行扩展。</p><p><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A111.jpg" alt="" /></p><h2 id="卡诺图的化简"><a class="markdownIt-Anchor" href="#卡诺图的化简"></a> 卡诺图的化简</h2><p><strong>卡诺图化简的依据是 $ PA + P \bar{A} = P$</strong></p><p>先看一个例子：<img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A112.jpg" alt="" /></p><p>Y = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mover accent="true"><mi>C</mi><mo>ˉ</mo></mover><mo>+</mo><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mi>C</mi></mrow><annotation encoding="application/x-tex">\bar{A}\bar{B}\bar{C} + \bar{A}\bar{B} C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9034399999999999em;vertical-align:-0.08333em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>。可以变成 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mo stretchy="false">(</mo><mi>C</mi><mo>+</mo><mover accent="true"><mi>C</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bar{A}\bar{B}(C + \bar{C})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.07011em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.07011em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，也就是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{A}\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span>.从卡诺图中可以看出圈中内容正好只有C有变化，便可以通过这个式子将它化简。</p><ul><li>卡诺图上任何两个标1的方格相邻，可以合为1项，并可消去1个（取值相反的）变量。</li><li>圈的1的数目必须是2的整数次幂，也就是2,4,8,16…</li><li>处于对称位置的1可以化简</li><li>可以重复圈同一个1，因为 A + A = A</li><li>圈必须覆盖全部的1</li></ul><p><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF13.jpg" alt="" /></p><p>这个图中用线圈起来的部分内部都是1</p><p>对于<strong>第三点</strong>可以举些例子，也就是图中红色标出的四个部分是可以化简的，化简结果为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>B</mi><mo>ˉ</mo></mover><mover accent="true"><mi>D</mi><mo>ˉ</mo></mover><mover accent="true"><mi>E</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{B}\bar{D}\bar{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201099999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">ˉ</span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span>.图中绿色部分也是可以化简的。</p><p>图中黄色部分也是可以化简的，可以看到他们只有C所在的位发生了变化。他们关于中间黄色的对称轴对称。</p><p>联想格雷码的构造过程，对称位置是直接复制并且最高位一个加1,一个加0，所以只会有最高位不同。</p><p><strong>但是蓝色部分虽然四个1连在一起，但是通过计算发现他们无法化到最简.结果为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>A</mi><mo>ˉ</mo></mover><mi>B</mi><mo stretchy="false">(</mo><mi>D</mi><mover accent="true"><mi>E</mi><mo>ˉ</mo></mover><mo>+</mo><mi>C</mi><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bar{A}B (D\bar{E} + CE)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.07011em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">A</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11110999999999999em;">ˉ</span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span></strong></p><blockquote><p>通过上面几个例子可以发现即使是连在一起的1也不一定可以化到最简，<strong>通过对称轴折叠可以折叠到一起的才能化到最简</strong></p></blockquote><p>一些概念：</p><ul><li>卡诺图上的每一个圈都代表一个蕴含项</li><li>主蕴含项：扩展到最大的蕴含项</li><li>奇异“1”单元：卡诺图中仅能被单一主蕴含项覆盖的方格</li><li>质主蕴含项：包含着一或多个的奇异“1”单元的主蕴含项</li></ul><p>例如：<img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A114.PNG" alt="" /></p><p>图中红色圈出来的1没有对称也没有相邻因此只能自己为一个蕴含项。</p><p>图中绿色字和红色字可以组成一个蕴含项，并且除了绿色和红色之外的其他1中只能和红色1组成蕴含项，不能和绿色1组成蕴涵项，因此<strong>绿色字是一个奇异“1”单元</strong>.</p><p>结果为<img src="/images/Inked%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A114_LI.jpg" alt="" /></p><p><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A115.png" alt="" /></p><p>首先找质主蕴含项： <img src="/images/Inked%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A115_LI.jpg" alt="" /></p><p>之后<img src="/images/InkedInked%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A115_LI.jpg" alt="" /></p><p>红色部分不必多说，关键是黄色和绿色部分，显然选择黄色的部分，所以要尽可能的选择大的。</p><p>化简标准：</p><ul><li>项数最少，意味着卡诺图中圈数最少</li><li>每项中的变量数最少，意味着卡诺图中的圈尽可能大</li></ul><h1 id="组合逻辑模块"><a class="markdownIt-Anchor" href="#组合逻辑模块"></a> 组合逻辑模块</h1><h2 id="复用器"><a class="markdownIt-Anchor" href="#复用器"></a> 复用器</h2><p><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A120.PNG" alt="" /></p><p>这是2:1复用器，也就是S为0时，输出由<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">D_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>决定，当S为1时，输出由<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">D_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>决定。</p><p><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A121.PNG" alt="" /></p><p>4：1复用器。当A为0，B为0时，输出由<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">D_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>决定。A为0，B为1时，输出由<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">D_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>决定，依次类推。</p><p>还有8:1复用器等，都是通过上方的门控选择哪个输出。</p><h2 id="编码器"><a class="markdownIt-Anchor" href="#编码器"></a> 编码器</h2><p>编码器是用n位二进制代码对 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">N=2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> 个特定信息进行编码的逻辑电路</p><p><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A122.png" alt="" /></p><p>EO用来判定是否存在有效输入（即$X_0 , X_1 , X_2 , X_3 $都是0时EO=1，其他情况都是0）</p><h2 id="译码器"><a class="markdownIt-Anchor" href="#译码器"></a> 译码器</h2><p>译码是编码的逆过程，输入有n个，输出有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>个</p><p><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A123.PNG" alt="" /></p><p>输出时独热的，同一时刻只能输出一个有效信号。相当于每个输出都是一个最小项</p><h1 id="毛刺"><a class="markdownIt-Anchor" href="#毛刺"></a> 毛刺</h1><ul><li>时序： 在实际电路中，某器件从输入到输出是需要经过一定的时间的</li><li>传播延迟（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mrow><mi>p</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{pd}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9011879999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>)： 从输入到输出变为最终值所需要的最长时间</li><li>最小延迟(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mrow><mi>c</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_{cd}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>): 从输入到输出改变所需要的时间</li><li>关键路径： 信号传输最慢的一条路径</li><li>最短路径： 信号传输最快的一条路径</li></ul><p><img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF24.PNG" alt="" /></p><p>上图A始终为0，C始终为1.它的最长路径就是B通过非门的那一段，最短路径是B直接连到下面的那一段。</p><p>假设B由1变0：</p><ol><li>理想情况下，开始\bar{A} && \bar{B} = 0 \quad \bar{B} && \bar{C} = 1, Y = 1,在B变为0后，\bar{A} && \bar{B} = 1 \quad \bar{B} && \bar{C} = 0, Y = 1。结果应该还是1</li><li>实际上B通过非门的那一条路比直接往下走这个条路慢，因此下面的与门会先输出，并且输出为0，这样Y就会有一段时间输出为0.最后上面的与门也完成输出后Y的结果才会变成1.因此Y的变化为1-&gt;0-&gt;1</li></ol><p>上面的这种现象就被称为毛刺，由于这种现象，所以我们不得不花一些时间等待电路稳定，减少毛刺就可以增快传递速度。</p><p>消除毛刺：</p><ol><li>当两个主蕴涵项相邻时它的相邻边缘会产生毛刺。<img src="/images/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF25.PNG" alt="" /></li></ol><p>例如上图，浅蓝色是最开始画的，而在001和011之间就是两个主蕴含项的边缘了，我们使用额外增加一项来消除边缘</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;组合电路和时序电路&quot;&gt;&lt;a class=&quot;markdownIt-A</summary>
      
    
    
    
    <category term="逻辑电路" scheme="http://xinhecuican.github.io/categories/%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF/"/>
    
    
  </entry>
  
  <entry>
    <title>git操作</title>
    <link href="http://xinhecuican.github.io/post/46390b34.html"/>
    <id>http://xinhecuican.github.io/post/46390b34.html</id>
    <published>2021-03-06T03:38:46.000Z</published>
    <updated>2021-03-06T07:32:20.910Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><ul><li>git status： 查看当前工作区修改状态</li><li>git add: 添加到暂存区</li><li>git commit -m “…”： 将暂存区内容添加到仓库</li><li>git diff + 文件名： 查看当前文件和上次提交文件的不同</li><li>git log： 查看提交历史</li><li>git reflog： 查看命令历史，来确定要回到未来某个版本</li><li>git reset --hard commit_id: 回退到某个版本，commit_id可以通过git log或git reflog查看。回退之后也可以使用这个命令回到未来的版本。</li><li>git reset --hard HEAD^: 表示回退到上一个版本，一个<code>^</code>表示上一个.如果是<code>HEAD^^</code>则是上上个版本。用<code>HEAD~100</code>表示上一百个版本。</li><li>git checkout – file: 回退到上一次提交的版本（如果用了add就是在暂存区的内容，如果没用就是仓库中的内容）。file是文件名。</li><li>git rm： 将删除文件的命令提交到暂存区。当然如果在工作区删除了文件的话使用git add也是可以的。</li></ul><p>远程仓库：</p><ul><li>git remote add origin <a href="mailto:git@github.com">git@github.com</a>:xinhecuican/learngit.git: 其中xinhecuican是用户名，learngit是仓库名， origin是远程仓库名（在本地仓库中认为的），这个指令用来将远程仓库和本地仓库进行连接。</li><li>git push -u origin master: 将本地的master分支提交到远程仓库，第一次需要使用<code>-u</code>表示将本地master分支和远程master分支连接起来，之后就不需要<code>-u</code>了。</li><li>git remote rm + 名字： 删除远程仓库与本地的连接，可以通过<code>-v</code>查看当前的连接</li><li>git clone + 远程仓库名： 例如：<code>git clone git@github.com:xinhecuican/gitskills.git</code>，也可以直接输入url</li></ul><p>分支：</p><p>我们创建并切换到这个分支之后，之后的提交都是提交到这个分支上了（HEAD指针指向该分支，原分支有一个分支指针指向分支的最新提交）。如果要合并就是将原分支指针指向当前分支最新提交。</p><p>如果两个分支都有修改那么就无法合并，需要手动将一个分支的内容变成和另外一个相同才可以合并。</p><ul><li>git branch + 名字： 创建某一分支。</li><li>git checkout + 名字： 切换到某一分支</li><li>git checkout -b + 名字： 创建并切换</li><li>git branch: 查看当前分支</li><li>git switch -c + 分支名: 切换到某一分支</li><li>git switch master: 切换到主分支</li><li>git log --graph： 查看分支合并图</li><li>git merge -m “…” + 分支名： 将当前分支和分支名对应的分支合并，如果使用<code>--no-ff</code>参数表示删除分支后不要丢弃该分支信息</li><li>git pull: 将最新的提交抓取下来，因为如果是多人协作的话可能master分支已经有其他人先合并了，这时本地的master内容不是最新的，可能会产生冲突，因此先要pull下来合并后再提交</li><li>git branch --set-upstream-to=origin/dev dev： 将远程仓库dev分支与本地dev分支建立连接，如果没有建立可能无法git pull</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;ul&gt;
&lt;li&gt;git status： 查看当前工作区修改状态&lt;/li&gt;
&lt;li</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>逻辑门与CMOS晶体管</title>
    <link href="http://xinhecuican.github.io/post/6ee50502.html"/>
    <id>http://xinhecuican.github.io/post/6ee50502.html</id>
    <published>2021-03-05T23:37:00.000Z</published>
    <updated>2021-03-07T07:47:14.388Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="逻辑门"><a class="markdownIt-Anchor" href="#逻辑门"></a> 逻辑门</h1><p><img src="/images/%E9%80%BB%E8%BE%91%E9%97%A81.jpg" alt="" /></p><p><img src="/images/%E9%80%BB%E8%BE%91%E9%97%A82.jpg" alt="" /></p><p>除此之外还有XNOR（同或）， 三输入NOR门（NOR3）等。</p><h2 id="对电压的抽象"><a class="markdownIt-Anchor" href="#对电压的抽象"></a> 对电压的抽象</h2><p>我们要将某一范围内的电压表示0，而另一范围内的电压表示1.例如一个5v的范围，我们用3.6v - 5v表示逻辑1，而0v - 2.4v表示逻辑0中间一部分既不表示0又不表示1。</p><p>由于电压会随运输而波动损耗，因此输出端的电压要比输入端的电压更为苛刻。</p><p><img src="/images/%E9%80%BB%E8%BE%91%E9%97%A83.jpg" alt="" /></p><p>如图，左边就是输出端允许的电压范围，可以看见和右边都有一定差值，这个差值就是<strong>噪声容限</strong>。而右边输入端的电压经过调节，到了输出端电压范围又会变成左边那样。</p><p>这个调节实际上是晶体管本身的特性。<img src="/images/%E9%80%BB%E8%BE%91%E9%97%A84.jpg" alt="" /></p><p>如图是非门的输入输出电压变化，其中A是输入，Y是输出。可以看到在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>I</mi><mi>L</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{IL}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>附近电压有一个大的跳跃，因此输入电压在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>I</mi><mi>L</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{IL}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>I</mi><mi>H</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{IH}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>之间是不可以的。</p><p>因此使用了一系列标准对逻辑高和逻辑低的范围进行了限制。</p><table><thead><tr><th>逻辑系列</th><th><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>D</mi><mi>D</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{DD}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>I</mi><mi>L</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{IL}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>I</mi><mi>H</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{IH}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>O</mi><mi>L</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{OL}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>O</mi><mi>H</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{OH}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td>TTL(晶体管）</td><td>5（4.75 - 5.25）</td><td>0.8</td><td>2.0</td><td>0.4</td><td>2.4</td></tr><tr><td>COMS（互补性金属-氧化物）</td><td>5(4.5 - 6)</td><td>1.35</td><td>3.15</td><td>0.33</td><td>3.84</td></tr><tr><td>LVTTL(低电压)</td><td>3.3(3 - 3.6)</td><td>0.8</td><td>2.0</td><td>0.4</td><td>2.4</td></tr><tr><td>LVCMOS</td><td>3.3(3 - 3.6)</td><td>0.9</td><td>1.8</td><td>0.36</td><td>2.7</td></tr></tbody></table><h1 id="cmos晶体管"><a class="markdownIt-Anchor" href="#cmos晶体管"></a> CMOS晶体管</h1><h2 id="二极管"><a class="markdownIt-Anchor" href="#二极管"></a> 二极管</h2><p>MOS晶体管主要由硅组成，硅最外层有4个电子，相互之间形成4对共价键达成稳定结构。但是这样的话就不导电了，因此掺杂一些其他元素如砷、硼等。</p><p>如果掺入砷（5个电子）那么就会多出一个电子,叫<strong>n型掺杂物</strong>。 如果掺入硼（3个电子），那么就会少一个电子从而出现<strong>空穴</strong>， 叫<strong>p型掺杂物</strong>.</p><p>二极管就是一个n型区域和一个p型区域组合在一起形成的。<img src="/images/%E9%80%BB%E8%BE%91%E9%97%A85.jpg" alt="" /></p><p>如图， n型区域和p型区域中间的电子和空穴会结合，从而使n型区域的原子带正电，p型区域带负电，产生了一个电场，这个电场会抑制空穴向n区移动，电子向p区移动，最终达到平衡状态。</p><blockquote><p>空穴和电子结合的中间区域称作PN结</p></blockquote><p>如果我们在p型区域通正电，n型区域通负电，那么产生的电场和内电场反向相反，当外电场超过一定值时（内电场通常0.7v）就会将内电场抵消从而让粒子移动而导电。</p><p>如果在n型区域通正电，p型区域通负电，那么会使NP结扩大从而更加不导电。</p><p>由于扩散现象，因此p区内也会有少量电子，n区内会有少量空穴，这些少量粒子称为<strong>少子</strong>，而多的粒子称为<strong>多子</strong>。由于少子的存在因此即使时n型区域通正电也会有小的电流。</p><h2 id="nmos和pmos"><a class="markdownIt-Anchor" href="#nmos和pmos"></a> nMOS和pMOS</h2><p><img src="/images/%E9%80%BB%E8%BE%91%E9%97%A86.jpg" alt="" /></p><p>栅级就是我们控制的地方，它决定了源级和漏级是否有电流通过。（栅级下方还有一个电极）</p><p>nMOS下方电极开始通低电压，当栅级通低电压时，二者没有电势差此时np结阻挡电流通过。</p><p>当栅级通高电压时，SiO2的下方会有大量的电子，将p型半导体的空穴填满并且转换成n型半导体，也就是说此时n型半导体是连通的,电流可以通过。</p><p><img src="/images/%E9%80%BB%E8%BE%91%E9%97%A87.jpg" alt="" /></p><p>而pMOS下方开始是高电压，当上方低电压时连通，高电压时不能通过</p><h3 id="cmos非门"><a class="markdownIt-Anchor" href="#cmos非门"></a> CMOS非门</h3><p><img src="/images/%E9%80%BB%E8%BE%91%E9%97%A88.jpg" alt="非门" /></p><p>如图<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>d</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{dd}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是高电压, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{ss}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是低电压。</p><p>如果A是低电压，则pMOS连通，nMOS不连通，也就是高电压可以通过，结果为1.</p><p>如果A是高电压，下方连通，结果为0.</p><blockquote><p>如果上下方都有电流通过，则这个结果无效</p></blockquote><h3 id="与非门"><a class="markdownIt-Anchor" href="#与非门"></a> 与非门</h3><p><img src="/images/%E9%80%BB%E8%BE%91%E9%97%A89.jpg" alt="与非门" /></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mrow><mi>p</mi><mn>1</mn></mrow></msub><mi mathvariant="normal">、</mi><msub><mi>T</mi><mrow><mi>p</mi><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">T_{p1}、 T_{p2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">、</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>是pMOS， <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub><mi mathvariant="normal">、</mi><msub><mi>T</mi><mrow><mi>n</mi><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">T_{n1}、 T_{n2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">、</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是nMOS</p><p>只要AB输入不同时为1，那么下方就不会连通，只要AB有一个是0，那么上方就会连通，也就是说</p><table><thead><tr><th>A</th><th>B</th><th>输出</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>0</td></tr><tr><td>1</td><td>0</td><td>1</td></tr><tr><td>0</td><td>1</td><td>0</td></tr><tr><td>0</td><td>0</td><td>1</td></tr></tbody></table><p>与非门输出端加上一个非门就是与门。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;逻辑门&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>关系数据库模型</title>
    <link href="http://xinhecuican.github.io/post/bcc68732.html"/>
    <id>http://xinhecuican.github.io/post/bcc68732.html</id>
    <published>2021-03-04T12:00:00.000Z</published>
    <updated>2021-04-24T12:13:57.934Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="基础"><a class="markdownIt-Anchor" href="#基础"></a> 基础</h1><p>关系模型是人们为了描述关系而建立的一种二维表，这个二维表叫做关系。<br /><img src="/images/%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9E%8B1.jpg" alt="" /></p><p>关系模型中的一些术语：</p><ul><li>属性： 列名，例如图中title、year、length等</li><li>模式： 关系名和属性集合叫做这个关系的模式。例如<code>Movies(title, year, length, genre)</code>.模式中的属性其实是集合</li><li>元组： 除了首行外的其他行叫元组。每个元组中的各个分量都对应各个属性。</li><li>域： 其实也就是数据类型，如果上面的域分别是string、 Integer、 integer、 string。因此也可以加上域来描写模式<code>Movies(title: string, year: integer, length: integer, genre: string)</code></li><li>键： 键是区分该行和其他行的唯一标识。例如title和year构成了一个键。也就是说没有两部电影的制作年份和名字都相同（当然这种键并不好，可能会有冲突）。也可以只使用一列构成一个键，例如我们的身份证号。它的模式可以表示为： Movies(<u>title</u>, <u>year</u>, length, genre)</li></ul><h1 id="在sql中定义关系"><a class="markdownIt-Anchor" href="#在sql中定义关系"></a> 在SQL中定义关系</h1><p>SQL中有三种关系： 表、视图、临时表.<a href="https://xinhecuican.github.io/post/d213fc7f.html">MySQL使用</a></p><h1 id="代数查询语言"><a class="markdownIt-Anchor" href="#代数查询语言"></a> 代数查询语言</h1><h2 id="投影"><a class="markdownIt-Anchor" href="#投影"></a> 投影</h2><p>投影包含原有关系中的部分列（也就是一个子集），表示为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>π</mi><mrow><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>A</mi><mi>n</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi_{A_{1}A_{2}...A_{n}}(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight">.</span><span class="mord mtight">.</span><span class="mord mtight">.</span><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span></p><h2 id="选择"><a class="markdownIt-Anchor" href="#选择"></a> 选择</h2><p>选择就是按照一定条件对集合进行筛选，返回一个子集。符号位：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>σ</mi><mi>C</mi></msub><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma_{C}(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span>,其中C就是条件。</p><p>例如：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>σ</mi><mrow><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo>≥</mo><mn>100</mn></mrow></msub><mo stretchy="false">(</mo><mi>M</mi><mi>o</mi><mi>v</mi><mi>i</mi><mi>e</mi><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma_{length \ge 100}(Movies)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">h</span><span class="mrel mtight">≥</span><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">i</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span>,返回就只剩两行了。</p><h2 id="笛卡尔积"><a class="markdownIt-Anchor" href="#笛卡尔积"></a> 笛卡尔积</h2><p>笛卡尔积也就是A表和B表每一行相乘，例如: <img src="/images/%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9E%8B2.jpg" alt="" /></p><h2 id="自然联结"><a class="markdownIt-Anchor" href="#自然联结"></a> 自然联结</h2><p>自然联结就是将具有公共属性并且属性值相同的元组配对，符号表示为： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>⋈</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">R \Join S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68833em;vertical-align:-0.005em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⋈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span>。</p><p>例如： A和B中都有Name属性并且这两个表中的Name有相同内容，也就是A表中有张三B表中也有张三，对这两个表用Name进行连接的话结果就是name加上其他两个表所有的其他属性。</p><p>也可以用数学符号表达：</p><p>R(A, B)和S(B, C, D)， 两者交集为{B}，产生联结的点就是交集, 两者并集为{A, B, C, D}， 联结的结果就是并集.因此自然联结可以表示为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><mo stretchy="false">(</mo><msub><mi>l</mi><mi>A</mi></msub><mo separator="true">,</mo><msub><mi>l</mi><mi>B</mi></msub><mo separator="true">,</mo><msub><mi>l</mi><mi>C</mi></msub><mo separator="true">,</mo><msub><mi>l</mi><mi>D</mi></msub><mo stretchy="false">)</mo><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mo stretchy="false">(</mo><msub><mi>l</mi><mi>A</mi></msub><mo separator="true">,</mo><msub><mi>l</mi><mi>B</mi></msub><mo stretchy="false">)</mo><mo>⊆</mo><mi>R</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>l</mi><mi>B</mi></msub><mo separator="true">,</mo><msub><mi>l</mi><mi>C</mi></msub><mo separator="true">,</mo><msub><mi>l</mi><mi>D</mi></msub><mo stretchy="false">)</mo><mo>⊆</mo><mi>S</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex"> \{ ( l_A, l_B , l_C , l_D ) \, | \, (l_A , l_B ) \subseteq R , (l_B , l_C , l_D ) \subseteq S \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mclose">}</span></span></span></span></span></p><p>例如上面S表中B属性中的9，虽然在第二个表中满足第二个条件，但是不在第一个表中，因此不是联结元组中的一部分</p><h2 id="theta联结"><a class="markdownIt-Anchor" href="#theta联结"></a> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>联结</h2><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>联结构造过程为：</p><ol><li>先得到R 和 S的笛卡尔积</li><li>然后在笛卡尔积中找到符合条件C的元组</li></ol><p>符号为： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><msub><mo>⋈</mo><mi>C</mi></msub><mi>S</mi></mrow><annotation encoding="application/x-tex">R \Join_{C} S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel">⋈</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span></p><p>例如： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><msub><mo>⋈</mo><mrow><mi>A</mi><mo>&lt;</mo><mi>D</mi></mrow></msub><mi>S</mi></mrow><annotation encoding="application/x-tex">R \Join_{ A &lt; D} S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8607em;vertical-align:-0.17737em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel">⋈</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mrel mtight">&lt;</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.17737em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span>。这个因为都满足，所以结果就是笛卡尔积</p><h2 id="命名和重命名"><a class="markdownIt-Anchor" href="#命名和重命名"></a> 命名和重命名</h2><p>例如上图中两个都有B，当进行联结操作时为了区分不得不使用<code>关系名.属性名</code>的方式。这时可以将其中一个表属性名重命名，例如将第二个关系中的B重命名为X这样就可以简化书写。</p><h2 id="约束"><a class="markdownIt-Anchor" href="#约束"></a> 约束</h2><p>约束一般有两种表示方法。</p><ol><li>如果R是关系代数，那么<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>=</mo><mo>⊘</mo></mrow><annotation encoding="application/x-tex">R = \oslash</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">⊘</span></span></span></span>表示R的值必须为空<br />2。 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>⊆</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">R \subseteq S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span>,表示R中出现的元组都在S中出现了</li></ol><h3 id="引用完整性约束"><a class="markdownIt-Anchor" href="#引用完整性约束"></a> 引用完整性约束</h3><p>引用完整性约束表示在某个上下文（关系）中出现的值必须在另外一个相关的上下文中出现。</p><p>例如，在Movies中，所有演员信息单独列一个表，如果某一个演员的名字P在另一张表MovieStar（参演明星）中没有出现，那么就可以怀疑P是否是一个演员。</p><p>表示为： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>π</mi><mi>A</mi></msub><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>⊆</mo><msub><mi>π</mi><mi>B</mi></msub><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi_{A} (R) \subseteq \pi_{B} (S)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mclose">)</span></span></span></span>.或者等价的写为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>π</mi><mi>A</mi></msub><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>π</mi><mi>B</mi></msub><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><mo>=</mo><mo>⊘</mo></mrow><annotation encoding="application/x-tex">\pi_{A} (R) - \pi_{B} (S) = \oslash </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">⊘</span></span></span></span></span></p><h3 id="键约束"><a class="markdownIt-Anchor" href="#键约束"></a> 键约束</h3><p>键约束就是没有两个元组有相同的键。因此构造这种约束时可以从反向来看，没有键相同而其他值不同的。</p><p>例如name是键，也就是说name是唯一的，因此我们可以断言没有键name相同而address不同的。因此可以让自己对自己做笛卡尔积。选出两个name相同而address不同的，结果必定是空集。可以用数学语言表述为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>σ</mi><mrow><mo stretchy="false">(</mo><mi>M</mi><mi>S</mi><mn>1.</mn><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>=</mo><mi>M</mi><mi>S</mi><mn>2.</mn><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mtext> </mtext><mi>A</mi><mi>N</mi><mi>D</mi><mtext> </mtext><mi>M</mi><mi>S</mi><mn>1.</mn><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="false">!</mo><mo>=</mo><mi>M</mi><mi>S</mi><mn>2.</mn><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">(</mo><mi>M</mi><mi>S</mi><mn>1</mn><mo>×</mo><mi>M</mi><mi>S</mi><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mo>⊘</mo></mrow><annotation encoding="application/x-tex">\sigma_{(MS1.name = MS2.name \, AND \,  MS1.address != MS2.address)} (MS1 \times MS2) = \oslash</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mtight">1</span><span class="mord mtight">.</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">e</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mtight">2</span><span class="mord mtight">.</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">e</span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mtight">1</span><span class="mord mtight">.</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">s</span><span class="mclose mtight">!</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mtight">2</span><span class="mord mtight">.</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">s</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">⊘</span></span></span></span></span></p><h1 id="函数依赖"><a class="markdownIt-Anchor" href="#函数依赖"></a> 函数依赖</h1><p>函数依赖（FD）定义： 如果R的两个元组在属性 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>3</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>A</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A_{1} , A_{2}, A_{3}, ... A_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 上一致，那么他们在 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>3</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>B</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">B_{1} ,B_{2} ,B_{3} ,..., B_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 上也必定保持一致</p><p>如果关系R上的每个实例都能使一个FD为真，那么成R满足函数依赖f。</p><p><img src="/images/%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9E%8B3.jpg" alt="" /></p><p>如图： title year -&gt; length genre studioName是一个函数依赖。因为前面说过title和year结合起来是一个键，而title year相同可以唯一的确定一部电影，电影相同时长类型也就必定相同。</p><p>title year -&gt; starName不是一个函数依赖。因为同一部电影下有不同明星</p><p>可以看到即使是键也不能保证可以推出关系依赖。</p><h2 id="关系的键"><a class="markdownIt-Anchor" href="#关系的键"></a> 关系的键</h2><p>想成为关系的键要满足以下条件：</p><p>假设{A1, A2, …, An}是关系的键</p><ul><li>这些属性可以决定其他属性。也就是说不存在两个不同的元组有相同A1， A2…值</li><li>在{A1, … An}的真子集中，没有一个能决定R的其他属性，也就是说键必须是最小的</li></ul><p><strong>超键</strong></p><p>超键不需要满足键的第二个条件，也就是说它不一定是最小的。</p><h2 id="函数依赖推导"><a class="markdownIt-Anchor" href="#函数依赖推导"></a> 函数依赖推导</h2><p><strong>一些规则</strong></p><ul><li>分解结合规则：</li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mn>2</mn></msub><msub><mi>A</mi><mn>3</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>A</mi><mi>n</mi></msub><mo>−</mo><mo>&gt;</mo><msub><mi>B</mi><mn>1</mn></msub><msub><mi>B</mi><mn>2</mn></msub><msub><mi>B</mi><mn>3</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>B</mi><mi>n</mi></msub><mspace linebreak="newline"></mspace><mo>=</mo><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>A</mi><mi>n</mi></msub><mo>−</mo><mo>&gt;</mo><msub><mi>B</mi><mn>1</mn></msub><mo separator="true">,</mo><mspace width="1em"/><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mspace width="1em"/><mo separator="true">,</mo><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mn>2</mn></msub><msub><mi>A</mi><mn>3</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>A</mi><mi>n</mi></msub><mo>−</mo><mo>&gt;</mo><msub><mi>B</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A_{1}A_{2}A_{3}...A_{n} -&gt; B_{1}B_{2}B_{3}...B_{n}\\= A_{1}A_{2}..A_{n}-&gt;B_{1},\quad ... \quad ,A_{1}A_{2}A_{3}..A_{n}-&gt;B_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:1em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li>平凡依赖：</li></ul><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>B</mi><mi>m</mi></msub><mo stretchy="false">}</mo><mo>⊆</mo><mo stretchy="false">{</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{B_{1}, B_{2}..., B_{m}\} \subseteq \{A_{1}, A_{2}..., A_{n}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>。也就是说，平方函数右边是左边的子集。例如：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>i</mi><mi>t</mi><mi>l</mi><mi>e</mi><mspace width="1em"/><mi>y</mi><mi>e</mi><mi>a</mi><mi>r</mi><mo>−</mo><mo>&gt;</mo><mi>t</mi><mi>i</mi><mi>t</mi><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">title \quad year -&gt; title</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span></span></span></span></span></p><ul><li>传递规则：</li></ul><p>若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mn>2</mn></msub><msub><mi>A</mi><mn>3</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>A</mi><mi>n</mi></msub><mo>−</mo><mo>&gt;</mo><msub><mi>B</mi><mn>1</mn></msub><msub><mi>B</mi><mn>2</mn></msub><msub><mi>B</mi><mn>3</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>B</mi><mi>n</mi></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>1</mn></msub><msub><mi>B</mi><mn>2</mn></msub><msub><mi>B</mi><mn>3</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>B</mi><mi>n</mi></msub><mo>−</mo><mo>&gt;</mo><msub><mi>C</mi><mn>1</mn></msub><msub><mi>C</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>C</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">A_{1}A_{2}A_{3}...A_{n} -&gt; B_{1}B_{2}B_{3}...B_{n} , B_{1}B_{2}B_{3}...B_{n} -&gt; C_{1} C_{2} ... C_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>  成立，</p><p>则  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mn>2</mn></msub><msub><mi>A</mi><mn>3</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>A</mi><mi>n</mi></msub><mo>−</mo><mo>&gt;</mo><msub><mi>C</mi><mn>1</mn></msub><msub><mi>C</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>C</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">A_{1}A_{2}A_{3}...A_{n} -&gt; C_{1} C_{2} ... C_{k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>成立。</p><h3 id="闭包"><a class="markdownIt-Anchor" href="#闭包"></a> 闭包</h3><p>算法描述：</p><p>给出属性集合<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>3</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{A_{1},A_{2},A_{3}, ...,A_{n}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> FD(函数依赖）的集合S.它的一个子集的闭包为：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>3</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><msup><mo stretchy="false">}</mo><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">\{A_{1},A_{2},A_{3}, ...,A_{t}\}^{+}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.021331em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span></span></span></span></span></span></span></span></p><ol><li>分解FD中的依赖，使得依赖的右边只有一个属性</li><li>初始化闭包为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>3</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{A_{1},A_{2},A_{3}, ...,A_{t}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>,记作X</li><li>寻找这样的依赖， <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>C</mi><mi>m</mi></msub><mo>−</mo><mo>&gt;</mo><mi>H</mi><mo separator="true">,</mo><mi mathvariant="normal">其</mi><mi mathvariant="normal">中</mi><msub><mi>C</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>C</mi><mi>m</mi></msub><mo>∈</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">C_1 ,C_2, ..., C_m -&gt; H, 其中C_1 , C_2 ,..., C_m \in X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">其</span><span class="mord cjk_fallback">中</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>。然后把H加入到X中，重复查找依赖，直到所有符合条件的值都被加入到闭包中</li></ol><p>例如：</p><p>有五个属性A, B, C, D, E, F该关系包含以下FD： AB-&gt;C, BC-&gt;AD, D-&gt;E CF-&gt;B.求{A, B}的闭包</p><figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line"><span class="variable">AB</span><span class="operator">-&gt;</span><span class="built_in">C</span><span class="operator">,</span> <span class="variable">BC</span><span class="operator">-&gt;</span><span class="variable">A</span><span class="operator">,</span> <span class="variable">BC</span><span class="operator">-&gt;</span><span class="built_in">D</span><span class="operator">,</span> <span class="built_in">D</span><span class="operator">-&gt;</span><span class="built_in">E</span><span class="operator">,</span> <span class="variable">CF</span><span class="operator">-&gt;</span><span class="variable">B</span></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> <span class="variable">AB</span><span class="operator">-&gt;</span><span class="built_in">C</span><span class="operator">.</span> <span class="variable">AB</span>在闭包中，将<span class="built_in">C</span>加入闭包，现在闭包中的元素有<span class="punctuation">&#123;</span><span class="variable">A</span><span class="operator">,</span> <span class="variable">B</span><span class="operator">,</span> <span class="built_in">C</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="number">2.</span> <span class="variable">BC</span><span class="operator">-&gt;</span><span class="built_in">D</span><span class="operator">,</span> 将<span class="built_in">D</span>加入闭包</span><br><span class="line"><span class="number">3.</span> <span class="built_in">D</span><span class="operator">-&gt;</span><span class="built_in">E</span> 将<span class="built_in">E</span>加入闭包。结束</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span><span class="variable">A</span><span class="operator">,</span> <span class="variable">B</span><span class="punctuation">&#125;</span>的闭包为<span class="punctuation">&#123;</span><span class="variable">A</span><span class="operator">,</span> <span class="variable">B</span><span class="operator">,</span> <span class="built_in">C</span><span class="operator">,</span> <span class="built_in">D</span><span class="operator">,</span> <span class="built_in">E</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>通过计算闭包，我们可以知道某个关系是否可以由初始集合推断而来。例如给出一个FD：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub><mo>−</mo><mo>&gt;</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A_1 ,A_2 ,..., A_n -&gt; B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>，如果B在A集合的闭包里，那么就可以推断而来.</p><h3 id="基本集和投影"><a class="markdownIt-Anchor" href="#基本集和投影"></a> 基本集和投影</h3><blockquote><p>给定一个FD集合S，任何和S<strong>等价</strong>的集合都称为基本集</p></blockquote><p>等价也就代表可以通过上面这些定律推导得出S，他表示了S的简化形式。</p><p>最小基本集的定义：</p><ol><li>B中所有FD右边都是单一属性</li><li>从B中删去任何一个FD后， 该集合不再是基本集（因此可以排除平凡依赖，因为删去平凡依赖后没有变化）</li><li>对于B中任何一个FD，左边删去任意数量的属性后，B不再是基本集</li></ol><p>例：</p><p>属性A,B,C, 他们中任何一个元素都可以决定另外两个元素，则可以推断出A-&gt;B, A-&gt;C, B-&gt;A, B-&gt;C, C-&gt;A, C-&gt;B, AB-&gt;C, AC-&gt;B, BC-&gt;A.另外还有A-&gt;BC等</p><p>则最小化基本集为：{A-&gt;B, B-&gt;C, C-&gt;A}或{A-&gt;B, B-&gt;A, B-&gt;C, C-&gt;B}等</p><p><strong>投影</strong></p><p>假设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>=</mo><msub><mi>π</mi><mi>L</mi></msub><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R_1 = \pi_L (R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span>，则R1中有哪些FD成立？</p><p>计算过程</p><ol><li>设T为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>中成立的FD集合，初始化为空集</li><li>对于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>中的每一个子集X, 计算<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>X</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">X^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>（如果有n个元素，总共需要计算<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>X</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">X^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>, 也就是幂集的闭包）.然后将FD集合中对应FD添加入T</li><li>然后将所有FD进行合并为T并且变成最小化基本集<ol><li>如果T中的FD F可以从T中的其他FD推断而来，则删除F</li><li>如果 Y-&gt;B是T中的一个FD， 且Y至少有两个属性，从Y中删除一个属性并记为Z，如果Z-&gt;B可以从T中的FD推断而来，则用T-&gt;B代替Y-&gt;B</li><li>重复上述步骤直到不再变化</li></ol></li></ol><p>例：</p><p>设A, B, C, D中有FD： A-&gt;B, B-&gt;C,C-&gt;D.假设需要投影到A, C, D.</p><ol><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>A</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">{A}^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span> = {A, B, C, D}。则FD A-&gt;C和A-&gt;D成立,<strong>注意到A-&gt;B也成立，但是由于B不再投影集合中，所以没有意义，也就不用添加</strong></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>C</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">{C}^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span> = {C， D}。 C-&gt;D 可以添加</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>D</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">{D}^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span> = {D}，没有依赖可以添加</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mi>A</mi><mo separator="true">,</mo><mi>D</mi></mrow><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">{A, D}^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.039001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.844561em;"><span style="top:-3.1362300000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span> = {A, B, C, D}</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mi>A</mi><mo separator="true">,</mo><mi>C</mi></mrow><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">{A, C}^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.039001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.844561em;"><span style="top:-3.1362300000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span> = {A, B, C, D}</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mi>A</mi><mo separator="true">,</mo><mi>D</mi><mo separator="true">,</mo><mi>C</mi></mrow><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">{A, D, C}^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.039001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.844561em;"><span style="top:-3.1362300000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span> = {A, B, C, D}</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mi>D</mi><mo separator="true">,</mo><mi>C</mi></mrow><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">{D, C}^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.039001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.844561em;"><span style="top:-3.1362300000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span> = {C, D}.</li></ol><p>所以最后得到的FD集合为{A-&gt;C, A-&gt;D, C-&gt;D}</p><p>现在求最小化基本集。我们可以看到A-&gt;D可以由A-&gt;C, C-&gt;D推断而来，所以删除A-&gt;D</p><p>最小化基本集为{A-&gt;C, C-&gt;D}</p><h2 id="第一二三范式"><a class="markdownIt-Anchor" href="#第一二三范式"></a> 第一二三范式</h2><p><strong>第一范式</strong></p><p>第一范式强调列的原子性，也就是说每个列不能再划分成两列。</p><p>例如【联系人】（姓名，性别，电话），电话可能是家庭电话和工作电话，这时我们就需要把电话进行拆分</p><p><strong>第二范式</strong></p><p>第二范式首先是第一范式。其次还要满足一个表中必须要有<strong>一个主键</strong>，并且没有包含在主键中的列必须完全依赖于主键，而不能依赖于主键的一部分（部分依赖）。</p><p>例如：</p><p>表：学号、课程号、姓名、学分;</p><p>这个表明显说明了两个事务:学生信息, 课程信息;由于非主键字段必须依赖主键，这里学分依赖课程号，姓名依赖于学号，不是<strong>全部依赖于主键，而只依赖于主键的部分</strong>，所以不满足第二范式。</p><blockquote><p>如果主键只有一个属性，则必定满足完全依赖</p></blockquote><p>如果不满足第二范式，则很容易产生冗余。</p><p><strong>第三范式</strong></p><p>第三范式首先是第二范式，并且没有传递依赖，即<strong>非主属性不依赖于其他非主属性</strong>。</p><h2 id="bcnf范式"><a class="markdownIt-Anchor" href="#bcnf范式"></a> BCNF范式</h2><p>BCNF范式条件：<strong>如果R中非平凡的FD <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>A</mi><mi>n</mi></msub><mo>−</mo><mo>&gt;</mo><msub><mi>B</mi><mn>1</mn></msub><msub><mi>B</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>B</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">A_1 A_2 ... A_n -&gt; B_1 B_2 ... B_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>成立，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>A</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{A_1 ,A_2 ,.. A_n\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>是R的超键</strong></p><p>也就是说R中所有FD左边都必须是超键</p><p>如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>A</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{A_1 ,A_2 ,.. A_n\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>的闭包可以包含所有元素，则可以认为这是一个超键。</p><blockquote><p>任何二元关系都属于BCNF</p></blockquote><p>证明：</p><ol><li>没有非平凡FD</li><li>A-&gt;B成立，但B-&gt;A不成立。这种情况下，A是键</li><li>B-&gt;A成立，但A-&gt;B不成立，和第二种情况类似</li><li>A-&gt;B, B-&gt;A都成立，则A和B都是键。</li></ol><p><strong>BCNF分解算法</strong></p><p>过程：</p><ol><li>根据R函数依赖集S，检查R是否属于BCNF，属于则终止，不属于进行下一步</li><li>如果存在BCNF违例（即某个关系左边不是超键），设这个关系为X -&gt; Y,则计算<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>X</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">X^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>（X的闭包）。选择<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>=</mo><msup><mi>X</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">R_1 = X^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>为一个关系，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub><mo>=</mo><mi>X</mi><mi mathvariant="normal">和</mi><mi mathvariant="normal">不</mi><mi mathvariant="normal">在</mi><msup><mi>X</mi><mo>+</mo></msup><mi mathvariant="normal">中</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">元</mi><mi mathvariant="normal">素</mi></mrow><annotation encoding="application/x-tex">R_2 = X和不在X^+ 中的元素</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord cjk_fallback">和</span><span class="mord cjk_fallback">不</span><span class="mord cjk_fallback">在</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">元</span><span class="mord cjk_fallback">素</span></span></span></span>，这样就把R分解成了<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mi mathvariant="normal">和</mi><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_1 和 R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">和</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>计算<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mi mathvariant="normal">和</mi><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_1 和 R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">和</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>在R上的投影，分别记作<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub><mi mathvariant="normal">和</mi><msub><mi>S</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">S_1 和 S_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">和</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub><mi mathvariant="normal">和</mi><msub><mi>S</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">S_1 和 S_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">和</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>上继续使用上面的算法，直到所有都满足BCNF范式</li></ol><p>例：</p><p>R(A,B,C,D) FD{AB→C,C→D,D→A}</p><ol><li>AB的闭包包括所有元素，因此AB是超键，C-&gt;D和D-&gt;A都是BCNF违例</li><li>以C-&gt;D进行第二步。C的闭包为{C, D, A},因此得到{C, D, A}和{C, B}</li><li>{C, D, A}的FD集为{C-&gt;D, D-&gt;A}, {C, B}只有两个元素因此结束</li><li>{C, D, A}中C的闭包可以包括所有元素，因此C是超键，但是D不是，因此D-&gt;A违反BCNF</li><li>D的闭包为{A, D}，因此可以得到{A, D}, {C, D}，因为都是两个元素，结束</li></ol><h2 id="分解的优劣"><a class="markdownIt-Anchor" href="#分解的优劣"></a> 分解的优劣</h2><p>例如： 把R(A, B, C)分解成R1(A, B) 和 R2(B, C)，这种分解是否可以保证恢复到原始关系呢？</p><p>如果对于R中的两个实例a(1, 2, 3) 和 b(4, 2, 5)，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>π</mi><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow></msub><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><msub><mi>π</mi><mrow><mi>B</mi><mo separator="true">,</mo><mi>C</mi></mrow></msub><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi_{A, B}(b) \pi_{B,C}(a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">A</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span> = (4, 2) (2, 3)</p><p>之后对两个关系进行自然联结，结果为(4, 2, 3)，并不存在于原始关系中，也就是对于原始关系造成了损失。</p><p>但是如果B是<strong>主键</strong>，则为无损连接，因为B相同其他元素一定相同，这也就说明了BCNF范式可以通过自然联结无损回复到原始关系。</p><h3 id="无损连接的chase检验"><a class="markdownIt-Anchor" href="#无损连接的chase检验"></a> 无损连接的chase检验</h3><p><strong>问题</strong>： 假设将R分解成若干个关系，他们的属性集为S1, S2, S3… R上成立的FD集合为F. 能否通过这些分解关系的自然联结来恢复R？</p><p>一些性质</p><ul><li>自然连接满足结合律和交换律。</li><li>自然连接后的每个结果属于R，R也要属于自然连接后的结果。也就是说两个集合要相等</li></ul><p>大致过程：</p><ol><li>首先建立一个表格，表格的行数为分解出的关系的数目，列数为总的属性的个数。每一行代表一个分解的属性集</li><li>初始化表格。一行行的填写，将该行关系中属性用小写字母填进去，而其他关系用小写字母加数字填进去（待会看例子就清楚了）</li><li>按照R的FD进行推导。例如FD： X-&gt;Y，如果两列在X上相同，那么在Y上一定相同</li><li>一直推导下去，知道某一行都是不带下标的小写字母</li></ol><p>R(A, B, C, D) FD: A-&gt;B, B-&gt;C, CD-&gt;A。 分解为三个关系,属性集分别为{A, D}, {A, C}, {B, C, D}</p><p>初始化，如果属性集中有，那么直接添加不带下标的小写字母，否则添加带下标的。带下标也就表示这个是不确定的。</p><table><thead><tr><th>属性集</th><th>A</th><th>B</th><th>C</th><th>D</th></tr></thead><tbody><tr><td>{A, D}</td><td>a</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">b_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">c_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td>d</td></tr><tr><td>{A, C}</td><td>a</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">b_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td>c</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">d_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>{B, C, D}</td><td>a3</td><td>b</td><td>c</td><td>d</td></tr></tbody></table><p>推导：</p><p>首先由 A-&gt;B可以推得a相同，b一定相同，因此b的符号要相同</p><table><thead><tr><th>属性集</th><th>A</th><th>B</th><th>C</th><th>D</th></tr></thead><tbody><tr><td>{A, D}</td><td><strong>a</strong></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{b_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">c_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td>d</td></tr><tr><td>{A, C}</td><td><strong>a</strong></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{b_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></td><td>c</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">d_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>{B, C, D}</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">a_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td>b</td><td>c</td><td>d</td></tr></tbody></table><p>B-&gt;C</p><table><thead><tr><th>属性集</th><th>A</th><th>B</th><th>C</th><th>D</th></tr></thead><tbody><tr><td>{A, D}</td><td>a</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{b_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></td><td><strong>c</strong></td><td>d</td></tr><tr><td>{A, C}</td><td>a</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{b_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></td><td><strong>c</strong></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">d_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>{B, C, D}</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">a_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td>b</td><td>c</td><td>d</td></tr></tbody></table><p>CD-&gt;A</p><table><thead><tr><th>属性集</th><th>A</th><th>B</th><th>C</th><th>D</th></tr></thead><tbody><tr><td>{A, D}</td><td><strong>a</strong></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">B_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td><strong>c</strong></td><td><strong>d</strong></td></tr><tr><td>{A, C}</td><td>a</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">b_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td>c</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">d_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>{B, C, D}</td><td><strong>a</strong></td><td>b</td><td><strong>c</strong></td><td><strong>d</strong></td></tr></tbody></table><p>这时候我们可以看到第三行全部是小写字母了。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;基础&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; </summary>
      
    
    
    
    <category term="数据库" scheme="http://xinhecuican.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
  </entry>
  
  <entry>
    <title>javascript</title>
    <link href="http://xinhecuican.github.io/post/84ea90f7.html"/>
    <id>http://xinhecuican.github.io/post/84ea90f7.html</id>
    <published>2021-03-03T05:38:00.000Z</published>
    <updated>2021-04-10T13:11:34.883Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p><a href="https://www.liaoxuefeng.com/wiki/1022910821149312/1023023754768768">参考自</a></p><h1 id="对象及函数"><a class="markdownIt-Anchor" href="#对象及函数"></a> 对象及函数</h1><h2 id="对象"><a class="markdownIt-Anchor" href="#对象"></a> 对象</h2><h3 id="创建对象"><a class="markdownIt-Anchor" href="#创建对象"></a> 创建对象</h3><p>对象直接使用键值对的方式进行定义</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> xiaoming = &#123;</span><br><span class="line">    name: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    birth: <span class="number">1990</span>,</span><br><span class="line">    school: <span class="string">&#x27;No.1 Middle School&#x27;</span>,</span><br><span class="line">    height: <span class="number">1.70</span>,</span><br><span class="line">    weight: <span class="number">65</span>,</span><br><span class="line">    score: <span class="literal">null</span></span><br><span class="line">    age: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">        <span class="keyword">return</span> y - <span class="built_in">this</span>.birth;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="string">&#x27;middle-school&#x27;</span>: <span class="string">&#x27;No.1 Middle School&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line">xiaoming[<span class="string">&#x27;middle-school&#x27;</span>]; <span class="comment">// &#x27;No.1 Middle School&#x27;</span></span><br><span class="line">xiaoming.age();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果键时字符串的话必须使用[]的方式进行访问，例如middle-school</p><p>如果想判断某个属性是否在这个类中可以使用<code>in</code>。例如：<code>'name' in xiaoming</code>，返回为true。</p><p>但是这种方法对继承而来的属性也会判断为真。例如：<code>'toString' in xiaoming; // true</code>.这个时候就需要使用hasOwnProperty()方法。例如：<code>xiaoming.hasOwnProperty('name'); // true</code></p><p>另一种创建方法是：</p><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span><span class="params">(name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.hello = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        alert(<span class="string">&#x27;Hello, &#x27;</span> + <span class="keyword">this</span>.name + <span class="string">&#x27;!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> xiaoming = <span class="keyword">new</span> Student(<span class="string">&#x27;小明&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> xiaohong = <span class="keyword">new</span> Student(<span class="string">&#x27;小红&#x27;</span>);</span><br><span class="line">xiaoming.constructor === Student.prototype.constructor; </span><br></pre></td></tr></table></figure><p>这种方式的好处是可以重复创建<br /><img src="/images/javascript1.png" alt="" /><br />java对每个创建的对象都会设置一个原型，指向原型对象。原型对象有一个constructor属性指向函数，而函数有一个prototype指向原型。因此为了节省空间，可以把一些共用的函数或变量移动到原型变量上就可以了</p><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span><span class="params">(name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student.prototype.hello = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    alert(<span class="string">&#x27;Hello, &#x27;</span> + <span class="keyword">this</span>.name + <span class="string">&#x27;!&#x27;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这样所有对象本身都没有hello函数，但是他们可以调用这个函数。</p><p>当然有更简洁的方式</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">name</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">hello</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        alert(<span class="string">&#x27;Hello, &#x27;</span> + <span class="built_in">this</span>.name + <span class="string">&#x27;!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>class关键字自ES6被引入，并且可以在后面使用extends关键字继承某个类</p><h3 id="标准对象"><a class="markdownIt-Anchor" href="#标准对象"></a> 标准对象</h3><p>有一些对象js已经帮我们设定好了。</p><p><strong>Date()</strong></p><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">var now = <span class="keyword">new</span> <span class="constructor">Date()</span>;</span><br><span class="line">now; <span class="comment">// Wed Jun 24 2015 19:49:22 GMT+0800 (CST)</span></span><br><span class="line">now.get<span class="constructor">FullYear()</span>; <span class="comment">// 2015, 年份</span></span><br><span class="line">now.get<span class="constructor">Month()</span>; <span class="comment">// 5, 月份，注意月份范围是0~11，5表示六月</span></span><br><span class="line">now.get<span class="constructor">Date()</span>; <span class="comment">// 24, 表示24号</span></span><br><span class="line">now.get<span class="constructor">Day()</span>; <span class="comment">// 3, 表示星期三</span></span><br><span class="line">now.get<span class="constructor">Hours()</span>; <span class="comment">// 19, 24小时制</span></span><br><span class="line">now.get<span class="constructor">Minutes()</span>; <span class="comment">// 49, 分钟</span></span><br><span class="line">now.get<span class="constructor">Seconds()</span>; <span class="comment">// 22, 秒</span></span><br><span class="line">now.get<span class="constructor">Milliseconds()</span>; <span class="comment">// 875, 毫秒数</span></span><br><span class="line">now.get<span class="constructor">Time()</span>; <span class="comment">// 1435146562875, 以number形式表示的时间戳</span></span><br></pre></td></tr></table></figure><blockquote><p>Date中的月份是从0开始的，也就是说0表示1月份</p></blockquote><p><strong>RegExp</strong></p><p><a href="https://xinhecuican.github.io/post/26477.html#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F">一些基础知识</a></p><ul><li>\s: 表示空格</li><li>\d: 表示数字</li><li>\w: 表示一个字母或数字</li></ul><p>正则表达式创建：</p><ul><li>通过<code>/ ... /</code>: 如果在<code>/</code>后加g表示全局匹配，每次匹配完后会返回值，然后从上次匹配的位置往后匹配 例如： var re1 = /ABC-001/;</li><li>通过new RegExp(‘正则表达式’, 其他参数): 第二个参数可以是’g’表示全局匹配</li></ul><p>可以使用test(‘匹配字符串’)进行匹配</p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">var re = <span class="regexp">/^\d&#123;3&#125;\-\d&#123;3,8&#125;$/</span>;</span><br><span class="line">re.test(<span class="string">&#x27;010-12345&#x27;</span>); <span class="regexp">//</span> true</span><br><span class="line">re.test(<span class="string">&#x27;010-1234x&#x27;</span>); <span class="regexp">//</span> false</span><br><span class="line">re.test(<span class="string">&#x27;010 12345&#x27;</span>); <span class="regexp">//</span> false</span><br></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">var s = <span class="string">&#x27;JavaScript, VBScript, JScript and ECMAScript&#x27;</span>;</span><br><span class="line">var re=<span class="regexp">/[a-zA-Z]+Script/g</span>;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> 使用全局匹配:</span><br><span class="line">re.exec(s); <span class="regexp">//</span> [<span class="string">&#x27;JavaScript&#x27;</span>]</span><br><span class="line">re.lastIndex; <span class="regexp">//</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line">re.exec(s); <span class="regexp">//</span> [<span class="string">&#x27;VBScript&#x27;</span>]</span><br><span class="line">re.lastIndex; <span class="regexp">//</span> <span class="number">20</span></span><br><span class="line"></span><br><span class="line">re.exec(s); <span class="regexp">//</span> [<span class="string">&#x27;JScript&#x27;</span>]</span><br><span class="line">re.lastIndex; <span class="regexp">//</span> <span class="number">29</span></span><br><span class="line"></span><br><span class="line">re.exec(s); <span class="regexp">//</span> [<span class="string">&#x27;ECMAScript&#x27;</span>]</span><br><span class="line">re.lastIndex; <span class="regexp">//</span> <span class="number">44</span></span><br><span class="line"></span><br><span class="line">re.exec(s); <span class="regexp">//</span> null，直到结束仍没有匹配到</span><br></pre></td></tr></table></figure><p>应用：</p><blockquote><p>切分字符串</p></blockquote><p>例如：<br /><code>a b c'.split(/\s+/); // ['a', 'b', 'c']</code>。split的参数可以使用正则表达式</p><h3 id="浏览器对象"><a class="markdownIt-Anchor" href="#浏览器对象"></a> 浏览器对象</h3><p><strong>window</strong></p><p>window有innerHeight和innerWeight属性，用来获取内部的宽度和高度，也就是网页可以使用的大小。</p><p>还有outerHeight和outerWeight属性，指的是浏览器所使用的大小（浏览器还有一些工具栏会占用一定的空间）</p><p><strong>navigator</strong></p><p>一些浏览器的信息，但是这些信息可以被用户更改</p><ul><li>navigator.appName：浏览器名称；</li><li>navigator.appVersion：浏览器版本；</li><li>navigator.language：浏览器设置的语言；</li><li>navigator.platform：操作系统类型；</li><li>navigator.userAgent：浏览器设定的User-Agent字符串。</li></ul><p><strong>screen</strong></p><p>指的是屏幕的信息（这是计算机本身的信息）</p><ul><li>screen.weight:</li><li>screen.height:</li><li>screen.colorDepth: 返回颜色位数。如8位，16位，24位</li></ul><p><strong>location</strong></p><p>location表示当前页面的URL。例如<code>location.href</code></p><p>如果想获取各个部分的信息，可以使用</p><ul><li>location.protocol; // ‘http’</li><li>location.host; // ‘<a href="http://www.example.com">www.example.com</a>’</li><li>location.port; // ‘8080’</li><li>location.pathname; // ‘/path/index.html’</li><li>location.search; // ‘?a=1&amp;b=2’</li><li>location.hash; // ‘TOP’</li><li>location.reload(): 重新加载当前页面</li><li>location.assign(URL）： 加载一个新页面</li></ul><p><strong>document</strong></p><p>document表示当前<a href="https://zh.javascript.info/dom-nodes">DOM树</a>的根节点</p><ul><li>getElementById(): 根据Id获得节点</li><li>getElementByName(): 根据标签名获得节点</li><li>cookie: 当前页面的cookie。但是如果浏览器使用了httponly选项就无法获取</li><li>createElement(): 创建便签，如h1等</li><li>createTextNode(): 创建文本节点</li><li>node.appendChild(): 为这个节点添加子节点</li><li>element.insertBefore(new, ref): 将new节点插入到ref之前</li><li>element.innerHTML： 这个标签下所有内容</li><li>element.style: 返回这个元素的css</li><li>element.style.left</li><li>element.setAttribute()</li><li>element.getAttribute()</li><li>element.addEventListener()</li><li>element.value: 获得表单输入的值</li><li>element.check: 单选框或复选框是否被选上</li><li>element.submit(): 提交表单。但是这种方法会干扰本身的提交。另一种方式是在触发onsubmit时修改</li></ul><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- HTML --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;test-form&quot;</span> <span class="attr">onsubmit</span>=<span class="string">&quot;return checkForm()&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;test&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">checkForm</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> form = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test-form&#x27;</span>);</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 可以在此修改form的input...</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 继续下一步:</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>File</strong></p><p>在新版的js中，提供了File和FileReader来读取对象。</p><p>可以通过获取上传文件控件并通过<code>fileinput.files[0]</code>来获得文件对象，<a href="http://xn--file-zk1gh85mbz6b7sa.name">然后通过file.name</a>,file.size等可以获得文件的信息</p><p>FileReader可以用来读取文件。file_reader.readAsDataURL(file);用来读取文件。reader.onload = function(e) {…}将在文件读取完成之后自动调用</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span></span><br><span class="line">    fileInput = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test-image-file&#x27;</span>),</span><br><span class="line">    info = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test-file-info&#x27;</span>),</span><br><span class="line">    preview = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test-image-preview&#x27;</span>);</span><br><span class="line"><span class="comment">// 监听change事件:</span></span><br><span class="line">fileInput.addEventListener(<span class="string">&#x27;change&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 清除背景图片:</span></span><br><span class="line">    preview.style.backgroundImage = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">// 检查文件是否选择:</span></span><br><span class="line">    <span class="keyword">if</span> (!fileInput.value) &#123;</span><br><span class="line">        info.innerHTML = <span class="string">&#x27;没有选择文件&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 获取File引用:</span></span><br><span class="line">    <span class="keyword">var</span> file = fileInput.files[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">// 获取File信息:</span></span><br><span class="line">    info.innerHTML = <span class="string">&#x27;文件: &#x27;</span> + file.name + <span class="string">&#x27;&lt;br&gt;&#x27;</span> +</span><br><span class="line">                     <span class="string">&#x27;大小: &#x27;</span> + file.size + <span class="string">&#x27;&lt;br&gt;&#x27;</span> +</span><br><span class="line">                     <span class="string">&#x27;修改: &#x27;</span> + file.lastModifiedDate;</span><br><span class="line">    <span class="keyword">if</span> (file.type !== <span class="string">&#x27;image/jpeg&#x27;</span> &amp;&amp; file.type !== <span class="string">&#x27;image/png&#x27;</span> &amp;&amp; file.type !== <span class="string">&#x27;image/gif&#x27;</span>) &#123;</span><br><span class="line">        alert(<span class="string">&#x27;不是有效的图片文件!&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 读取文件:</span></span><br><span class="line">    <span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</span><br><span class="line">    reader.onload = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span></span><br><span class="line">            data = e.target.result; <span class="comment">// &#x27;data:image/jpeg;base64,/9j/4AAQSk...(base64编码)...&#x27;            </span></span><br><span class="line">        preview.style.backgroundImage = <span class="string">&#x27;url(&#x27;</span> + data + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 以DataURL的形式读取文件:</span></span><br><span class="line">    reader.readAsDataURL(file);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>AJAX</strong></p><p>如果没有js，那么浏览器一旦提交表单就会开始刷新页面，然后在新页面告诉是成功还是失败。浏览器运作的方式就是<strong>一个HTTP请求对应一个页面</strong></p><p>我们可以通过JS发送这个请求，然后用JS接收页面来决定是否更新，这样就可以在一个页面中不断的发送数据了。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">success</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> textarea = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test-ie-response-text&#x27;</span>);</span><br><span class="line">    textarea.value = text;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fail</span>(<span class="params">code</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> textarea = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test-ie-response-text&#x27;</span>);</span><br><span class="line">    textarea.value = <span class="string">&#x27;Error code: &#x27;</span> + code;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> request = <span class="keyword">new</span> ActiveXObject(<span class="string">&#x27;Microsoft.XMLHTTP&#x27;</span>); <span class="comment">// 新建Microsoft.XMLHTTP对象</span></span><br><span class="line"></span><br><span class="line">request.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 状态发生变化时，函数被回调</span></span><br><span class="line">    <span class="keyword">if</span> (request.readyState === <span class="number">4</span>) &#123; <span class="comment">// 成功完成</span></span><br><span class="line">        <span class="comment">// 判断响应结果:</span></span><br><span class="line">        <span class="keyword">if</span> (request.status === <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="comment">// 成功，通过responseText拿到响应的文本:</span></span><br><span class="line">            <span class="keyword">return</span> success(request.responseText);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 失败，根据响应码判断失败原因:</span></span><br><span class="line">            <span class="keyword">return</span> fail(request.status);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// HTTP请求还在继续...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发送请求:</span></span><br><span class="line">request.open(<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;/api/categories&#x27;</span>);</span><br><span class="line">request.send();</span><br><span class="line"></span><br><span class="line">alert(<span class="string">&#x27;请求已发送，请等待响应...&#x27;</span>);</span><br></pre></td></tr></table></figure><p>首先需要创建一个XMLHttpRequest对象，然后设置onreadystatechange的回调函数，返回4请求成功，200代表返回成功，否则是返回不成功。</p><ul><li>open(type, url): 第一个参数指明是GET还是POST，第二个参数指明请求的URL</li><li>send(FormData): 如果是GET则不需要参数，如果是POST则需要传递字符串或者是formdata</li></ul><p>但是url只能是本域的，也就是说域名要相同（甚至前面加了www也是不同的域名），请求的页面是相同的http协议（http或https），端口号也要相同。</p><p>那么怎么请求外域的页面呢？</p><ol><li>在相同域名下架设代理服务器进行转发</li><li>通过JSONP，但是他只能处理GET请求</li></ol><p>例如：</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://example.com/abc.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>然后返回值是一个函数调用，例如返回foo(‘data’)，这时我们只需要在本地准备好foo函数就会自动调用了。</p><h2 id="函数"><a class="markdownIt-Anchor" href="#函数"></a> 函数</h2><p>定义函数： <code>function function_name(var a, var b, ...)&#123; return ...;&#125;</code></p><p>这里和一般编程语言不同的是它没有定义返回值类型，因为js是弱类型语言，所有类型都使用var表示，所以就不需要特别写返回值了。</p><p>函数的参数实际上是不确定的，可以没有也可以由很多，例如上面如果少于两个参数就可以直接使用a，b来获得，如果多于两个则需要使用<code>argument[i]</code>进行调用。<code>argument.length</code>表示了参数的个数</p><h3 id="闭包"><a class="markdownIt-Anchor" href="#闭包"></a> 闭包</h3><p>这里的返回值可以是一个函数（类似于c++中的函数指针）,并且函数也可以没有名字（就是下面arr.reduce内的内容）。例如：</p><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lazy_sum</span><span class="params">(arr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sum = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> arr.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(x, y)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> x + y;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> f = lazy_sum(arr);</span><br><span class="line">f();</span><br></pre></td></tr></table></figure><p>但是仍有一些区别，这里的f不是立刻执行的，也就是说lazy_sum这个函数并没有真正结束，因此里面的参数也不会重置，例如：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">count</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> arr = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;=<span class="number">3</span>; i++) &#123;</span><br><span class="line">        arr.push(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> i * i;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> results = count();</span><br><span class="line"><span class="keyword">var</span> f1 = results[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">var</span> f2 = results[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">var</span> f3 = results[<span class="number">2</span>];</span><br><span class="line">f1();<span class="comment">//ans = 16</span></span><br><span class="line">f2(); <span class="comment">// ans = 16</span></span><br><span class="line">f3(); <span class="comment">// ans = 16</span></span><br></pre></td></tr></table></figure><h3 id="generator"><a class="markdownIt-Anchor" href="#generator"></a> generator</h3><p>例如：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">foo</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> x + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">yield</span> x + <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> x + <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">of</span> foo(<span class="number">0</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">&#125;</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure><p>yield用来表示返回，因此这个函数相当于返回了多次。注意这种函数还需要加一个<code>*</code>号。</p><p>最后可以不写return，系统会自动添加return undefined</p><h3 id="对象中的函数"><a class="markdownIt-Anchor" href="#对象中的函数"></a> 对象中的函数</h3><p>在对象中的函数要复杂一些。例如：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> xiaoming = &#123;</span><br><span class="line">    name: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    birth: <span class="number">1990</span>,</span><br><span class="line">    age: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">        <span class="keyword">return</span> y - <span class="built_in">this</span>.birth;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">xiaoming.age();</span><br></pre></td></tr></table></figure><p>这里有一个麻烦的变量this，this始终指向当前对象，但是问题是它的当前对象范围比较窄</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> xiaoming = &#123;</span><br><span class="line">    name: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    birth: <span class="number">1990</span>,</span><br><span class="line">    age: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">getAgeFromBirth</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">            <span class="keyword">return</span> y - <span class="built_in">this</span>.birth;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> getAgeFromBirth();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>上面这种方式就会出现问题，因为getAgeFromBirth的上一级是一个函数，因此this变成Undefined了。</p><p>一种解决方法是使用apply函数，apply函数可以指定使用的对象，例如：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getAge</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">    <span class="keyword">return</span> y - <span class="built_in">this</span>.birth;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> xiaoming = &#123;</span><br><span class="line">    name: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    birth: <span class="number">1990</span>,</span><br><span class="line">    age: getAge</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xiaoming.age(); <span class="comment">// 25</span></span><br><span class="line">getAge.apply(xiaoming, []); <span class="comment">// 25, this指向xiaoming, 参数为空</span></span><br></pre></td></tr></table></figure><ul><li>apply（对象，参数）： 第一个参数时对象名称，第二个参数时这个函数所使用的方法</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;p&gt;&lt;a href=&quot;https://www.liaoxuefeng.com/w</summary>
      
    
    
    
    <category term="js" scheme="http://xinhecuican.github.io/categories/js/"/>
    
    
  </entry>
  
  <entry>
    <title>无线网络与移动网络</title>
    <link href="http://xinhecuican.github.io/post/4f4fc0a1.html"/>
    <id>http://xinhecuican.github.io/post/4f4fc0a1.html</id>
    <published>2021-03-02T07:53:56.000Z</published>
    <updated>2021-03-06T00:43:59.166Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="基础名词"><a class="markdownIt-Anchor" href="#基础名词"></a> 基础名词</h1><ul><li>无线链路： 决定无线链路好坏的有两个特性： 覆盖区域和链路速率</li><li>基站： 基站负责向与之关联的无限主机发送数据和从主机那里接受数据。但是和交换机或路由器还有些不同，它只负责传输数据，其他诸如路由选择，地址分配，DNS名称转换服务都是主机自己沟通。</li></ul><p>无线网络和有线网络在信号上有着显著区别</p><ul><li>递减信号强度： 穿过物体信号减弱</li><li>其他源干扰： 同一个频段的信号会相互干扰。</li><li>多径传播： 电磁波受物体反射和地面反射，会使发送方和接收方之间形成了许多长度不等的路径，使接收方收到的信号模糊。</li></ul><p>**信噪比（SNR)**是收到的信号和噪声强度的比值，也就是说信噪比越高这个信号越可信。</p><p>**比特差错率（BER)**是接收方收到有错传输比特的概率。</p><p><strong>比特传输率</strong>： 也可以认为是传输速度</p><p><img src="/images/%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C1.png" alt="" /></p><p>对于一定信噪比来说，传输率越高，比特差错率越低。并且传输率越高,需要越高的信噪比才可以保证比特差错率，但是传输率越高越费电。</p><h1 id="wifi-80211"><a class="markdownIt-Anchor" href="#wifi-80211"></a> WIFI: 802.11</h1><p><img src="/images/%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C2.jpg" alt="" /></p><h2 id="体系结构"><a class="markdownIt-Anchor" href="#体系结构"></a> 体系结构</h2><p>该体系结构基本模块为<strong>基本服务集</strong>（BSS）。一个BSS中有一或多个无线站点和一个叫接入点（AP）的中央基站。中央基站类似于以太网，都有MAC地址。</p><h3 id="信道与关联"><a class="markdownIt-Anchor" href="#信道与关联"></a> 信道与关联</h3><p>每个无线站点要发送或接受数据之前都要和一个AP关联。</p><p>当管理员安装一个AP时，管理员会分配一个单字或双字的服务集标识符（SSID)，还要为这个AP分配一个信道号。</p><p>例如802.11运行在2.4 - 2.4835GHZ的频段中，然后802.11将这个频段划分成11个重叠的信道（一个区间）。只有在两个信道相隔4个信道及以上时才没有重叠，这意味着1、6、11是没有重叠的。</p><p>我们想要接入网，就要和一个AP相关联。关联后AP才会向你发送数据，你也只会向它发送数据。但是如果有多个AP要如何选择呢?</p><p>802.11要求每个AP周期性的发送<strong>信标帧</strong>，其中包含SSID和MAC地址。之后就可以从接收到的信标帧中进行选择。</p><p>一般来说会选择最高信号强度的信标帧，但是这也不是唯一的。有时候可能有许多主机同时使用这个AP，从而导致这个AP过载。</p><p>同时主机也可以主动进行广播，如果AP收到了会发送一个探测响应帧应答。</p><h2 id="mac协议"><a class="markdownIt-Anchor" href="#mac协议"></a> MAC协议</h2><p>WIFI的多路访问使用带碰撞避免的CSMA，但是和<a href="https://xinhecuican.github.io/post/bd608ff7.html#%E8%BD%BD%E6%B3%A2%E4%BE%A6%E5%90%AC%E5%A4%9A%E8%B7%AF%E8%AE%BF%E9%97%AEcsma">链路层的CSMA有很大区别</a></p><p>802.11发送数据到AP过程大致为：</p><ul><li>主机发送数据到AP，在AP通过CRC校验之后，过了一小段时间发送确认帧，如果主机在一定时间内没有收到确认帧他会重新发送。</li><li>在若干次重传失败之后，主机会放弃该帧。</li></ul><p>由于无线网络信号衰减问题严重，所以数据传输可能不及时，因此不使用传统的方法而是一次传输一个帧，大致过程为</p><ul><li>如果最开始检测信道空闲，将会在一个分布式帧间间隔（DIFS）的时间后发送该帧</li><li>如果不空闲，那么会选择一个随机回退值，在信道空闲时减去该值，直到减到0。减到0后就会发送</li><li>如果收到确认，结束。如果没有收到确认，则将DIFS扩大范围随机选择，重复上述过程。</li></ul><p>检测信道是否空闲的具体方式为发送一个<strong>请求发送控制帧</strong>（RTS），而AP会发送一个允许发送控制帧（CTS）进行响应，并且CTS会发给所有与他相连的站点</p><h3 id="80211帧"><a class="markdownIt-Anchor" href="#80211帧"></a> 802.11帧</h3><ul><li>有效载荷和CRC： 有效载荷就是里面的IP数据报</li><li>地址字段： 地址字段是和以太网帧有较大区别的地方，它包含四个地址，这里只关注前三个地址<ul><li>第一个地址是要接受该帧的无线站点的MAC地址</li><li>地址2是传输该帧的站点的MAC地址。如果是从站点到AP，那么地址2就是站点的MAC地址</li><li>地址3是关联这个子网的路由器的MAC地址</li></ul></li><li>序号、持续期和帧控制字段： 序号用来区分新传的帧和重传的帧，和运输层协议的序号类似。持续期包括传输数据的时间和传输确认的时间。控制字段有很多重要的如区分RTS、CTS、数据帧等的字段。</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;基础名词&quot;&gt;&lt;a class=&quot;markdownIt-Anchor</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>链路层</title>
    <link href="http://xinhecuican.github.io/post/bd608ff7.html"/>
    <id>http://xinhecuican.github.io/post/bd608ff7.html</id>
    <published>2021-02-22T08:18:00.000Z</published>
    <updated>2021-03-02T11:27:00.807Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="概念"><a class="markdownIt-Anchor" href="#概念"></a> 概念</h1><ul><li>节点： 运行链路层协议的设备，例如主机、路由器等</li><li>链路： 将信息传输到相邻节点的通信信道</li><li>链路层帧： 数据报封装在链路层帧中</li></ul><p>链路层提供的服务有：</p><ul><li>链路接入： 媒体访问控制（MAC）协议规定了帧在链路上的传输规则，还协调了多个节点共享当个链路时的问题。</li><li>可靠交付： 和TCP协议一样，这里的可靠交付也是通过差错检测和重发保证的。</li><li>差错检测</li></ul><p>链路层的主题是在网络适配器中实现的，也叫网络接口卡。</p><h1 id="差错检测技术"><a class="markdownIt-Anchor" href="#差错检测技术"></a> 差错检测技术</h1><h2 id="奇偶校验"><a class="markdownIt-Anchor" href="#奇偶校验"></a> 奇偶校验</h2><p>假设发送的信息中有d比特，那么发送方只需要附加上一个比特使得1的个数为偶数即可。接收方接收时检查是否有偶数个1那么就可以得知是否有差错。</p><p>但是这种检测方式检测出错的可能性很大，达到50%，因此需要一种更健壮的检测方式。</p><p>另一种方法时把这些比特划分成i行j列的矩阵，每一行每一列都有一个检验比特，这样不仅可以检测出错误还可以在出错时纠正他。</p><h2 id="检验和方法"><a class="markdownIt-Anchor" href="#检验和方法"></a> 检验和方法</h2><p><a href="https://xinhecuican.github.io/post/2cad8b04.html#%E6%8A%A5%E6%96%87%E6%AE%B5%E7%BB%93%E6%9E%84">在运输层中使用了这个技术</a></p><h2 id="循环冗余检测crc"><a class="markdownIt-Anchor" href="#循环冗余检测crc"></a> 循环冗余检测（CRC）</h2><p>该检测方法的基本思路为： 在d位比特后加上r位校验比特，使得他可以被G正好整除。公式为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mo>∗</mo><msup><mn>2</mn><mi>r</mi></msup><mi>X</mi><mi>O</mi><mi>R</mi><mi>R</mi><mo>=</mo><mi>n</mi><mi>G</mi><mspace linebreak="newline"></mspace><mi>D</mi><mo>∗</mo><msup><mn>2</mn><mi>r</mi></msup><mo>=</mo><mi>n</mi><mi>G</mi><mi>X</mi><mi>O</mi><mi>R</mi><mi>R</mi><mspace linebreak="newline"></mspace><mi>R</mi><mo>=</mo><mi>r</mi><mi>e</mi><mi>m</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>r</mi><mfrac><mrow><mi>D</mi><mo>∗</mo><msup><mn>2</mn><mi>r</mi></msup></mrow><mi>G</mi></mfrac></mrow><annotation encoding="application/x-tex">D *  2^r XOR R  = nG\\D * 2^r = nG XOR R\\R = remainder \frac{D * 2^r}{G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">G</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">G</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其中第二个式子告诉我们如果使用G / (D * 2^r)，余数正好是R（remainder就是余数的意思）,另外这里的除法没有进位借位，遵循异或规则</p><p>例：</p><figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">D = <span class="number">101110</span></span><br><span class="line">G = <span class="number">1001</span></span><br><span class="line">r = <span class="number">3</span></span><br><span class="line">      <span class="number">101011</span></span><br><span class="line"><span class="number">1001</span><span class="comment">----------</span></span><br><span class="line">   <span class="number">101110000</span></span><br><span class="line">   <span class="number">1001</span></span><br><span class="line">   <span class="comment">----------</span></span><br><span class="line">    <span class="number">1010</span></span><br><span class="line">    <span class="number">1001</span></span><br><span class="line">    <span class="comment">---------</span></span><br><span class="line">    <span class="number">001100</span>(注意是异或操作）</span><br><span class="line">    <span class="number">001001</span></span><br><span class="line">    <span class="comment">---------------</span></span><br><span class="line">    <span class="number">0001010</span></span><br><span class="line">    <span class="number">0001001</span></span><br><span class="line">    <span class="comment">---------</span></span><br><span class="line">       <span class="number">011</span></span><br><span class="line">结果为<span class="number">011</span></span><br></pre></td></tr></table></figure><h1 id="多路访问链路和协议"><a class="markdownIt-Anchor" href="#多路访问链路和协议"></a> 多路访问链路和协议</h1><p>如何协调多个发送和接收节点对共享广播信道的访问，就是多路访问问题。因为所有节点都可以传输帧，因此可能会出现由节点同时接收到多个帧，也称为碰撞。发生碰撞时，，所有的帧都会混杂在一起，也就是说没有一个帧是有效的。</p><h2 id="信道划分协议"><a class="markdownIt-Anchor" href="#信道划分协议"></a> 信道划分协议</h2><p>一种划分方式是时分多路复用（TDM）。他将时间划分成多个时间帧，然后在时间帧中划分N个时隙，每个时隙给一个节点使用。但是如果同时传输的节点少的话会造成巨大的资源浪费。</p><p>另一种方式是频分多路复用（FDM），他将R bps的信道划分成多段，并且把每一段分给一个节点。</p><p>第三种方式是码分多址（CDMA）。CDMA对每个节点分配一种不同的编码，然后每个节点使用这种编码方式对数据进行编码，这样的话就可以使得信息同时传输而不混淆。</p><h2 id="随机接入协议"><a class="markdownIt-Anchor" href="#随机接入协议"></a> 随机接入协议</h2><h3 id="时隙aloha"><a class="markdownIt-Anchor" href="#时隙aloha"></a> 时隙ALOHA</h3><p>首先进行下列假设：</p><ul><li>所有帧由L比特组成</li><li>时间被划分成L/R秒时隙（一个时隙就是传输一帧的时间）</li><li>节点只在时隙起点传输帧</li><li>节点是同步的，每个节点都知道时隙何时开始</li><li>如果一个时隙中有碰撞，那么在时隙结束前所有节点都可以检测到该事件</li></ul><p>p是一个频率，在每个节点中，时隙ALOHA的操作为：</p><ul><li>当节点有一个新帧要发送时，它等到下一个时隙开始传输</li><li>如果没有碰撞，该节点成功传输，则无需重传</li><li>如果有碰撞，那么该节点在时隙结束前检测到该碰撞。该节点以概率p在后续的每个时隙中重传帧</li></ul><p>假设每个节点都在试图以p概率传输一帧，那么该帧成功传输的概率为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><msup><mo stretchy="false">)</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">p * (1-p)^{N-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，求极限得最大效率为0.37。也就是说一个100Mbps速率的系统成功吞吐量为37Mbps</p><h3 id="aloha"><a class="markdownIt-Anchor" href="#aloha"></a> ALOHA</h3><p>它没有时隙，每次直接传输，如果发生碰撞立刻以概率p重新发送，之后每隔一帧判断一次。</p><p>它的最大效率为时隙ALOHA的一半。</p><h3 id="载波侦听多路访问csma"><a class="markdownIt-Anchor" href="#载波侦听多路访问csma"></a> 载波侦听多路访问（CSMA）</h3><p><strong>具有碰撞检测的CSMA</strong></p><p>这种方法在检测到碰撞时会立刻停止传输，但是这时已经上传的数据都是损坏的。大致过程为</p><ol><li>适配器从网络层获得数据报，准备链路层帧，并放入到帧适配器缓存中</li><li>如果信道空闲则传输</li><li>如果传输过程中发现该信到有其他适配器传输，则停止传输</li><li>终止传输后，等待一个随机时间年，返回步骤2</li></ol><p>这里要求随机时间量是因为多个适配器会在接近时间发现碰撞，如果等待相同时间同时传输则又会发生碰撞。</p><p>随机选择的时间在[0, 1, 2, …, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{n} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.747722em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>]范围内</p><p>它的效率为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mn>5</mn><msub><mi>d</mi><mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi></mrow></msub><mi mathvariant="normal">/</mi><msub><mi>d</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{1 + 5d_{prop} / d_{trans}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3874279999999999em;vertical-align:-0.5423199999999999em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight">5</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285716em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5423199999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{prop}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>表示信号在适配器传播所需最大时间，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d_{trans}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示传输一个最大长度的以太网帧的时间</p><h3 id="轮流协议"><a class="markdownIt-Anchor" href="#轮流协议"></a> 轮流协议</h3><p>轮流就是每个节点轮流来，他和前面的时隙ALOHA不同的是这里轮流的基础是帧而不是一定的时间。</p><p>一种实现方法为让一个节点作为主节点，有他向其他节点发送报文来告诉他可以传输几个帧，传输完成之后主节点又进行调度。</p><p>另一种是用一个称为令牌的特殊帧在节点之间以某种固定次序传递。</p><h1 id="交换局域网"><a class="markdownIt-Anchor" href="#交换局域网"></a> 交换局域网</h1><p>在链路层，帧不通过网络层地址进行传输和识别，他有自己的一套寻址方法</p><p><img src="/images/%E9%93%BE%E8%B7%AF%E5%B1%821.jpg" alt="" /></p><p>如图，方形式链路层交换机，而圆形是路由器。而通过链路层交换机就完成了一个微型的网络。</p><h2 id="链路层寻址"><a class="markdownIt-Anchor" href="#链路层寻址"></a> 链路层寻址</h2><h3 id="mac地址"><a class="markdownIt-Anchor" href="#mac地址"></a> MAC地址</h3><p>实际上不是主机或路由器有链路层地址，而是适配器（网络接口）有链路层地址，也就是说一个主机上可能有多个链路层地址。注意链路层交换机上并没有链路层地址，交换机自行发送而不需要主机或者路由器明确到哪个交换机。</p><p>MAC地址具有两个字节，通常是以16进制进行描述。例如: 1A-23-F9-CD-06-9B。他和IP的一点区别是MAC地址不可改变（虽然现在通过某些软件也可以改变）。</p><p>MAC地址没有相同的，因为IEEE在进行管理，一般是IEEE控制前24个比特，后24个比特由购买商自己决定。</p><h3 id="地址解析协议"><a class="markdownIt-Anchor" href="#地址解析协议"></a> 地址解析协议</h3><p>我们可以获得目的IP是因为DNS解析，但是我们怎么获得目的适配器（主机）的MAC地址呢？这就需要ARP了。</p><p>ARP可以将IP地址转换成MAC地址。他和DNS作用类似但是又有不同。DNS可以在全球范围内解析但是ARP只能解析同一个局域网中的地址。</p><p>ARP是通过ARP表进行工作的，ARP表包含IP地址、MAC地址、TTL三部分，例如：</p><p>| IP地址 | MAC地址 | TTL<br />|-|-|<br />| 222.222.222.221 | 88-B2-2F-54-1A-0F | 13:45:00 |<br />| 222.222.222.223 | 5C-66-AB-90-75-B1 | 13:52:00 |</p><p>这个表并不包含所有MAC地址。并且它的过期时间一般也不长（20分钟），想要通过这个表找到目标MAC地址，就需要发送一个特殊的<strong>ARP分组</strong>。ARP分组包括发送和接收的IP和MAC地址。</p><ul><li>如果ARP表中有对应IP，则直接返回MAC地址</li><li>向适配器发送一个ARP分组，并且适配器通过MAC广播地址发送分组。</li><li>接收到ARP分组的模块都检查自己的IP地址。如果匹配就发送响应分组。与此同时将发送方的IP和MAC记录到ARP分组中</li></ul><h2 id="以太网"><a class="markdownIt-Anchor" href="#以太网"></a> 以太网</h2><p>以太网是一种有限局域网</p><h3 id="结构"><a class="markdownIt-Anchor" href="#结构"></a> 结构</h3><p>发送适配器将以太网帧发送到物理层，然后接收适配器从物理层中接收到帧并且提取出IP数据报将其传递到网络层。</p><p>以太网帧分为六个字段，分别是：</p><ul><li>数据字段（46 - 1500字节）： 这个字段承载IP数据报</li><li>目的地址： 目的地址是MAC地址</li><li>源地址：</li><li>类型字段（2字节）： 类型字段允许以太网复用不同的网络层协议。</li><li>CRC（循环冗余检测， 4字节）： 检测帧是否有差错</li><li>前同步码（8字节）： 前同步码的前7个字节都是10101010， 最后一个字节是10101011. 它的作用是唤醒接收适配器，并且将它的时钟和发送方时钟同步</li></ul><h3 id="链路层交换机"><a class="markdownIt-Anchor" href="#链路层交换机"></a> 链路层交换机</h3><p>链路层交换机进行过滤和转发。过滤指的是拒绝某些帧，转发指的是发送到某个输出接口。他们都依赖<strong>交换机表</strong>，例如</p><table><thead><tr><th>地址</th><th>接口</th><th>时间</th></tr></thead><tbody><tr><td>62-FE-F7-11-89-A3</td><td>1</td><td>9:32</td></tr><tr><td>7C-BA-B2-B4-91-10</td><td>3</td><td>9:36</td></tr></tbody></table><p>交换机表和ARP表类似，都不包含所有的表项。当一个帧传输到交换机时，有几种可能。</p><p>首先假设从x接口进入</p><ol><li>如果表中没有对应地址，则向除x外的接口发送该帧的副本</li><li>如果表中有地址并且接口不是x，则发送到对应接口</li><li>如果表中有地址并且接口是x，则直接丢弃。（因为这表明它已经在这个接口内广播过了）</li></ol><p>交换机表具有<strong>自学习</strong>功能，它可以自动更新表项。每次有入帧就将发出地址和接口记录。并且在一段时间后会抛弃表项。</p><h2 id="虚拟局域网"><a class="markdownIt-Anchor" href="#虚拟局域网"></a> 虚拟局域网</h2><p>局域网一般都是一块一块的，每个部分都有自己的交换机，并且交换机之间互联。但是这种构建方式有一些缺点。</p><ul><li>缺乏流量隔离： 限制流量的作用，一是限制广播的流量来改善局域网的性能，二是有利于安全保护</li><li>交换机的无效使用： 例如有很多个小组，每个小组都只有很少的人，如果每个小组都需要一台交换机的话就会带来流量的浪费，但是如果只用一台交换机就无法流量隔离。</li><li>管理用户： 用户的位置发生改变就需要改变物理布线。</li></ul><p>为了解决这些难题，提出了<strong>虚拟局域网（VLAN）</strong>。虚拟局域网可以在一个物理设备中定义多个虚拟局域网。一种方法时交换机端口由管理员进行分组，每一组可以看成一个虚拟局域网，广播时也只会从这个虚拟局域网中发出而不是直接发送到所有端口。</p><p>具体可以在交换机中维护一张端口到VLAN的映射表，交换机仅在相同VLAN的端口之间交付帧。</p><p>但是如何把一个VLAN中的数据传输到另外的VLAN？一种方式是将VLAN交换机的一个端口和外部路由器相连，这样经由路由器就可以实现VLAN的数据传输了（有时在交换机内部就有一个路由器）。</p><p>一种扩展性较好的交换机互联方式为<strong>VLAN干线链接</strong>。也就是交换机上有一个端口和其他交换机链接，所有的VLAN共享这个端口，可以通过这个端口传递数据到其他交换机上。这时为了识别不同的VLAN，需要在以太网帧首部加上四字节的VLAN标签。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;概念&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; </summary>
      
    
    
    
    <category term="网络" scheme="http://xinhecuican.github.io/categories/%E7%BD%91%E7%BB%9C/"/>
    
    
  </entry>
  
  <entry>
    <title>网络层</title>
    <link href="http://xinhecuican.github.io/post/769365ef.html"/>
    <id>http://xinhecuican.github.io/post/769365ef.html</id>
    <published>2021-02-13T11:41:00.000Z</published>
    <updated>2021-02-21T11:27:02.041Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="基础概念"><a class="markdownIt-Anchor" href="#基础概念"></a> 基础概念</h1><p>在应用层和运输层已经将数据封装号了，网络层所做的工作就是把数据尽可能传输过去，其中的难点在于选择传输的路径。有些传输算法可能导致需要经过4个路由器，而有的只需要两个。</p><ul><li>转发： 从输入接口转移到输出接口，是路由器内部过程。路由器本身有许多个接口，可能要从一个接口输入再从另一个接口输出。</li><li>路由选择： 选择从源到目的地的路径。</li></ul><p>路由器中的一个关键元素就是<strong>转发表</strong>，它决定了这个路由器可以传输到哪些路由器，</p><h1 id="路由器工作原理"><a class="markdownIt-Anchor" href="#路由器工作原理"></a> 路由器工作原理</h1><p>路由器的组件有：</p><ul><li>输入端口： 输入端口负责接收数据和查找。查找指的是通过转发表找到输出端口。这里的端口并不是逻辑端口（如计算机上的端口）而是交换机上实实在在的端口。</li><li>交换结构： 将输入端口连接到输出端口</li><li>输出端口：</li><li>路由选择处理器： 它是操作转发表的结构。它通过路由选择协议来改变维护转发表</li></ul><h2 id="输入端口处理"><a class="markdownIt-Anchor" href="#输入端口处理"></a> 输入端口处理</h2><p>例如：</p><table><thead><tr><th>目的地址范围</th><th>链路接口</th></tr></thead><tbody><tr><td>0xC8171000 - 0xC81717FF</td><td>0</td></tr><tr><td>0xC8171800 - 0xC81718FF</td><td>1</td></tr><tr><td>0xC8171900 - 0xC8171FFF</td><td>2</td></tr><tr><td>其他</td><td>3</td></tr></tbody></table><p>可以看到他们的范围中前缀都是一样的，因此我们可以使用前缀来表示范围</p><table><thead><tr><th>前缀</th><th>接口</th></tr></thead><tbody><tr><td>1100 1000 0001 0111 0001 0</td><td>0</td></tr><tr><td>1100 1000 0001 0111 0001 1000</td><td>1</td></tr><tr><td>1100 1000 0001 0111 0001 1</td><td>2</td></tr><tr><td>其他</td><td>3</td></tr></tbody></table><p>从最高位向最低位匹配，寻找最长的匹配项。这种比较是在硬件中实现的，速度在纳秒级别。</p><h2 id="交换"><a class="markdownIt-Anchor" href="#交换"></a> 交换</h2><p>交换就是从输入端口到输出端口的过程，交换也有多种实现方式。</p><p><img src="/images/%E7%BD%91%E7%BB%9C%E5%B1%821.jpg" alt="" /></p><ul><li>经内存交换： 经内存交换是在路由选择处理器的直接控制之下完成的。处理器决定输出端口并且将数据输送到输出窗口的缓存中</li><li>经总线交换： 输入端口通过一条共用的总线传递，这条总线连接所有的输出端口。然后在输入端口处贴上一个标签然后在总线处决定具体要传输到哪条总线，在输出端口消除标签</li><li>经互联网络交换： 如图2，这种模式可以并行的转发多个分组，但是输出总线一次只能运输一条数据，因此如果有多个数据到了同一个输出端口还需要等待。</li></ul><h2 id="排队"><a class="markdownIt-Anchor" href="#排队"></a> 排队</h2><p><strong>输入排队</strong></p><p>如果交换速率不够快，例如输入速率为v，交换速率为1.5v,有两个输入口进入同一个输出端口，那么两个输入口接收完毕之后还必须等N / 3v时间。而如果交换速率&gt;=2v,那么就可以边输入边转移，当输入完毕时全部转移到输出接口（理想情况）</p><p><strong>输出排队</strong></p><p>当有许多个输入分组到达同一个输出端口时就会导致数据的积累，输出端口中有一个缓存，但是如果持续的输入到这个缓存中便会使缓存满，缓存满要么丢弃已有分组，要么拒绝新接收的分组，都会导致丢包。</p><p>现在一般都有丢弃不重要分组的机制，但是具体丢弃哪些分组就涉及到了<strong>分组调度</strong></p><h2 id="分组调度"><a class="markdownIt-Anchor" href="#分组调度"></a> 分组调度</h2><p><strong>先进先出</strong></p><p><strong>优先权排队</strong></p><p>优先权高的在前面，同一优先权先来先服务。有时每个优先权都有自己的队列。</p><p><strong>循环和加权公平排队</strong></p><p>同样有多个队列，输入到同一队列中的归为一队。最简单的方式就是先服务第一队，再服务第二队，这样依次循环下去。</p><p>其次还可以为每一类赋一个加权值w，然后每个类的服务时间是 w / w总</p><h1 id="ipv4"><a class="markdownIt-Anchor" href="#ipv4"></a> IPv4</h1><h2 id="数据报格式"><a class="markdownIt-Anchor" href="#数据报格式"></a> 数据报格式</h2><p><img src="/images/%E7%BD%91%E7%BB%9C%E5%B1%822.png" alt="" /></p><ul><li>版本： 指的是IPv4协议的版本</li><li>首部长度： 因为有可变长度的选项，所以要表明首部长度</li><li>服务类型： 讲一些需要低时延、高吞吐量的数据报和可靠性的数据报分开来</li><li>数据包长度： 总长度</li><li>标识、标志、位偏移： 和IP分片有关</li><li>寿命（TTL）： 确保数据包不会永远由于路由选择环路在网络中循环。每当一台路由器处理数据报时，TTL-1</li><li>协议： 只有到目的地才会使用。指示了要交给哪个运输层协议。例如6代表要交给TCP，17则要交个UDP</li><li>首部检验和： 计算过程为： 每两个字节当成一个数，然后求和再取反码。</li></ul><h2 id="数据报分片"><a class="markdownIt-Anchor" href="#数据报分片"></a> 数据报分片</h2><p>由于在链路层所能一次输送的数据量不一致并且可能小于数据报，因此可能会出现把一个数据报拆分成若干个小数据报然后合并的事件。这个时候就要使用标识位来标识这是第节个小数据报，每发送一个就让他加一。标志位是为了区分最后一个小数据报的，最后一个小数据报标志位是0，其他都是1，这样一旦检测到0就可以立刻合并。</p><h2 id="编址"><a class="markdownIt-Anchor" href="#编址"></a> 编址</h2><p>我们将主机和物理链路之间的边界叫接口，通常主机只有一个接口，而交换机有多个接口。</p><p><img src="/images/%E7%BD%91%E7%BB%9C%E5%B1%823.jpg" alt="" /></p><p>如图一个路由器连接着一些主机，可以看到有些主机前缀相同。</p><p>例如： 223.1.1.1 和 223.1.1.2 和 223.1.1.3 和 223.1.1.4前面24位都相同。可以把这些前缀相同的主机看成一个小的网络，而这些网络之间通过交换机进行连接。</p><p>我们可以把前缀相同的记成223.1.1.0/24，其中/24可以称为<strong>子网掩码</strong>，他表示这条线路之后的前24位都相同。</p><p>一般来讲每一个ISP或组织机构都会分配一个掩码，然后从本地ISP接入网时都会分配一个掩码下的IP地址，然后本地ISP在一个更大掩码的交换机下。但是组织不是固定不变的，并且更换IP所需工作量巨大， 如果它跑到另一个地区并且在那里接入网络这时就会出现查无此机的现象（因为数据一定会分发到原来的ISP下）</p><p>考虑这样的情况223.1.1.1跑到了223.1.3.1的地盘，而数据还是从223.1.1.0/24接口转发。</p><p>为了解决这个问题，在接入新的网络时上层交换及还要接受和新转入主机有关的数据并且采用最长前缀匹配。也就是说223.1.3.0/24还需要接收223.1.1.1的数据</p><p><strong>动态主机配置协议</strong></p><p>现在用户是经常移动的，每移动到新地区就需要拥有对应的掩码，不然就无法联网。为了处理移动用户，便专门使用<strong>动态主机配置协议（DHCP）</strong></p><p>DHCP是在某个ISP或接口处连接一个DHCP服务器，或者至少给出处理该接口的DHCP服务器IP地址。通过DHCP服务器，我们可以动态的分配IP。</p><p>连接过程：</p><ul><li>DHCP服务器发现： 一台新到达的主机首先要发现负责的DHCP服务器，这可以使用DHCP发现报文。用户使用UDP向67端口发送发现报文。并且它的目的地址是255.255.255.255（广播目的地址）并且本地IP设定为0.0.0.0.</li><li>DHCP服务器提供： 当DHCP服务器收到DHCP发现报文时，会发一个返回报文，这个报文的目的地址也是255.255.255.255（发现报文没告诉源地址，也没有源地址），如果有几台响应，那么就根据向客户推荐IP数量，IP地址有效时间等因素挑最好的。</li><li>DHCP请求：</li><li>DHCP ACK：</li></ul><p><strong>网络地址转换</strong></p><p>在一些小家庭中的网络可能编址一模一样（因为之间开始并没有联系也没有连接到互联网），但是 如果小家庭中的网络连接到互联网时怎么办呢？如果不进行地址转换，可能会导致成千上万个重复地址。这时就需要NAT进行转换了。</p><p>NAT路由器甚至不像路由器，所有进入家庭网络的报文首先都需要经过它，所有从家庭网络发出的报文首先要经过NAT的转换。它相当于是家庭网络和外界的接口。</p><p>所有从家庭网络发出的报文首先要经过NAT，NAT会把端口号改成自己空闲的端口号并且把IP地址改成自己的IP地址（因为家庭网络中的IP对外界而言是无效的，而NAT路由器使用的是DHCP分配的IP）。并且有一张<strong>NAT转换表</strong>记录了内网的IP和端口号。</p><p>响应报文的目的地也是NAT路由器，然后由NAT路由器根据NAT转换表转发给家庭网络内的成员。</p><h1 id="ipv6"><a class="markdownIt-Anchor" href="#ipv6"></a> IPv6</h1><p>由于IPv4地址即将耗尽，人们不得不开发出地址更多的空间。IPv6有128字节，是IPv4的2^96倍，也就是说不可能被用完。</p><h2 id="数据报格式-2"><a class="markdownIt-Anchor" href="#数据报格式-2"></a> 数据报格式</h2><ul><li>版本：</li><li>流量类型： 和IPv4中服务类型类似</li><li>流标签： 用来表示优先级的</li><li>有效载荷长度： 表示了跟在40字节数据报后的字节数量（也就是除首部外的大小）</li><li>下一个首部： 标识数据报要交给哪个协议</li><li>跳限制： 每过一个路由器减一</li></ul><p>他和IPv4相比少了</p><ul><li>分片： IPv4不允许在路由器中拆分合并。如果IPv6数据报太大而不能传输，路由器只需丢掉数据报然后发送一个分组太大的差错报文即可。</li><li>首部检验和： 因为IPv6的设计者认为在应用层和传输层都有了检验和，这里显得有些多余，并且耗时巨大</li></ul><h2 id="从ipv4到ipv6的迁移"><a class="markdownIt-Anchor" href="#从ipv4到ipv6的迁移"></a> 从IPv4到IPv6的迁移</h2><p>一种方式是借用现有的IPv6网络，起点和终点是IPv6网络，中间是IPv4网络，我们将中间的IPv4网络称为<strong>隧道</strong>。首先在IPv6网络中使用IPv6数据报，然后到IPv4部分再套一个IPv4数据报的头部，IPv4数据报的内容就是IPv6数据报，之后在IPv4网络中进行传输。</p><h1 id="路由选择算法"><a class="markdownIt-Anchor" href="#路由选择算法"></a> 路由选择算法</h1><p>我们可以把路由器简化成一个图，图中的节点代表路径，边上的值代表路径之间的消耗（一般由物理长度确定），如果两个路由器之间没有路，那么长度是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">∞</span></span></span></span>,现在任务简化成了找单源最短路。</p><p>路由算法的一种分类方式是根据算法是集中计算还是分类计算来划分。</p><ul><li>集中式路由算法： 这种算法在计算开始之前就有全局的网络信息，知道每一个节点的消耗。</li><li>分散式路由选择算法： 每个节点只知道部分信息，然后通过这部分信息知道下一步的路径。</li></ul><h2 id="链路状态路由选择算法"><a class="markdownIt-Anchor" href="#链路状态路由选择算法"></a> 链路状态路由选择算法</h2><p>这种算法是一种集中式算法，每个节点都知道完整的网络信息。在实践中，通常用<strong>链路状态广播算法</strong>来实现。在知道信息之后，就可以使用<a href="https://xinhecuican.github.io/post/15201.html#dijkstra">Dijkstra算法</a></p><h2 id="距离向量"><a class="markdownIt-Anchor" href="#距离向量"></a> 距离向量</h2><p>距离向量算法是一种分散式的路由选择算法。其实这里使用的是<a href="https://xinhecuican.github.io/post/15201.html#bellman-ford">Ford算法</a></p><p>首先每个端点对它直接相连的端点的消耗值是清楚的。消耗值是c(x, v)【从x节点到v节点】</p><ul><li>设定从n节点到某个节点（m）的最短距离为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D_{n}(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span>，初始化距离为从n到m的距离。也就是图中的第一列。</li><li>之后首先向各个端点传输一次自己的最短距离表，然后发现和自己表不同并且如果开始时无穷就直接填表</li><li>之后按照<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>i</mi><msub><mi>s</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mi>c</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>+</mo><mi>d</mi><mi>i</mi><msub><mi>s</mi><mi>v</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">dis_x(y) = min{c(x, v) + dis_v(y)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault">c</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span>更新值（更新值时使用传过来的表），每次更新完成之后就向直接相邻的节点发送更新后的值，然后邻居节点也用上式进行比较，如果有新值也进行更新</li></ul><p><img src="/images/%E7%BD%91%E7%BB%9C%E5%B1%825.jpg" alt="" /></p><h3 id="链路故障"><a class="markdownIt-Anchor" href="#链路故障"></a> 链路故障</h3><p>上面算法不是完全可靠的，例如x到y的值从2到60。那么我们计算<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mi>y</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D_y(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span>时会得到$D_y(x) = min{c(y, x) + D_x(x), c(y,z) + D_z(x)} = min{60 + 0, 1 + 3} = 4 $.这毫无疑问是错误的，更重要的是这会导致一直循环。</p><p>解决问题的一个方法时首先让到达终点的路变为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">∞</span></span></span></span>，例如D_z(x) = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">∞</span></span></span></span>。这样就会先将其他的路径全更新了，待到更新完成之后再换成真实值，然后再进行更新。</p><h2 id="自治系统内部的路由选择策略"><a class="markdownIt-Anchor" href="#自治系统内部的路由选择策略"></a> 自治系统内部的路由选择策略</h2><p>互联网是一个庞大的系统，如果所有主机都参与路由选择，那么开销是不可估计的，并且不同的机构可能想使用不同的管理策略。因此可以按照机构或地区分成一个个子系统，子系统中可以单独操作。</p><h3 id="开放最短路优先ospf"><a class="markdownIt-Anchor" href="#开放最短路优先ospf"></a> 开放最短路优先（OSPF)</h3><p>开放最短路优先使用的算法是Dijkstra算法。但是这里有一个管理员设置链路开销，可能会把所有开销设置成1，那么关注的是最少跳数。如果按链路容量反比设置，那么表示不鼓励使用低宽带链路。</p><p>并且为了保证链路的健壮性，当链路接入或断开时会第一时间发送信息。如果没有变化也会每隔30分钟发送当前状态信息。</p><h2 id="isp之间路由选择bgp"><a class="markdownIt-Anchor" href="#isp之间路由选择bgp"></a> ISP之间路由选择：BGP</h2><p>如果路由器在自治系统边缘，那么就叫他网关路由器，否则叫他内部路由器。网关路由器负责两个自治系统之间的链接，他们的连接叫外部BGP。反之为内部BGP。</p><p><img src="/images/%E7%BD%91%E7%BB%9C%E5%B1%826.jpg" alt="" /></p><p>使用BGP选择策略时要传递一些信息，这些信息统称为路由，其中最重要的两个属性是AS-PATH和NEXT-HOP</p><ul><li>AS-PATH: 指的是已经通过的自治系统的列表，它可以痛啊哦路径并且检测环路。例如从1a到3d，当他到达3a时AS-PATH = “AS2 AS3”,而如果是1d到3d，那么值为AS3</li><li>NEXT-HOP: 指的是AS-PATH中起始位置的IP地址（注意AS-PATH中不包含起始的自治系统）。例如上面第一个例子NEXT-HOP = 2a左边端口地址。第二个例子NEXT-HOP = 3d左边端口地址。</li></ul><h3 id="热土豆路由选择"><a class="markdownIt-Anchor" href="#热土豆路由选择"></a> 热土豆路由选择</h3><p>热土豆选择算法是一种贪心算法，它的思想是尽快将数据穿输出自己的自治系统。假设我们已经知道了到终点的所有可能路径，然后计算起始点到NEXT-HOP之间的最短开销，然后把这个最短开销对应的接口和终点自治系统记录(x, I)到自己的转发表上</p><h3 id="路由器选择算法"><a class="markdownIt-Anchor" href="#路由器选择算法"></a> 路由器选择算法</h3><p>路由器选择算法是热土豆选择算法的改进。它对热土豆选择算法加了许多限制。它的运行流程如下</p><ol><li>路由被指定一个本地偏好值。这个值可能由路由器设置或者从相同自治系统中的另一台路由器中学习得到。具有最高本地路由编号值的将被优先选择。</li><li>如果学习偏好值相同，那么寻找最短AS-PATH的路由</li><li>否则，按照热土豆路由选择</li><li>否则，按照BGP标识符选择</li></ol><h2 id="ip任播"><a class="markdownIt-Anchor" href="#ip任播"></a> IP任播</h2><p>IP任播服务通常被利用于DNS中，他主要对具有相同内容但是位置不同的服务器进行最佳选择。</p><p>例如CDN公司的多台服务器配制了相同的IP地址。然后某台BGP路由器收到了该IP地址的多个路由通告，之后根据路由器选择算法选出最佳的一个。</p><h1 id="sdn控制平面"><a class="markdownIt-Anchor" href="#sdn控制平面"></a> SDN控制平面</h1><p>传统路由器和交换机基于IP地址进行转发，而通用转发除了IP地址外，还有许多其他因素如TCP端口、IP协议等用于<strong>匹配</strong>，匹配完成之后不一定只有转发一个<strong>动作</strong>，还可能重写、拒绝等等一系列操作。</p><p>通用转发是传统转发的拓展，它拓展了匹配和动作的范围。</p><h2 id="匹配和动作"><a class="markdownIt-Anchor" href="#匹配和动作"></a> 匹配和动作</h2><p>在分组交换机中有匹配和动作表，这个表由远程控制器进行维护，这个表又被称为<strong>流表</strong>，它包含以下内容</p><ul><li>首部字段值集合： 这是用于匹配的部分，也就是下图的字段。这些字段可以是空也可以使用正则表达式替代</li><li>计数器集合： 计数器可以包括该表项已经匹配的分组数量，还可以记录自上次更新所经过的时间</li><li>动作集合： 每个匹配就会对应一个动作。这些动作可以是转发到给定的输出端口，丢弃分组，复制分组和发送到多个输出端口。</li></ul><p><img src="/images/%E7%BD%91%E7%BB%9C%E5%B1%827.jpg" alt="" /></p><p>如图是OpenFlow(一种通用转发标准）的匹配字段。这些匹配字段实际上就是各个协议的首部字段中一些重要内容。</p><p>每个流表项可以有零个或多个动作列表，如果有多个动作，那么这些动作按序执行。</p><p><img src="/images/%E7%BD%91%E7%BB%9C%E5%B1%828.jpg" alt="" /></p><p>例如我们想把h5的数据发送到h3,并且想要从s3-&gt;s1-&gt;s2方式进行发送，那么流表为</p><table><thead><tr><th>匹配</th><th>动作</th></tr></thead><tbody><tr><td><strong>s1流表</strong></td><td></td></tr><tr><td><code>Ingress Port=1; IP Src=10.3.*.*; IP Dst=10.2.*.*</code></td><td>Forward(4)</td></tr><tr><td><strong>s3流表</strong></td><td></td></tr><tr><td><code>IP Src=10.3.*.*; IP Dst=10.2.*.*</code></td><td>Forward(3)</td></tr><tr><td><strong>s2流表</strong></td><td></td></tr><tr><td><code>Ingress Port=2; IP Dst=10.2.0.3</code></td><td>Forward(3)</td></tr></tbody></table><p>其中的Forward表示要把数据发送到哪个输出接口</p><h1 id="icmp因特网控制报文协议"><a class="markdownIt-Anchor" href="#icmp因特网控制报文协议"></a> ICMP：因特网控制报文协议</h1><p>ICMP被用来进行主机和路由器之间的沟通，它最典型的用途是差错报告。它在体系结构中位于IP之上，换言之ICMP包括IP。</p><p>ICMP结构为一个类型字段和一个编码字段，不同的类型和编码组合有不同的作用</p><table><thead><tr><th>ICMP类型</th><th>编码</th><th>描述</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>回显回答</td></tr><tr><td>3</td><td>0</td><td>目的网络不可达</td></tr><tr><td>3</td><td>1</td><td>目的主机不可达</td></tr><tr><td>3</td><td>2</td><td>目的协议不可达</td></tr><tr><td>3</td><td>3</td><td>目的端口不可达</td></tr><tr><td>3</td><td>6</td><td>目的网络未知</td></tr><tr><td>4</td><td>0</td><td>拥塞控制</td></tr><tr><td>8</td><td>0</td><td>回显请求</td></tr><tr><td>10</td><td>0</td><td>路由器发现</td></tr><tr><td>11</td><td>0</td><td>TTL过期</td></tr><tr><td>12</td><td>0</td><td>IP首部损坏</td></tr></tbody></table><p>其中回显请求也就是ping命令所发送的。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;基础概念&quot;&gt;&lt;a class=&quot;markdownIt-Anchor</summary>
      
    
    
    
    <category term="网络" scheme="http://xinhecuican.github.io/categories/%E7%BD%91%E7%BB%9C/"/>
    
    
  </entry>
  
  <entry>
    <title>运输层</title>
    <link href="http://xinhecuican.github.io/post/2cad8b04.html"/>
    <id>http://xinhecuican.github.io/post/2cad8b04.html</id>
    <published>2021-02-05T02:57:00.000Z</published>
    <updated>2021-04-21T12:55:54.858Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="多路复用和多路分解"><a class="markdownIt-Anchor" href="#多路复用和多路分解"></a> 多路复用和多路分解</h1><p>多路分解： 多路分解指的是将报文段中的数据提交到正确的套接字<sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="应用程序接受信息的接口">[1]</span></a></sup></p><p>多路复用：从主机不同套接字上收集数据，并为每个数据块加上首部信息（如源端口号和目的端口号等）形成报文段，然后传到网络层。</p><p>多路复用也就是从传输层到网络层的过程，而多路分解是从传输层到应用层的过程</p><p>要想提交到正确的套接字，其实也就是提交到正确的端口。在计算机中端口范围在0-65535中，其中0-1023是周知端口号，有特殊用途，而其他就是分配给应用程序使用的了。</p><p><strong>UDP的多路复用和多路分解</strong></p><p>UDP的运输层报文段包括应用程序数据，源端口号，目的端口号和其他两个值。通过目的端口号可以标识要送到目的的具体位置，而源端口号则是为了送回数据时使用的。</p><p><strong>TCP的多路复用和多路分解</strong></p><p>TCP和UDP区别是TCP套接字是一个四元组(源IP地址， 源端口号， 目的IP地址， 目的端口号）来标识的。因此他还可以让两个到同一个端口号的TCP连接互不干扰（因为有了源IP地址，所以可以分辨出这个数据时从哪发出的）</p><h1 id="udp"><a class="markdownIt-Anchor" href="#udp"></a> UDP</h1><p>UDP是一种不可靠运输，数据可能会丢失，那为什么需要UDP而不使用TCP呢？</p><ul><li>速度更快， TCP在链接建立之前需要经过三次握手，而UDP直接传输</li><li>无连接状态： TCP需要维护连接状态。包括接受发送缓存，用色控制参数和序号及确认号参数等。</li></ul><h2 id="报文段结构"><a class="markdownIt-Anchor" href="#报文段结构"></a> 报文段结构</h2><p>UDP报文段包括源端口号，目的端口号，长度，检验和和报文组成。长度指示了该报文段总的字节数（包括报文的）并且前面四个字段大小都是两字节</p><p>检验和是为了提供差错检验机制的。具体过程为将其他三个字段相加，舍去溢出并取反。之后检验就将这四个字段相加，如果结果全是1则正常。</p><p>例如：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0110011001100000</span><br><span class="line">0101010101010101</span><br><span class="line">1000111100001100</span><br><span class="line"></span><br><span class="line">相加并舍去溢出为：</span><br><span class="line">0100101011000010</span><br><span class="line"></span><br><span class="line">取反为：</span><br><span class="line">1011010100111101</span><br><span class="line">这就是检验和的值</span><br><span class="line"></span><br><span class="line">然后检验时将四个相加舍去溢出结果应该是1111111111111111</span><br></pre></td></tr></table></figure><h1 id="可靠数据传输"><a class="markdownIt-Anchor" href="#可靠数据传输"></a> 可靠数据传输</h1><p>传输过程为从应用层到传输层是可靠传输，然后从传输层到网络层是不可靠传输，然后从网络层到传输层是可靠传输。</p><h2 id="经完全可靠信道的可靠数据传输"><a class="markdownIt-Anchor" href="#经完全可靠信道的可靠数据传输"></a> 经完全可靠信道的可靠数据传输</h2><p><img src="/images/%E8%BF%90%E8%BE%93%E5%B1%82.jpg" alt="" /></p><p>等待上层的调用指的是从应用层到网络层，等待下层代用相反。rdt_send是从应用层向传输层传输（并且是可靠传输）。</p><p>这是一个有限状态自动机， 横线上方是引起变动的事件，横线下方是发生是采取的动作。</p><h2 id="经比特差错信道的可靠数据运输"><a class="markdownIt-Anchor" href="#经比特差错信道的可靠数据运输"></a> 经比特差错信道的可靠数据运输</h2><p>底层信道可能会出现某些问题导致数据不可靠。因此为了保证数据的可靠性，可能需要对传输过来的数据进行重新检测，返回报文可能会出现肯定确认和否定确认两种情况。为了保证传输稳定，可以使用自动重传请求协议（ARQ)</p><p>ARQ还需要另外三种功能才能进行自动重传</p><ul><li>差错检测：</li><li>接收方反馈： 也就是前面说的肯定确认(ACK)和否定确认(NAK)</li><li>重传： 当接收方收到有差错的分组时，发送方将重传该分组。</li></ul><p>但是接收方反馈的信号也可能出现问题，本来是肯定确认现在变成了无意义的代码。为了解决这个问题可以使用下列方法</p><ul><li>让接收方再次发送信息，但是存在这次信息仍然被干扰的问题。</li><li>增加足够多的检验和比特</li><li>第三种方法是接收到模糊信息直接重发分组。但是这种方法的问题是接收方不知道下一个分组是否是重发的分组，因此无法决定信息用途。</li></ul><p>为了解决第三种方法的问题，可以在分组前加一个序号字段。这个字段对分组进行了编号。现在假设这个字段不会受到干扰，那么接收方接受到的分组和上一个分组相同，表明这是重发分组。</p><p>在这种一来一回的传输过程中，序号字段只需要一个bit就可以了，因为如果这个bit是0表示是初始信息，是1表示重传。</p><p>另外还可以使用ACK表示ACK和NAK两种信息。只需要把ACK中的序号字段标记位0表示这个ACK是上个分组的。</p><h2 id="经丢包信道的可靠数据传输"><a class="markdownIt-Anchor" href="#经丢包信道的可靠数据传输"></a> 经丢包信道的可靠数据传输</h2><p>假设现在发送的分组或者接收方反馈的信息发生了丢失，这种情况下发送方都接收不到反馈，那么发送方可以选择在等待足够长的时间过后认为<strong>分组已丢失</strong>，只需要重新发送分组即可。</p><p>为了实现等待一定时间重传的机制，可以使用倒计时计时器。每次经过一定时间后，如果没有受到恢复，则可以进行重传。</p><h2 id="流水线可靠数据传输协议"><a class="markdownIt-Anchor" href="#流水线可靠数据传输协议"></a> 流水线可靠数据传输协议</h2><p>前面加上了计时器机制之后数据可靠性已经可以保证，但是它的速度不够快，因为它是<strong>停等协议</strong>。停等协议指的是它可以每次发送完数据之后都需要等待响应（ACK或NAK）才进行下一步发送。</p><p>一个简单的方法是发送方可以发送多个分组而无需等待，这种技术称为流水线。</p><p>为了保证流水线正常工作，还需要考虑以下内容</p><ul><li>需要增加序号的范围</li><li>发送方和接收方不得不缓存多个分组，发送方最少要缓存那些已发送但是没有得到确认的分组，接收方也需要保存接收的分组</li><li>对于丢失或损坏的分组，有两种基本方法是： 回退N步和选择重传</li></ul><h3 id="回退n步gbn"><a class="markdownIt-Anchor" href="#回退n步gbn"></a> 回退N步（GBN）</h3><p>在GBN中序号范围分隔成四段。</p><p><img src="/images/%E8%BF%90%E8%BE%93%E5%B1%822.webp" alt="" /></p><p>基序号是最早未确认分组的序号，下一个序号是最小未使用序号。</p><p>窗口长度是被发送当未确认的分组最大数量。要限制最大长度是为了对发送方进行限制。</p><p>发送方需要响应三种事件</p><ul><li>上层调用: 当上层调用rdt_send()发送数据时，如果窗口未满，则产生分组，如果已满，则通知上层。</li><li>收到ACK： 在GBN中，对序号为n的分组的确认采取累积确认。表示接收方已正确接收n及之前所有的分组</li><li>超时事件： 如果出现超时，发送方重传所有已发送但未确认的分组（因为接收方会把所有乱序的抛弃）。</li></ul><p>接收方只有接收到n分组并且前一个接收的分组是n-1分组才会交付到上层。其他情况都会丢弃分组并且发送需要接受分组的ACK。之所以这样是为了减小接收方的负担及简化设计流程。也就是说接收方的窗口值大小是1.</p><h3 id="选择重传"><a class="markdownIt-Anchor" href="#选择重传"></a> 选择重传</h3><p>GBN缺点就是性能利用率低，可能需要不断大量的重复传输。选择重传（SR）协议让发送方仅重传怀疑接收方未正确接收的分组，从而避免不必要的重传。</p><p><img src="/images/%E8%BF%90%E8%BE%93%E5%B1%823.jpg" alt="" /></p><p>这里和回退N步的模式大致相同，区别是在这个窗口中确认不一定是按序了，例如2已经确认但是0和1未确认。</p><p>如果序号在[base, base + N -1]的数据被正确接收，那么一个ACK传给发送方。如果是[base_ - N, base - 1]的数据被接收，那么抛弃数据，但一定要发送ACK（因为发送方重发就是因为没有接收到ACK）。其他情况忽略分组。</p><p><img src="/images/%E8%BF%90%E8%BE%93%E5%B1%824.jpg" alt="" /></p><p>图二是由于发送方和接收方窗口不一致和序号太小导致的。它的序号数量正好等于窗口数量，并且接受方如果全部接受则窗口会滑动到下一组012，但是如果它发出ACK出错的话会重新发送第一组的012，然后这时候接收方会直接接受。</p><p>为了解决这个问题，序号至少为窗口大小的两倍。</p><p>SR接收方将缓存分组知道比他小的分组全部接收到为止。</p><h2 id="使用技术总结"><a class="markdownIt-Anchor" href="#使用技术总结"></a> 使用技术总结</h2><table><thead><tr><th>机制</th><th>用途</th></tr></thead><tbody><tr><td>检验和</td><td>检验传输分组是否有错误</td></tr><tr><td>定时器</td><td>用于超过一定时间重传</td></tr><tr><td>序号</td><td>与定时器配合使用，让接收方知道这是新的还是重传的</td></tr><tr><td>确认</td><td>用于告诉发送方收到了</td></tr><tr><td>否定确认</td><td>告诉某个分组未被正确接收</td></tr><tr><td>窗口、流水线</td><td>用于连续发送分组 ，需要前面技术配合</td></tr></tbody></table><h1 id="tcp连接"><a class="markdownIt-Anchor" href="#tcp连接"></a> TCP连接</h1><p>TCP连接时点对点的协议，也就是说必须在两个进程之间建立联系然后发送数据。</p><p>建立TCP连接的大致过程为： 客户发送特殊的TCP报文段，服务器用特殊的TCP报文段响应。最后客户再用第三个特殊报文段进行响应。前两个报文段没有有效数据，而第三个可以由有效数据。经过三个报文段后，TCP连接就可以说建立了。因为发送了三个特殊报文段，所以也可以说是三次握手。</p><p>在数据经过套接字之后就会受到TCP控制。TCP首先将数据放到发送缓存中（在握手期间设置）。然后TCP会时不时的拿出一块数据放到网络层，每次可以拿的数据受限于最大报文段长度（通常由本地发送主机最大链路层帧长度也就是最大传输单元决定）</p><h2 id="报文段结构-2"><a class="markdownIt-Anchor" href="#报文段结构-2"></a> 报文段结构</h2><p><img src="/images/%E8%BF%90%E8%BE%93%E5%B1%825.jpg" alt="" /></p><p>包括源端口号和目的端口号，检验和字段三个熟悉的。还有</p><ul><li>序号（Seq)： 序号就是报文段首字节编号。例如一个数据大小50000字节，MSS为1000字节。那么第一个报文段就是0-999,第二个报文段是1000-1999.那么第一个报文段的序号是0，第二个报文段的序号是1000</li><li>确认号（ACK）： 确认号是想对方发来的数据中首字节的序号。例如现在0-100和200-300已经接收到了，但是中间的可能由于某种原因没有接收到，这时候就需要用确认号让对方将101开始的数据重发一次。</li><li>接收窗口字段： 用于指示接收方愿意接受的字节数量</li><li>首部长度字段： 指示了TCP的首部长度</li><li>选项字段：</li><li>标志字段： 就是中间那些小的。ACK表示确认字段中的值是有效的。RST、SYN和FIN用于连接的建立和拆除。CWR和ECE用于明确拥塞通告。PSH指示需要将数据立即交给上层。</li></ul><h2 id="往返时间估计"><a class="markdownIt-Anchor" href="#往返时间估计"></a> 往返时间估计</h2><p>首先样本往返时间（SampleRTT)。然后每次发送并接收到数据时（对重传的不计算SampleRTT）对这个往返时间进行更新，因为网络会有波动。计算公式为</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>R</mi><mi>T</mi><mi>T</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>E</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>R</mi><mi>T</mi><mi>T</mi><mo>+</mo><mi>α</mi><mo>∗</mo><mi>S</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>R</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">EstimatedRTT = (1 - \alpha ) * EstimatedRTT + \alpha * SampleRTT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span></p><p>SampleRTT是这次数据来回所需要的时间，EstimatedRTT是估计出来的平均时间，最终使用EstimatedRTT。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span></span></span></span>一般取0.125。</p><p>而估算SampleRTT偏移EstimatedRTT的程度也是有价值的。计算公式为</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mi>e</mi><mi>v</mi><mi>R</mi><mi>T</mi><mi>T</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>D</mi><mi>e</mi><mi>v</mi><mi>R</mi><mi>T</mi><mi>T</mi><mo>+</mo><mi>β</mi><mo>∗</mo><mi mathvariant="normal">∣</mi><mi>S</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>R</mi><mi>T</mi><mi>T</mi><mo>−</mo><mi>E</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>R</mi><mi>T</mi><mi>T</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">DevRTT = (1 - \beta) * DevRTT + \beta * | SampleRTT - EstimatedRTT|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord">∣</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span></span>一般取0.25.</p><p>重传时间间隔可以用<code>TimeoutInterval = EstimatedRTT + 4 * DevRTT</code>计算得出</p><h2 id="可靠数据传输-2"><a class="markdownIt-Anchor" href="#可靠数据传输-2"></a> 可靠数据传输</h2><p>首先考虑最简单的情况，即只需要考虑定时器。定时器重置的时期有</p><ul><li>如果从上层应用接收到数据并且定时器未启动，则启动定时器</li><li>定时器超时重置定时器</li><li>收到ACK并且ACK的确认号值比SendBase（最早未被确认的字节序号）大，那么则更新SendBase并且重置定时器。这是因为TCP采取<strong>累积确认</strong>的模式，只有前面字节全部接收到才会继续往后确认。</li></ul><p>例如主机A上传序号92，长度8字节和序号100，长度20字节的数据。结果两个都被接收但是两个的ACK都丢失了，那么这是时第二种情况一次只会上传一个，等到第二次超时或者接收ACK才会进行下一步。</p><p>或者接收到了序号100的ACK，确认号是120，那么下次直接从120开始传输数据,并且确认号是100。</p><p>下面是超时重传的一些改进方法</p><h3 id="超时间隔加倍"><a class="markdownIt-Anchor" href="#超时间隔加倍"></a> 超时间隔加倍</h3><p>因为在某些情况下网络可能比较拥堵，原来推测出来的间隔值太小了。这就会导致不断的重传。为了避免这种问题，可以每次超时重传就让时间间隔乘2.</p><h3 id="快速重传"><a class="markdownIt-Anchor" href="#快速重传"></a> 快速重传</h3><p>超时重传另外一个原因是超时周期可能过长。例如接收方接收到了许多失序的数据，但是低端始终有一块没有接收到，这种情况只有等待发送方超时重传，但是如果发送方重传时间间隔过长便会降低性能。</p><p>这里使用的重传方法既不是回退N步也不是选择重传，而是二者的综合。</p><table><thead><tr><th>事件</th><th>接收方动作</th></tr></thead><tbody><tr><td>按序的报文段到达，并且所有在期望序号前的数据都被确认</td><td>等待500ms再发送ACK。因为很可能下一个报文段也要到达，这样返回时只需要确认下一个报文段</td></tr><tr><td>按序报文段到达，并且另一个按序报文段等待ACK传输<sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="也就是前面的报文段还没有发ACK">[2]</span></a></sup></td><td>立刻发送单个积累ACK，以确认两个按序报文段</td></tr><tr><td>比期望序号的的失序报文段到达</td><td>立刻发送冗余ACK，指示期望字节的序号</td></tr><tr><td>可以填充失序区间的报文段到达</td><td>若报文段起始于低端，则立刻发送ACK</td></tr></tbody></table><p>如果发送方接收到三次确认号相同的ACK（冗余ACK）后选择立刻重传。接收方在接收失序的数据时会发送一个ACK，它的确认号仍是未被接收数据中的首地址。</p><h3 id="流量控制"><a class="markdownIt-Anchor" href="#流量控制"></a> 流量控制</h3><p>TCP通过让发送方维护一个叫接收窗口的变量来提供流量控制。接受窗口也就是接收方还有多少缓存可用于接收。定义下列变量进行控制</p><ul><li>LastByteRead: 接收方应用程序从缓存中读出的最后一个字节编号</li><li>LastByteRcvd：到达接收方的最后一个字节编号</li></ul><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>a</mi><mi>s</mi><mi>t</mi><mi>B</mi><mi>y</mi><mi>t</mi><mi>e</mi><mi>R</mi><mi>c</mi><mi>v</mi><mi>d</mi><mo>−</mo><mi>L</mi><mi>a</mi><mi>s</mi><mi>t</mi><mi>B</mi><mi>y</mi><mi>t</mi><mi>e</mi><mi>R</mi><mi>e</mi><mi>a</mi><mi>d</mi><mo>≤</mo><mi>R</mi><mi>c</mi><mi>v</mi><mi>B</mi><mi>u</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">LastByteRcvd - LastByteRead \le RcvBuffer</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">e</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span></p><p>接受窗口 rwnd = RcvBuffer - [LastByteRcvd - LastByteRead]</p><p>LastByteSend指的最后发送的字节，LastByteAcked表示最后确认的字节。LastByteSend-LastByteAcked表示已经发送但是没有得到响应的字节数。</p><p>$ LastByteSent - LastByteAcked &lt;= rwnd$</p><blockquote><p>接收窗口也就是接收方还可以接受的字节数量，他会随着返回报文的窗口字段返回给发送方，从而让发送方知道自己还可以发送多少字节。</p></blockquote><p>当rwnd为零（缓存满）的时候，规定主机A继续发送一字节的报文段，这些报文段会被接收方确认，直到确认报文中rwnd非0.</p><p>这样做的目的是只有发送方发送接收方才会发送确认报文，才会通知rwnd改变，如果发送方满了就不发送那么接收方已经处理完数据发送方也不知道。</p><h2 id="tcp连接和关闭过程"><a class="markdownIt-Anchor" href="#tcp连接和关闭过程"></a> TCP连接和关闭过程</h2><ol><li>客户端的TCP首先向服务器的TCP发送一个报文，报文首部一个标志位（SYN比特）被置为1.另外客户会随机选择一个初始序号，并将此编号放在序号字段中，用来保证安全。</li><li>报文到了服务器后，服务器将分配缓存和变量，并向客户发送允许连接的报文段。这个允许连接的报文中SYN被置1，并且确认号字段是初始序号+1，并且服务器也选择了一个初始序号并且放入序号字段中。这个报文又叫SYNACK报文段</li><li>在收到返回报文后，客户也要给该连接分配缓存，然后又发送一个报文段，这个报文段的确认字段为服务器初始序号+1， 因为TCP已经建立，SYN被置0，并且这个报文段中可以存放数据。</li></ol><p>参与TCP连接的双方都有权利终止连接，终止连接的过程为：</p><ol><li>例如客户进程终止连接。客户向服务器发出一个特殊的TCP报文段，报文段中FIN标志位为1</li><li>服务器接收到之后，发送确认报文段，然后发送它自己的终止报文段。</li></ol><h1 id="拥塞控制"><a class="markdownIt-Anchor" href="#拥塞控制"></a> 拥塞控制</h1><p>在理想情况下，两个主机通过一个路由器传输数据，并且这个路由器的缓存无限大。假设这个链路的容量为R，发送数据速率为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span>字节/秒。那么当\lamdba小于R/2时，传输数据速率就是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span>，当速率大于R/2时，传输速率为R/2（因为是发送和接收双向的）。</p><p>现在考虑容量有限并且分组会丢失。这种情况下<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span></span></span></span> = R/2 时传输速率达不到R/2（因为要重传），大概在R/3左右。如果发送方提前发送分组会导致重复发送，利用率更低。</p><h2 id="tcp拥塞控制"><a class="markdownIt-Anchor" href="#tcp拥塞控制"></a> TCP拥塞控制</h2><p>为了实现拥塞控制，需要添加一个变量cwnd，他和流量控制变量rwnd有类似的作用</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>a</mi><mi>s</mi><mi>t</mi><mi>B</mi><mi>y</mi><mi>t</mi><mi>e</mi><mi>S</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>−</mo><mi>L</mi><mi>a</mi><mi>s</mi><mi>t</mi><mi>B</mi><mi>y</mi><mi>t</mi><mi>e</mi><mi>A</mi><mi>c</mi><mi>k</mi><mi>e</mi><mi>d</mi><mo>&lt;</mo><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mi>c</mi><mi>w</mi><mi>n</mi><mi>d</mi><mo separator="true">,</mo><mi>r</mi><mi>w</mi><mi>n</mi><mi>d</mi></mrow></mrow><annotation encoding="application/x-tex">LastByteSent - LastByteAcked &lt;= min{cwnd, rwnd}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">A</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span></span></span></span></span></p><p>那么cwnd在什么情况下会被调节呢</p><ul><li>丢失报文段。 丢失报文段代表拥塞，因此用降低发送方的发送速率，也就是降低cwnd。</li><li>确认报文段。 当一个先前未被确认数据的确认报文段到达时，表示现在网络情况良好，可以增大速率。</li></ul><h3 id="慢启动-拥塞避免和快速恢复"><a class="markdownIt-Anchor" href="#慢启动-拥塞避免和快速恢复"></a> 慢启动、拥塞避免和快速恢复</h3><p><strong>慢启动</strong></p><p>在启动时，cwnd往往设置的比较小，然后每次被确认就增加一个MSS（每次传输数据的最多数量）。然后第二次增加两个，第三次增加4个，也就是成指数级增长。</p><p>当存在一个由于超时导致的丢包事件时，就把cwnd设置为1并重启慢启动，他还将一个标记ssthresh(慢启动阈值）设置为cwnd/2。</p><p>之后如果缓存达到或超过ssthresh后，会终止慢启动并且开启拥塞避免模式。</p><p>如果检测到三个冗余ACK，那么会快速重传并且执行一次快速恢复。</p><p><strong>拥塞避免</strong></p><p>进入拥塞避免状态时一般都在ssthresh左右，这时需要减慢MSS的增长速度，因此可以每过一个RTT（平均往返时间）就增长一个MSS。这样就由原来的指数级增长变为线性增长。</p><p>当又遇到超时导致的丢包后，就将cwnd重置并且将ssthreash更新为cwnd的一半。如果遇到三次ACK导致的丢包，因为这种情况说明网络情况还比较好，因此只需要将<strong>cwnd减半</strong>并且sstresh更新为cwnd的一半然后进入快速恢复状态</p><p><strong>快速恢复</strong></p><p>快速恢复变成了 每接收到一个冗余ACK就让cwnd加一个MSS，直到对视报文段的一个ACK到达时，TCP在降低cwnd后进入拥塞避免状态。<div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">应用程序接受信息的接口<a href="#fnref:1" rev="footnote"> ↩</a></span></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">2.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">也就是前面的报文段还没有发ACK<a href="#fnref:2" rev="footnote"> ↩</a></span></li></ol></div></div></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;多路复用和多路分解&quot;&gt;&lt;a class=&quot;markdownIt-A</summary>
      
    
    
    
    <category term="网络" scheme="http://xinhecuican.github.io/categories/%E7%BD%91%E7%BB%9C/"/>
    
    
  </entry>
  
  <entry>
    <title>应用层与HTTP协议</title>
    <link href="http://xinhecuican.github.io/post/af3eed3c.html"/>
    <id>http://xinhecuican.github.io/post/af3eed3c.html</id>
    <published>2021-01-30T00:31:00.000Z</published>
    <updated>2021-02-04T12:14:49.950Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="http协议"><a class="markdownIt-Anchor" href="#http协议"></a> HTTP协议</h1><h2 id="基础"><a class="markdownIt-Anchor" href="#基础"></a> 基础</h2><p>HTTP由两个程序组成：客户程序和服务器程序。客户程序就是我们电脑上的程序</p><p>一个Web页面是由若干对象组成的，对象指的是一个文件，例如HTML文件，JPEG图像，Java小程序等。</p><p>多数Web页面包含一个<strong>HTML基本文件</strong>和几个引用对象。首先获得基本文件，基本文件之中又有链接到其他文件的URL,然后通过这些URL又获得其他文件。</p><p>例如有时我们直接从浏览器下网页文件打开后发现这个网页既没有排版也没有字体颜色，也没有图像。这里我们下载的文件就是HTML基本文件，如index.html.如果我们想要获得完整的页面就需要根据基本文件中的url再去获得其他文件然后通过浏览器合并到一起。</p><p>HTTP使用TCP作为传输层协议。TCP大致是首先发起一个与服务器的TCP连接，在链接成立之后就可以进行稳定的传输了。</p><h2 id="非持续连接和持续连接"><a class="markdownIt-Anchor" href="#非持续连接和持续连接"></a> 非持续连接和持续连接</h2><p>非持续连接指的是所有请求都通过单独的TCP连接发送，持续连接时所有请求都通过同一个连接发送。</p><h3 id="http的非持续连接"><a class="markdownIt-Anchor" href="#http的非持续连接"></a> HTTP的非持续连接</h3><p>假设我们请求一个HTML基本文件和若干图形。并且这些对象位于同一台服务器上，那么非持续连接请求的大致过程是：</p><ol><li>HTTP客户进程在端口号80发起一个到服务器的TCP连接</li><li>客户通过套接字想服务器发送一个HTTP请求报文</li><li>服务器接收报文，查找对象之后通过TCP发送给客户</li><li>接收完成之后服务器进程同志TCP断开连接</li><li>客户进程接收到基本页面之后，获得其中的URL，再重复上述四个过程获得其他对象。</li></ol><p>那么总的所需时间=发起TCP连接所需时间 + 请求文件建立TCP锁需时间 + 传输文件所需时间</p><h3 id="持续连接"><a class="markdownIt-Anchor" href="#持续连接"></a> 持续连接</h3><p>非持续连接有这些缺点：</p><ul><li>必须为每一个请求对象建立和维护一个连接。每一个连接都需要额外消耗用户和服务器资源，增加了服务器负担</li><li>其次每次建立TCP连接也需要时间</li></ul><p>HTTP1.1持续连接可以让一个Web页面的所有对象通过一个TCP连接进行传输，这些请求可以同时发送并且不需要等待请求的回答。甚至可以对同一个服务器上的多个Web页面进行传输</p><p>HTTP/2允许相同连接中多个请求和回答交错。</p><h2 id="报文格式"><a class="markdownIt-Anchor" href="#报文格式"></a> 报文格式</h2><p><strong>请求报文</strong></p><figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/somedir/page.html</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: www.someschool.edu</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">User-agent</span>: Mozilla/5.0</span><br><span class="line"><span class="attribute">Accept-language</span>: fr</span><br></pre></td></tr></table></figure><p>这是一个典型的报文：</p><ul><li>请求行： 指第一行，有三个字段：方法字段、URL字段和HTTP版本字段。方法字段有GET、POST、HEAD、PUT、DELETE。URL字段要和host拼接起来才是平常熟悉的网址</li><li>首部行： 第一行后面的所有。Connection: close表示不要使用持续连接。</li></ul><p><img src="/images/HTTP1.jpg" alt="" /><br />这是请求报文的一般格式。我们上一个例子没有请求体（实体体）是因为GET不需要请求体。如果是POST就需要请求体提交表单。</p><p><strong>响应报文</strong></p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Date</span>: Tue, 18 Aug 2015 15:44:04 GMT</span><br><span class="line"><span class="attribute">Server</span>: Apache/2.2.3 (CentOS)</span><br><span class="line"><span class="attribute">Last-Modified</span>: Tue, 18 Aug 2015 15:11:03 GMT</span><br><span class="line"><span class="attribute">Content-Length</span>: 6821</span><br><span class="line"><span class="attribute">Conten-Type</span>: text/html</span><br><span class="line"></span><br><span class="line">(data data ...)</span><br></pre></td></tr></table></figure><p>它也分为三个部分：初始状态行，6个首部行、实体体（请求体）。</p><p>初始状态行内容：</p><ul><li>200 OK: 请求成功</li><li>301 Moved Permanently: 请求的对象被永久转移了，新的URL在响应报文的Location中</li><li>400 Bad Request: 一个通用的差错，表示请求不能呗服务器理解</li><li>404 Not Found： 表示请求的对象不再服务器上</li><li>505 HTTP Version Not Supported: 服务器不支持请求报文的HTTP版本</li></ul><p>首部行内容：</p><ul><li>Connection close ： 表示服务器将在这次传输结束之后关闭TCP。</li><li>Date： 这里的时间是发出报文的时间</li><li>Last-Modified: 指示对象最后修改时间</li><li>Content-Length: 内容长度，单位是byte</li></ul><h1 id="cookie"><a class="markdownIt-Anchor" href="#cookie"></a> Cookie</h1><p>前面提到的HTTP服务器是无状态的，也就是说服务器不会对请求进行限制，所有的请求都会一视同仁的响应。然而我们经常要对用户进行限制，因此便是用了cookie。</p><p>cookie生成的大致过程为：当请求报文第一次访问这个网站时，该站点将产生一个唯一识别码，并且作为后端数据库的一个表项。接下来响应报文中就要添加一个Set-cookie项，返回生成的cookie。浏览器接收到相应报文之后，将会把cookie添加到cookie文件中。</p><p>今后访问时请求报文都会在首部行添加Cookie: …。在这种情况下，服务器就可以跟踪用户在站点的活动</p><h1 id="web缓存"><a class="markdownIt-Anchor" href="#web缓存"></a> Web缓存</h1><p>Web缓存器也叫代理服务器。它保存着我们最近浏览的网页信息，我们可以通过配置使HTTP请求首先指向Web缓存器。</p><p>Web缓存的一般过程为</p><ul><li>浏览器创建一个到缓存器的连接，并发送HTTP请求</li><li>如果有该对象就返回</li><li>如果没有就打开一个到服务器的TCP连接，发送请求</li><li>服务器受到请求进行处理然后发给缓存器，并且向浏览器也发送报文（通过缓存器</li></ul><p>Web缓存器一般由本地ISP提供。例如学校和小区服务（而不是个人电脑上），因为距离非常近所以访问速度也比较快，并且可以从整体上减小因特网的流量。</p><p>但是这也会带来一个问题，缓存器中的副本不是最新的。因此为了确保内容是最新的，还有一种条件GET方法。如果报文是GET并且其中包含If-Modified-Since: 首部行，那么就是一个条件GET请求报文。</p><p>如果使用条件报文，回到原服务器中请求，如果发现服务器在指定时间后没有修改，则<strong>Web服务器向缓存器</strong>发送响应报文</p><figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">HTTP</span>/<span class="selector-tag">1</span><span class="selector-class">.1</span> <span class="selector-tag">304</span> <span class="selector-tag">NOT</span> <span class="selector-tag">Modified</span></span><br><span class="line"><span class="selector-tag">Date</span>: <span class="selector-tag">Sat</span>, <span class="selector-tag">10</span> <span class="selector-tag">Oct</span> <span class="selector-tag">2015</span> <span class="selector-tag">15</span><span class="selector-pseudo">:39</span><span class="selector-pseudo">:29</span></span><br><span class="line"><span class="selector-tag">Server</span>: <span class="selector-tag">Apache</span>/<span class="selector-tag">1</span><span class="selector-class">.3</span><span class="selector-class">.0</span> (Unix)</span><br><span class="line">(empty entity)</span><br></pre></td></tr></table></figure><p>这个响应报文初始状态为304，表示该缓存器可以使用该对象，可以向请求的浏览器转发缓存的副本。正因为使用了缓存器的副本，所以相应报文中的请求体为空。</p><h1 id="邮件传输"><a class="markdownIt-Anchor" href="#邮件传输"></a> 邮件传输</h1><p>邮件传输大致分为3个部分： 用户代理，邮件服务器和简单邮件传输协议（SMTP）。 用户代理也就是发送邮件的网页或客户端。</p><p>每个用户在邮件服务器上都有一个邮箱（一片存储区域）。用户代理发送邮件时现发送到自己的邮箱中，然后在传输到对方的邮箱中，再传送到对方的邮件用户代理中。</p><p>邮箱中维护着一个报文队列，每隔若干分钟就会进行一次发送尝试，如果几天之后没有成功就会删除报文并且通知发送方。</p><h2 id="smtp"><a class="markdownIt-Anchor" href="#smtp"></a> SMTP</h2><p>在用户代理和邮件服务器建立之后，我么就可以通过发送特定的消息（HELO， MAIL FROM， RCPT TO， DATA， CRLF等）来写邮件了。而邮件服务器接收完这些消息之后会整合成一个报文传递给对方的邮件服务器。</p><p>报文的典型格式为</p><figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="attribute">From</span>: alice<span class="variable">@crepes</span>.fr</span><br><span class="line"><span class="attribute">To</span>: bob<span class="variable">@hamburger</span>.edu</span><br><span class="line"><span class="attribute">Subject</span>: Serching for the meaning of life.</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%BC%95%E7%94%A8%E5%B1%82%E4%B8%8EHTTP%E5%8D%8F%E8%AE%AE2.png" alt="" /><br />但是SMTP只负责从用户本地到服务器再从自己的服务器到对方服务器，对方从服务器接受的过程不是由SMTP控制的，SMTP只能推送服务，不能拉取服务。</p><h2 id="pop3"><a class="markdownIt-Anchor" href="#pop3"></a> POP3</h2><p>POP3就是负责最后从服务器到用户代理过程的。大致过程为，当用户代理打开一个邮件服务器上端口为110的TCP连接之后，POP3就开始工作了。POP3进行特许（authorization)、事务处理及更新。</p><ul><li>特许： 用户代理发送用户名和口令来鉴别用户</li><li>事务处理： 用户代理取回报文，同时还可以对报文做删除标记或取消删除标记，还可以获得邮件统计信息。</li><li>更新： 用户发出quit命令后，结束POP3.之后邮件服务器将删除带有删除标记的报文。</li></ul><p>在事务处理过程中，服务器对用户发出的命令回答有两种： +OK -ERR.特许阶段主要有两个命令: user (user name)和pass (password).</p><h1 id="dns"><a class="markdownIt-Anchor" href="#dns"></a> DNS</h1><p>DNS是将域名转化为IP地址的过程。域名就是主机名，<a href="http://xn--www-eo8e.facebook.com">如www.facebook.com</a>、www.google.com等。这些名字长度不一且没有特殊含义，只有转化为ip地址路由器才可以进行识别并且将消息传送到指定位置。</p><p>DNS构成为：</p><ol><li>一个分层的DNS服务器实现的分布式数据库</li><li>一个使主机可以查询数据库的应用层协议，DNS协议运行在UDP上，使用53号端口</li></ol><p>DNS通常是应用层使用的，在进行传输时首先需要将它转换为ip，大致过程为</p><ol><li>用户主机上运行着DNS应用客户端（进行DNS解析）</li><li>浏览器从URL中抽取处主机名，并且发送给DNS客户端</li><li>DNS客户端向DNS主机发送一个包含主机名的请求</li><li>DNS客户端收到响应报文并发送给浏览器，浏览器再建立TCP连接</li></ol><p>此外DNS还提供：</p><ol><li>主机别名：一个主机名可以有多个别名，可以通过DNS应用程序获得别名对应的主机名和IP</li><li>邮件服务器别名： 和上面类似</li><li>负载分配： 对于某些繁忙的站点，DNS会使用多个服务器进行管理。这些服务器的IP地址各不相同，因此使用了一个IP地址集合进行管理。每次请求到来时，先用IP地址整个集合进行响应，之后每次回答中循环地址次序。这样做是因为客户总是向IP地址排在最前面的服务器发出报文。</li></ol><h2 id="工作机理"><a class="markdownIt-Anchor" href="#工作机理"></a> 工作机理</h2><p>将所有的域名分布在各个DNS服务器中，顶层DNS负责决定给哪个服务器解析。一般来说可以将DNS服务器大致分为三层： 根DNS服务器， 顶层域（TLD）和权威DNS服务器。</p><p><img src="/images/%E5%BA%94%E7%94%A8%E5%B1%82%E4%B8%8EHTTP%E5%8D%8F%E8%AE%AE3.jpg" alt="" /></p><p>例如我们想获得baidu.com的地址。那么首先和根服务器之一建立联系，根服务器会返回com域名服务器的IP，然后根据IP找到com域名服务器再找的百度.cmo域名服务器从而找到对应IP。</p><ul><li>根服务器： 大概有四百到五百根服务器遍布世界。由多个组织进行管理</li><li>顶层域DNS服务器： 对于每个顶层域（如com、org、net、edu、gov)和国家（uk、fr、ca、jp)都有对应的顶层域服务器</li><li>权威DNS服务器： 在因特网上可以给公共访问的主机都必须提供可供公共访问的DNS记录。一些组织或公司的DNS服务器收藏了这些DNS记录。个人或组织机构也可以选择支付一定费用来获得域名及在DNS服务器上添加记录。例如阿里云或腾讯云都提供了域名解析服务。</li></ul><p>此外每一个居民区或机构的ISP都有DNS服务器，称为本地DNS服务器本地DNS服务器负责与上面三种服务器进行交互并传递数据。</p><p><img src="/images/%E5%BA%94%E7%94%A8%E5%B1%82%E4%B8%8EHTTP%E5%8D%8F%E8%AE%AE4.jpg" alt="" /></p><p>以上是添加了请求主机后的过程。1-8表示过程先后顺序</p><h2 id="dns缓存"><a class="markdownIt-Anchor" href="#dns缓存"></a> DNS缓存</h2><p>DNS缓存原理非常简单，就是每次请求完成之后保存一份在本地DNS服务器中，每次进行DNS解析时首先到本地服务器中寻找。</p><p>DNS缓存时间是有限的，一般是两天。</p><h2 id="dns记录和报文"><a class="markdownIt-Anchor" href="#dns记录和报文"></a> DNS记录和报文</h2><p>DNS数据库中存储了<strong>资源记录</strong>（RR）。每个DNS回答报文中包含一条或多条资源记录。</p><p>资源记录是一个四元组:</p><p><code>(Name, Value, Type, TTL)</code></p><ul><li>TTL: 该记录生存时间，也就是应当从缓存删除的时间</li><li>如果Type=A,则Name是主机名。Value是该主机名对应IP（<a href="http://abcd.com">abcd.com</a>, 145.37.93.126, A）就是一条A记录</li><li>Type=NS, 则Name是域。 Value是存储着转换信息的<strong>权威DNS服务器主机名</strong>。例如(<a href="http://foo.com">foo.com</a>, <a href="http://dns.foo.com">dns.foo.com</a>, NS)</li><li>Type=CNAME, Value是<strong>别名为Name</strong>的规范主机名。例如(<a href="http://foo.com">foo.com</a>, <a href="http://dns.foo.com">dns.foo.com</a>, NS), (<a href="http://xinhecuican.tk">xinhecuican.tk</a>, <a href="http://xinhecuican.github.io">xinhecuican.github.io</a>, NS)</li><li>Type=MX, Value是别名为Name的邮件服务器的规范主机名。(<a href="http://foo.com">foo.com</a>, <a href="http://mail.bar.foo.com">mail.bar.foo.com</a>, MX)</li></ul><p>如果DNS服务器是用于特定主机名（TLD）的权威DNS服务器，那么它就会包含一条TLD的A记录。如果不是用于主机名， 那么还要记录包含主机名的域的NS记录。</p><p>例如 一台eduTLD不是gaia.cs.umass.edu的权威服务器，那么该服务器将包含一条cs.umass.edu的域记录，如(<a href="http://umass.edu">umass.edu</a>, <a href="http://dns.umass.edu">dns.umass.edu</a>, NS)，然后还有一条A记录,如（<a href="http://dns.umass.edu">dns.umass.edu</a>, 128.119.40.111, A). 也就是说可以通过这台eduTLD找到对应的用于解析的服务器。</p><p><strong>DNS报文</strong></p><p>DNS查询报文和回答报文有相同的格式</p><p><img src="/images/%E5%BA%94%E7%94%A8%E5%B1%82%E4%B8%8EHTTP%E5%8D%8F%E8%AE%AE5.gif" alt="" /></p><ul><li>前12字节是首部区域<ul><li>事务ID（标识符）用于标识该查询，占2字节。他会被复制到回答报文中。</li><li>标识： 1bit的标识位指出是查询报文（0）还是回答报文（1）。权威标志位会在权威DNS服务器的回答报文中置1. 希望递归标志位会在DNS服务器支持递归查询时置1.</li><li>四个其他字段： 用来表示后面四个部分的数量</li></ul></li><li>问题区域： 包括<ul><li>名字字段： 正在被查询的主机名</li><li>类型： 正在询问的类型。例如A，NS</li></ul></li><li>回答区域： 也就是前面说的资源记录，这里可能有多条</li><li>权威区域： 包含其他权威服务器的记录</li><li>附加区域： 一些附加信息</li></ul><h2 id="向dns服务器中插入记录"><a class="markdownIt-Anchor" href="#向dns服务器中插入记录"></a> 向DNS服务器中插入记录</h2><p>有许多域名登记机构负责插入记录，他们会收取少量费用（几元到几十万不等）。</p><p>例如我们向登记机构注册networkutopia.com时，需要想机构提供基本和辅助权威DNS服务器的名字和IP。<a href="http://xn--dns1-zu6fx14c.networkutopia.com">例如dns1.networkutopia.com</a>, <a href="http://212.212.212.xn--1dns2-rn9h.networkutopia.com">212.212.212.1和dns2.networkutopia.com</a>, 212.212.212.2。对于这两个权威DNS服务器，注册机构都会向其中添加一条NS和一套A记录输入TLCcom服务器。然后将下面两条资源记录插入DNS数据库中</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">(<span class="selector-tag">networkutopia</span><span class="selector-class">.com</span>, <span class="selector-tag">dns1</span><span class="selector-class">.networkutopia</span><span class="selector-class">.com</span>, <span class="selector-tag">NS</span>)</span><br><span class="line">(<span class="selector-tag">dns1</span><span class="selector-class">.networkutopia</span><span class="selector-class">.com</span>, 212.212.212.1, <span class="selector-tag">A</span>)</span><br></pre></td></tr></table></figure><p>此外，还有确保自己网站的A记录和MX记录被输入到权威DNS服务器中。</p><h1 id="p2p"><a class="markdownIt-Anchor" href="#p2p"></a> P2P</h1><p>一般的文件分发模式是服务器-客户模式，也就是客户上传到服务器，服务器来进行发送。而P2P模式在用户接收到文件之后可以给其他用户发送。与传统的客户-服务器模式相比，P2P模式可以更好的应对大流量。</p><p><img src="/images/%E5%BA%94%E7%94%A8%E5%B1%82%E4%B8%8EHTTP%E5%8D%8F%E8%AE%AE6.jpg" alt="" /></p><p>如图， 服务器上传速率为$$u_s$$，第i个要文件的电脑下载速率为$$d_i$$,上传速率为$$u_i$$.F是文件大小</p><p>最小分发时间&gt;= max{N * F / $$u_s$$, F / $$d_{min}$$ }</p><p>其中N * F / $$u_s$$是服务器传输所有文件所需要的时间，而F / $$d_{min}$$是用户下载需要的最少时间。可以看为每多一个用户就需要占用一份服务器的上传速率，如果它占用的上传速率小于自己的下载速率那么限制因素就变成了第一个。</p><p>因此如果用户非常多，这种模式下服务器负载非常大，对每个用户来说服务器上传速率也就很低了。</p><p><strong>P2P模式</strong></p><ul><li>首先只有服务器有文件。它先将文件中的每个字节发送到各个用户上。所需时间为F/$$u_s$$</li><li>之后用户也可以通过自己接收到的部分参与分发。总的上传速率为$$u_{total} = u_s + u_1 + … + u_n$$。它现在的最小分发时间变为 max{F/$$u_s$$, F/d_{min}, N*F/$$(u_s + \sum_{i=1}^{N}u_i)$$}</li></ul><p><strong>BitTorrent</strong></p><p>BitTorrent是一种P2P协议，BitTorrent把所用下载用户称为洪流（Torrent），在洪流中彼此下载等长度的文件块。如果一个用户下载完成它可以选择退出洪流或者继续共享。</p><p>具体的说，每个洪流都有一个基础节点，称为追踪器（tracker）。每当一个下载用户加入时，他都会向追踪器申请注册并且周期性通知它仍在洪流中。</p><p>在被加入到追踪器后，追踪器会让他参与一个洪流的子集（例如50个用户），并且把这些用户的IP发给该用户。然后该用户就会按照IP创建TCP连接，创建成功则称对方为对等方。</p><p>该用户会周期性的询问邻居他们所具有的块。邻居会发一个他们所具有的块列表，然后该用户会根据表来请求没有的块。</p><p>请求块依据<strong>最稀缺优先</strong>，也就是请求邻居中拥有数量最少的块。</p><h1 id="cdn和视频内容分发"><a class="markdownIt-Anchor" href="#cdn和视频内容分发"></a> CDN和视频内容分发</h1><h2 id="视频"><a class="markdownIt-Anchor" href="#视频"></a> 视频</h2><p>在HTTP中，视频只是一个文件，可以通过一个URL和一个TCP连接得到。当获得的字节到了一定阈值之后，视频就开始播放，与此同时后台还在继续获取并缓存。</p><p>但是有些人的带宽小，有些人的带宽大，如果只有一种分辨率，难以满足所有人的需求。因此产生了HTTP的动态适应性流（DASH）。在DASH中，视频被编码为不同版本，并且有一个告示文件高速了各个版本的地址，用户首先申请告示文件然后再申请对应版本的视频。</p><h2 id="内容分发网cdn"><a class="markdownIt-Anchor" href="#内容分发网cdn"></a> 内容分发网（CDN）</h2><p>传统的视频提供会遇到一些问题。因为对于因特网视频公司，提供视频最直接的方法时建造数据中心，然后进行分发。但是这样当遇到距离遥远的客户时就可能因为某个服务器速度的限制导致传输速率非常低。其次重复数据可能多次经过相同链路分发多次，造成资源浪费。最后如果数据中心出现了某些故障那么将不能分发视频。</p><p>为了解决这些问题，视频供应商使用了内容分发网（content distribution network, CDN).CDN管理多个地理位置上的服务器，并且存储视频或其他内容</p><h3 id="cdn操作"><a class="markdownIt-Anchor" href="#cdn操作"></a> CDN操作</h3><p>CDN具体操作为</p><ol><li>通过DNS截获特定的URL</li><li>查找对应的CDN服务器</li><li>重定向到对应服务器</li></ol><p>例如： NetCineama想让KingCDN来替它分发视频。首先NetCinema的每个视频的URL都有video。例如： <code>http://video.netcinema.com/6Y3B32V</code>.接下来</p><ul><li>用户点击链接并且本地DNS服务器向NetCinema请求IP。该权威服务器发现主机名中有video。为了将该DNS请求给KingCDN，NetCinema返回一个KingCDN的主机名，<a href="http://xn--a1105-gv5i.kingcdn.com">如a1105.kingcdn.com</a></li><li>本地服务器继续发送请求，在KingCDN中返回CDN服务器的IP</li></ul><p><strong>集群选择策略</strong></p><p>前面说了CDN是分布式的。也就是说虽然定向到了CDN的权威服务器但是返回的IP不同最终速度也会大不相同。因此选择集群是非常重要的。</p><p>一种方式是地理上最为临近的集群。每个本地DNS服务器都有一个地理位置，DNS权威服务器返回离他最近的DNS服务器。但是地理距离近不等于网络距离近，还是要看经过的ISP数量。</p><p>另一种方法是进行周期性的实时测量。例如每隔一定时间就向全世界所有本地DNS发送合租来探测速度，但是可能本地DNS不会响应这些探测。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;http协议&quot;&gt;&lt;a class=&quot;markdownIt-Anch</summary>
      
    
    
    
    <category term="网络" scheme="http://xinhecuican.github.io/categories/%E7%BD%91%E7%BB%9C/"/>
    
    
  </entry>
  
  <entry>
    <title>DLL注入</title>
    <link href="http://xinhecuican.github.io/post/c82a1c99.html"/>
    <id>http://xinhecuican.github.io/post/c82a1c99.html</id>
    <published>2021-01-23T11:13:00.000Z</published>
    <updated>2021-01-25T01:36:57.257Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="消息钩子"><a class="markdownIt-Anchor" href="#消息钩子"></a> 消息钩子</h1><p>Windows操作系统GUI将键盘敲击，鼠标移动和点击，窗口大小和位置改变都看成事件（Event).消息传递过程大致为</p><ul><li>事件发生时，首先将这个事件添加到系统的[OS message queue]中</li><li>OS判断这个事件是在哪个应用程序中产生的，然后将这个事件添加到应用程序的消息队列中</li><li>应用程序对这些消息进行处理</li></ul><p>消息钩子就在这个传递链过程中添加一些函数，这些函数可以侦听事件甚至修改事件的参数。</p><h2 id="setwindowshookex"><a class="markdownIt-Anchor" href="#setwindowshookex"></a> SetWindowsHookEx</h2><p>这个API可以实现消息钩子，它的定义如下</p><figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">HHOOK SetWindowsHookEx</span><br><span class="line">&#123;</span><br><span class="line">    int idHoook<span class="comment">;</span></span><br><span class="line">    HOOKPROC lpfn<span class="comment">;</span></span><br><span class="line">    HINSTANCE hMod<span class="comment">;//这个程序所属DLL句柄</span></span><br><span class="line">    DOWRD dwThreadId<span class="comment">;//想要挂钩的线程Id</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="dll注入"><a class="markdownIt-Anchor" href="#dll注入"></a> DLL注入</h1><p>DLL注入指的是想运行中的进程强制插入DLL文件。具体来讲就是让其他进程调用LoadLibrary().</p><p><strong>具体方法</strong></p><ul><li>创建远程线程</li><li>使用注册表</li><li>消息勾取</li></ul><h2 id="创建远程线程"><a class="markdownIt-Anchor" href="#创建远程线程"></a> 创建远程线程</h2><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="built_in">bool</span> inject<span class="constructor">_dll(DWORD <span class="params">dwPID</span>, LPCTSTR <span class="params">szDllPath</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    HANDLE hProcess = NULL, hThread = NULL;</span><br><span class="line">      HMODULE hMod = NULL;</span><br><span class="line">      LPVOID pRemoteBuf = NULL;</span><br><span class="line">      DWORD dwBufSize = (DWORD)(<span class="constructor">_tcslen(<span class="params">szDllPath</span>)</span> + <span class="number">1</span>)<span class="operator"> * </span>sizeof(TCHAR);</span><br><span class="line">      LPTHREAD_START_ROUTINE pThreadProc;</span><br><span class="line">      <span class="comment">//获取notepade.exe句柄</span></span><br><span class="line">      <span class="keyword">if</span>(!(hProcess = <span class="constructor">OpenProcess(PROCESS_ALL_ACCESS, <span class="params">false</span>, <span class="params">dwPID</span>)</span>))</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="constructor">__tprintf(L<span class="string">&quot;OpenProcess(&amp;d) failed!!!&quot;</span>, <span class="params">dwPID</span>, GetLastError()</span>);</span><br><span class="line">          return <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//在notepad.exe中分配内存</span></span><br><span class="line">      pRemoteBuf = <span class="constructor">VirtualAllocEx(<span class="params">hProcess</span>, NULL, <span class="params">dwBufSize</span>, MEM_COMMIT, PAGE_READWRITE)</span>;</span><br><span class="line">      <span class="comment">//将myhack.dll写入内存</span></span><br><span class="line">      <span class="constructor">WriteProcessMemory(<span class="params">hProcess</span>, <span class="params">pRemoteBuf</span>, (LPVOID)</span>szDllPath, dwBufSize, NULL);</span><br><span class="line">      <span class="comment">//获取LoadLibraryW()的地址</span></span><br><span class="line">      hMod = <span class="constructor">GetModuleHandle(L<span class="string">&quot;kernel32.dll&quot;</span>)</span>;</span><br><span class="line">      pThreadProc = (LPTHREAD_START_ROUTINE)<span class="constructor">GetProcAddress(<span class="params">hMod</span>, <span class="string">&quot;LoadLibraryW&quot;</span>)</span>;</span><br><span class="line">      <span class="comment">//在notepad.exe中运行线程</span></span><br><span class="line">      hThread = <span class="constructor">CreateRemoteThread(<span class="params">hProcess</span>, NULL, 0, <span class="params">pThreadProc</span>, <span class="params">pRemoteBuf</span>, 0, NULL)</span>;</span><br><span class="line">      </span><br><span class="line">      <span class="constructor">WaitForSingleObject(<span class="params">hTread</span>, INFIINITE)</span>;</span><br><span class="line">      <span class="constructor">CloseHandle(<span class="params">hTread</span>)</span>;</span><br><span class="line">      <span class="constructor">CloseHandle(<span class="params">hProcess</span>)</span>;</span><br><span class="line">      return <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main(<span class="built_in">int</span> argc, <span class="built_in">char</span> *argv<span class="literal">[]</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(argc != <span class="number">3</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="constructor">_tprintf(L<span class="string">&quot;USAGE : %S PID dll_path\n&quot;</span>, <span class="params">argv</span>[0])</span>;</span><br><span class="line">        return <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="constructor">InjectDll((DWORD)</span><span class="constructor">_TSTOL(<span class="params">argv</span>[1])</span>, argv<span class="literal">[<span class="number">2</span>]</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="constructor">_tprintf(L<span class="string">&quot;InjectDll(\&quot;&quot;</span>%<span class="params">s</span>\<span class="string">&quot;) success!!!\n&quot;</span>, <span class="params">argv</span>[2])</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="constructor">_tprintf(L<span class="string">&quot;InjectDll(\&quot;%s\&quot;) failed!!!\n&quot;</span>, <span class="params">argv</span>[2])</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    return <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>OpenProcess(PROCESS_ALL_ACCESS, false, dwPID): 获得目标进程句柄.第一个参数是获得所有权限，最后一个是程序运行时传过来的</li><li>VirtualAllocEx， WriteProcessMemory: 将dll写入进程</li><li>GetModuleHandle, GetProceAddress: 获得LoadLibraryW()API的地址</li><li>CreateRemoteThread: 远程运行线程</li></ul><h2 id="使用注册表"><a class="markdownIt-Anchor" href="#使用注册表"></a> 使用注册表</h2><p>Windows操作系统中默认提供AppInit_DLLs和LoadAppInit_DLLs两个注册表项</p><p>大致过程为将要注入的DLL的路径字符串吸入AppInit_DLLs项目，然后把LoadAppInit_DLLs项目值设为1.</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEF_CMD <span class="meta-string">L&quot;c:\\Program Files\\Internet Explorer\\iexplore.exe&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEF_ADDR <span class="meta-string">L&quot;http://www.naver.com&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEF_DST_PROC <span class="meta-string">L&quot;notepad.exe&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">BOOL WINAPI <span class="title">DllMain</span><span class="params">(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReaseved)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    TCHAR szCmd[MAX_PATH] = &#123;<span class="number">0</span>, &#125;;</span><br><span class="line">    TCHAR szPath[MAX_PATH] = &#123;<span class="number">0</span>, &#125;;</span><br><span class="line">    TCHAR *p = <span class="literal">NULL</span>;</span><br><span class="line">    STARTUPINFO si = &#123;<span class="number">0</span>,&#125;;</span><br><span class="line">    </span><br><span class="line">    si.cb = <span class="keyword">sizeof</span>(STARTUPINFO);</span><br><span class="line">    si.dwFlags = STARTF_SUESHOWWINDOW;</span><br><span class="line">    si.wShowWindow = SW_HIDE;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">switch</span>(fdwReason)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> DLL_PROCESS_ATTACH:</span><br><span class="line">          <span class="keyword">if</span>(!GetModuleFileName(<span class="literal">NULL</span>, szPath, MAX_PATH))</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          </span><br><span class="line">          <span class="keyword">if</span>(!(p == _tcsrchr(szPath, <span class="string">&#x27;\\&#x27;</span>)))</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          </span><br><span class="line">          <span class="keyword">if</span>(_tcsicmp(p+<span class="number">1</span>, DEF_DST_PROC))</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          </span><br><span class="line">          wsprintf(szCmd, <span class="string">L&quot;%s %s&quot;</span>, DEF_CMD, DEF_ADDR);</span><br><span class="line">          <span class="keyword">if</span>(!CreateProcess(<span class="literal">NULL</span>, (LPTSTR)(LPCTSTR)szCmd, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">false</span>, NORMAL_PRIOPRITY_CLASS, <span class="literal">NULL</span>, <span class="literal">NULL</span>, &amp;si, &amp;pi))</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          </span><br><span class="line">          <span class="keyword">if</span>(pi.hProcess != <span class="literal">NULL</span>)</span><br><span class="line">          &#123;</span><br><span class="line">              CloseHandle(pi.hProcess);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>这段代码的作用是判断当前加载进程是否是notepad.exe,如果是就运行IE链接网址</p><p>接下来要做的就是将DLL信息写进注册表项中。</p><h1 id="dll卸载"><a class="markdownIt-Anchor" href="#dll卸载"></a> DLL卸载</h1><p>DLL卸载就是要让进程调用FreeLibrary()API。</p><ul><li>CreateToolhelp32Snapshot(TH32CS_SNAPMODULE, dwPID): 这个函数的作用是获得加载到进程的DLL信息。返回值是一个句柄，传递给Module32First(返回值, &amp;information)后，就可以在information中获得dll相关信息</li></ul> <figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line">typedef struct tagMODULEENTRY32</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">DWORD</span> dwSize<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> th32ModuleID<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> th32ProcessID<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> GlblcntUsage<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> ProccntUsage<span class="comment">;</span></span><br><span class="line">    <span class="built_in">BYTE</span> *modBaseAddr<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> modBaseSize<span class="comment">;</span></span><br><span class="line">    HMODULE hModule<span class="comment">;</span></span><br><span class="line">    char szModule[MAX_MODULE_NAME32 + <span class="number">1</span>]<span class="comment">;</span></span><br><span class="line">    CHAR szExePath[MAX_PATH]<span class="comment">;</span></span><br><span class="line">&#125;MODULEENTRY32<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>上面就是information结构体的具体内容。szModule是这个dll的名称</p><ul><li>OpenProcess(PROCESS_ALL_ACCESS, FLASE, dwPID): 获得目标进程的句柄</li><li>GetModuleHandle(“kernel32.dll”)</li><li>(LPTHREAD_START_ROUNTINE)GetProcAddress(hModule, “FreeLibrary”):上面两个是获取FreeeLibrary的地址</li><li>CreateRemoteThread(hProcess, NULL, 0, pThreadProc, information.modBaseAddr, 0, NULL): hThreadProc是FreeLibrary的API地址， modBaseAddr是需要卸载的API地址</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;消息钩子&quot;&gt;&lt;a class=&quot;markdownIt-Anchor</summary>
      
    
    
    
    <category term="逆向" scheme="http://xinhecuican.github.io/categories/%E9%80%86%E5%90%91/"/>
    
    
  </entry>
  
  <entry>
    <title>矩阵运算</title>
    <link href="http://xinhecuican.github.io/post/67454659.html"/>
    <id>http://xinhecuican.github.io/post/67454659.html</id>
    <published>2021-01-21T06:15:00.000Z</published>
    <updated>2021-01-22T13:06:27.796Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="lup分解求线性方程组"><a class="markdownIt-Anchor" href="#lup分解求线性方程组"></a> LUP分解求线性方程组</h1><p>L、U、P是三个矩阵，满足PA = LU。其中L矩阵是一个单位下三角矩阵，U是一个上三角矩阵，P是一个置换矩阵。</p><p>我们要求解的是A x = b</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>P</mi><mi>A</mi><mi>x</mi><mo>=</mo><mi>P</mi><mi>b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>L</mi><mi>U</mi><mi>x</mi><mo>=</mo><mi>P</mi><mi>b</mi><mo stretchy="false">(</mo><mi mathvariant="normal">根</mi><mi mathvariant="normal">据</mi><mi mathvariant="normal">上</mi><mi mathvariant="normal">面</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">式</mi><mi mathvariant="normal">子</mi><mi mathvariant="normal">替</mi><mi mathvariant="normal">换</mi><mi mathvariant="normal">）</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">令</mi><mi>U</mi><mi>x</mi><mo>=</mo><mi>y</mi><mi mathvariant="normal">得</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>L</mi><mi>y</mi><mo>=</mo><mi>P</mi><mi>b</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}&amp; Ax = b\\&amp; PAx = Pb\\&amp; LUx = Pb(根据上面的式子替换） \\&amp; 令Ux = y 得 \\&amp; Ly = Pb \\\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.500000000000002em;vertical-align:-3.5000000000000018em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4em;"><span style="top:-6em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-4.499999999999999em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.9999999999999982em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-1.4999999999999982em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:1.7763568394002505e-15em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5000000000000018em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4em;"><span style="top:-6.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">b</span></span></span><span style="top:-4.659999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault">A</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault">b</span></span></span><span style="top:-3.1599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord cjk_fallback">根</span><span class="mord cjk_fallback">据</span><span class="mord cjk_fallback">上</span><span class="mord cjk_fallback">面</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">式</span><span class="mord cjk_fallback">子</span><span class="mord cjk_fallback">替</span><span class="mord cjk_fallback">换</span><span class="mord cjk_fallback">）</span></span></span><span style="top:-1.6599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord cjk_fallback">令</span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord cjk_fallback">得</span></span></span><span style="top:-0.15999999999999837em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5000000000000018em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h2 id="正向替换"><a class="markdownIt-Anchor" href="#正向替换"></a> 正向替换</h2><p>正向替换的目标是通过Ly = Pb来求y</p><p>我们可以使用一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>π</mi><mo stretchy="false">[</mo><mn>1...</mn><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\pi [1...n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mopen">[</span><span class="mord">1</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord mathdefault">n</span><span class="mclose">]</span></span></span></span>来替换P。 对i = 1, 2, …, n, 元素<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\pi [i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span>表示<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">P_{i,\pi [i]} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span><span class="mopen mtight">[</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>(第i行第<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\pi [i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span>列）。由于L是单位下三角矩阵，所以可以将式子写成</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>y</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><msub><mi>b</mi><mrow><mi>π</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>y</mi><mn>2</mn></msub><msub><mi>l</mi><mn>21</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>+</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><msub><mi>b</mi><mrow><mi>π</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>y</mi><mn>3</mn></msub><msub><mi>l</mi><mn>31</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>+</mo><msub><mi>y</mi><mn>3</mn></msub><msub><mi>l</mi><mn>32</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>+</mo><msub><mi>y</mi><mn>3</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><msub><mi>b</mi><mrow><mi>π</mi><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>y</mi><mn>4</mn></msub><msub><mi>l</mi><mn>41</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>+</mo><msub><mi>y</mi><mn>4</mn></msub><msub><mi>l</mi><mn>42</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>+</mo><msub><mi>y</mi><mn>4</mn></msub><msub><mi>l</mi><mn>43</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>+</mo><msub><mi>y</mi><mn>4</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><msub><mi>b</mi><mrow><mi>π</mi><mo stretchy="false">[</mo><mn>4</mn><mo stretchy="false">]</mo></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix}y_1 &amp; &amp; &amp; &amp;= b_{\pi [1]}\\y_2 l_{21} &amp;+ y_2 &amp; &amp; &amp;= b_{\pi [2]}\\y_3 l_{31} &amp;+ y_3 l_{32} &amp;+ y_3 &amp;  &amp;= b_{\pi [3]}\\y_4 l_{41} &amp;+ y_4 l_{42} &amp;+ y_4 l_{43} &amp;+ y_4 &amp;= b_{\pi [4]}\\...\end{matrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.000000000000001em;vertical-align:-2.7500000000000004em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.6099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">+</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">+</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">+</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">+</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">+</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.8099999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">+</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em;"><span style="top:-5.410000000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span><span class="mopen mtight">[</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span><span class="mopen mtight">[</span><span class="mord mtight">2</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span><span class="mopen mtight">[</span><span class="mord mtight">3</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span><span class="mopen mtight">[</span><span class="mord mtight">4</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000003em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>可以求出 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><msub><mi>b</mi><mrow><mi>π</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msub></mrow><annotation encoding="application/x-tex">y_1 = b_{\pi [1]}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.04964em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span><span class="mopen mtight">[</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span>，之后将<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>代入第二个式子可以求出<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">y_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，然后依次代入可以求出所有的y</p><p>然后可以求出<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">y_1, y_2...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span> 得 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>b</mi><mrow><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></msub><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>l</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>y</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">y_i = b_{\pi [i]} - \sum_{j=1}^{i-1} l_{ij}y_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.04964em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span><span class="mopen mtight">[</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.400382em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.964564em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></p><h2 id="反向替换"><a class="markdownIt-Anchor" href="#反向替换"></a> 反向替换</h2><p>反向替换目标是通过 Ux = y求x</p><p>与之对应，过程不再细说。结果是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>u</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><msub><mi>u</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_i = ( y_i - \sum_{j=i+1}^{n} u_{ij}x_j ) / u_{ii}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.24011em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><h2 id="lu分解"><a class="markdownIt-Anchor" href="#lu分解"></a> LU分解</h2><p>我们计算出 A = LU，则称这两个矩阵是A的一个LU分解</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mrow><mn>1</mn><mi>n</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>22</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mrow><mn>2</mn><mi>n</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mrow><mi>n</mi><mn>2</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mrow><mi>n</mi><mi>n</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>ω</mi><mi>T</mi></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>v</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>A</mi><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>v</mi><mi mathvariant="normal">/</mi><msub><mi>a</mi><mn>11</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>E</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>ω</mi><mi>T</mi></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mi>A</mi><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msup><mo>−</mo><mi>v</mi><msup><mi>ω</mi><mi>T</mi></msup><mi mathvariant="normal">/</mi><msub><mi>a</mi><mn>11</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>v</mi><mi mathvariant="normal">/</mi><msub><mi>a</mi><mn>11</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>L</mi><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>ω</mi><mi>T</mi></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>U</mi><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\begin{bmatrix}  a_{11}&amp; a_{12} &amp; ... &amp; a_{1n}\\  a_{21}&amp; a_{22} &amp; ... &amp; a_{2n}\\  \vdots&amp;  \vdots&amp; \ddots &amp; \vdots \\  a_{n1}&amp; a_{n2} &amp; ... &amp; a_{nn}\end{bmatrix}&amp;=\begin{bmatrix} a_{11} &amp; \omega^T \\ v  &amp; A^{&#x27;}\end{bmatrix}\\&amp;=\begin{bmatrix} 1 &amp; 0\\ v/a_{11} &amp; E_{n-1}\end{bmatrix}\begin{bmatrix} a_{11} &amp; \omega^T\\ 0 &amp; A^{&#x27;} - v \omega^T / a_{11}\end{bmatrix}\\&amp;=\begin{bmatrix} 1 &amp; 0\\ v/a_{11} &amp; L^{&#x27;}\end{bmatrix}\begin{bmatrix} a_{11} &amp; \omega^T\\ 0 &amp; U^{&#x27;}\end{bmatrix}\\\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:11.367621999999999em;vertical-align:-5.4338109999999995em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.9338109999999995em;"><span style="top:-7.9338109999999995em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953005em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.5049850000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.1059850000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.7069850000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.953005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.64em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span><span style="top:-4.44em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span><span style="top:-2.5799999999999996em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-1.3800000000000006em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953005em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.5049850000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.1059850000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.7069850000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.953005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.6519055em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"></span></span><span style="top:-0.8480945em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.4338109999999995em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.9338109999999995em;"><span style="top:-7.9338109999999995em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5019055em;"><span style="top:-3.6605744999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.3580945em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0019055em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5019055em;"><span style="top:-3.6605744999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span><span style="top:-2.3580945em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-2.94248em;margin-right:0.05em;"><span class="pstrut" style="height:2.57948em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0019055em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span><span style="top:-3.6519055em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5019055em;"><span style="top:-3.6605744999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.3580945em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0019055em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5019055em;"><span style="top:-3.6605744999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span><span style="top:-2.3580945em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-2.94248em;margin-right:0.05em;"><span class="pstrut" style="height:2.57948em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0019055em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span><span style="top:-0.8480945em;"><span class="pstrut" style="height:4.9799999999999995em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.50124em;"><span style="top:-3.66124em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.3587599999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0012400000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.50124em;"><span style="top:-3.66124em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.3587599999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-2.94248em;margin-right:0.05em;"><span class="pstrut" style="height:2.57948em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0012400000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5019055em;"><span style="top:-3.6605744999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.3580945em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0019055em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5019055em;"><span style="top:-3.6605744999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span><span style="top:-2.3580945em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-2.94248em;margin-right:0.05em;"><span class="pstrut" style="height:2.57948em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0019055em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.4338109999999995em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中v是n-1的列向量， <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>ω</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\omega^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>是n-1的行向量.</p><p>最后一步是因为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>A</mi><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msup><mo>−</mo><mi>v</mi><msup><mi>ω</mi><mi>T</mi></msup><mi mathvariant="normal">/</mi><msub><mi>a</mi><mn>11</mn></msub></mrow><annotation encoding="application/x-tex">A^{&#x27;} - v \omega^T / a_{11}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0258099999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-2.94248em;margin-right:0.05em;"><span class="pstrut" style="height:2.57948em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>也可以进行分解，并且分解的结果是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>L</mi><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msup><msup><mi>U</mi><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msup></mrow><annotation encoding="application/x-tex">L^{&#x27;}U^{&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.94248em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-2.94248em;margin-right:0.05em;"><span class="pstrut" style="height:2.57948em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-2.94248em;margin-right:0.05em;"><span class="pstrut" style="height:2.57948em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><figure class="highlight inform7"><table><tr><td class="code"><pre><span class="line">for(int i=0; i&lt;n; i++)</span><br><span class="line">&#123;</span><br><span class="line">    u<span class="comment">[i]</span><span class="comment">[i]</span> = a<span class="comment">[i]</span><span class="comment">[i]</span>;</span><br><span class="line">    for(int k=i+1; k&lt;n; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        l<span class="comment">[i]</span><span class="comment">[k]</span> = a<span class="comment">[i]</span><span class="comment">[k]</span> / u<span class="comment">[i]</span><span class="comment">[i]</span>;</span><br><span class="line">        u<span class="comment">[k]</span><span class="comment">[i]</span> = a<span class="comment">[k]</span><span class="comment">[i]</span>;</span><br><span class="line">        for(int k=i+1; k&lt;n; k++)</span><br><span class="line">        &#123;</span><br><span class="line">            for(int j=k+1; j&lt;n; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                a<span class="comment">[i]</span><span class="comment">[j]</span> = a<span class="comment">[i]</span><span class="comment">[j]</span> - l<span class="comment">[i]</span><span class="comment">[k]</span> * u<span class="comment">[k]</span><span class="comment">[j]</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>他有一个限制条件u[i][i]不能是0，否则会出现除0错误</p><h2 id="lup分解"><a class="markdownIt-Anchor" href="#lup分解"></a> LUP分解</h2><p>为了保证a[i][i] != 0, 我们可以使用该列中最大元素a[k][1]替换a[1][1],为了使方程组还成立，我们可以将第1行和第k行互换，等价于用一个置换矩阵Q乘在A的左边</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mi>A</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>v</mi><mi mathvariant="normal">/</mi><msub><mi>a</mi><mrow><mi>k</mi><mn>1</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>E</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mrow><mi>k</mi><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>ω</mi><mi>T</mi></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mi>A</mi><msup><mrow></mrow><mo mathvariant="normal">′</mo></msup></msup><mo>−</mo><mi>v</mi><msup><mi>ω</mi><mi>T</mi></msup><mi mathvariant="normal">/</mi><msub><mi>a</mi><mrow><mi>k</mi><mn>1</mn></mrow></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">QA = \begin{bmatrix} 1 &amp; 0\\ v/a_{k1} &amp; E_{n-1}\end{bmatrix}\begin{bmatrix} a_{k1} &amp; \omega^T\\ 0 &amp; A^{&#x27;} - v \omega ^{T} / a_{k1}\end{bmatrix}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.503811em;vertical-align:-1.0019055em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5019055em;"><span style="top:-3.6605744999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.3580945em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0019055em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5019055em;"><span style="top:-3.6605744999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span><span style="top:-2.3580945em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-2.94248em;margin-right:0.05em;"><span class="pstrut" style="height:2.57948em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0019055em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span><span class="mspace newline"></span></span></span></span></p><p>和上面类似，就是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>11</mn></msub></mrow><annotation encoding="application/x-tex">a_{11}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>变成了<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mrow><mi>k</mi><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">a_{k1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><h1 id="矩阵求逆"><a class="markdownIt-Anchor" href="#矩阵求逆"></a> 矩阵求逆</h1><p>矩阵求逆也可以使用LUP分解 我们可以令 AX = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>E</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">E_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>E</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">E_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是n阶单位矩阵.X是n个列向量的和</p><p>我们可以把它看成n个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><msub><mi>E</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">AX_i = E_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault">A</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>来进行求解，然后最后将<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>合并即可</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;lup分解求线性方程组&quot;&gt;&lt;a class=&quot;markdownIt</summary>
      
    
    
    
    <category term="数学" scheme="http://xinhecuican.github.io/categories/%E6%95%B0%E5%AD%A6/"/>
    
    
  </entry>
  
  <entry>
    <title>PE文件格式</title>
    <link href="http://xinhecuican.github.io/post/16e2846c.html"/>
    <id>http://xinhecuican.github.io/post/16e2846c.html</id>
    <published>2021-01-19T01:46:00.000Z</published>
    <updated>2021-01-20T08:31:21.814Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>PE文件时windows中的32位可执行文件。在linux中是<a href="https://xinhecuican.github.io/post/4551c130.html">elf</a>。如exe，dll，scr等都是PE文件</p><h1 id="基本结构"><a class="markdownIt-Anchor" href="#基本结构"></a> 基本结构</h1><p><img src="/images/PE%E6%96%87%E4%BB%B61.jpg" alt="" /></p><p>PE文件中的RVA（相对虚拟地址）一般不是直接转换到真实的虚拟地址的，还要加上一个基准地址（ImageBase).也就是说VA = RVA + ImageBase</p><p>这样做主要是因为DLL，DLL动态链接时如果发现这个虚拟地址已经有其他的dll了，那么就要进行重定位到其他位置，如果没有ImageBase那么重定位是很麻烦的。</p><h2 id="pe头"><a class="markdownIt-Anchor" href="#pe头"></a> PE头</h2><h2 id="dos头"><a class="markdownIt-Anchor" href="#dos头"></a> DOS头</h2><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line">typedef struct _IMAGE_DOS_HEADER</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">WORD</span> e_magic<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_cblp<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_cp<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_crlc<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_cpaarhdr<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_minalloc<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_maxalloc<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_ss<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_sp<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_csum<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_ip</span><br><span class="line">    <span class="built_in">WORD</span> e_cs<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_lfarlc<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_ovno<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_res[<span class="number">4</span>]<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_oemid<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_oeminfo<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_res2[<span class="number">10</span>]<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> e_lfanew<span class="comment">;</span></span><br><span class="line">&#125;IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>上面就是dos头的结构。</p><ul><li>e_magic: DOS签名(魔数）也就是4D5A（ascii的MZ）</li><li>e_lfanew: 指示NT头的偏移（NT头位置）</li></ul><h3 id="nt头"><a class="markdownIt-Anchor" href="#nt头"></a> NT头</h3><p>结构体：</p><figure class="highlight thrift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_NT_HEADERS</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    DWORD Signature;</span><br><span class="line">    IMAGE_FILE_HEADER FileHeader;</span><br><span class="line">    IMAGE_OPTIONAL_HEADER32 OptionalHeader;</span><br><span class="line">&#125;IMAGE_NT_HEADER32, *PIMAGE_NT_HEADERS32;</span><br></pre></td></tr></table></figure><ul><li>Signature: 签名（50450000h)</li></ul><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line">typedef struct _MIAGE_FILE_HEADER</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">WORD</span> Mechine<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> NumberOfSections<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> TimeDateStamp<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> PointerToSymbolTable<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> NumberOfSymbols<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> SizeOfOptionalHeader<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> Characteristics<span class="comment">;</span></span><br><span class="line">&#125;IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER<span class="comment">;</span></span><br></pre></td></tr></table></figure><ul><li>Machine: 机器型号码，例如Intel x86是14c。</li><li>NumerOfSections： 节的数量</li><li>SizeOfOptionalHeader</li><li>Characteristics: 用来标识文件的属性，文件是否处于可运行状态，是否是dll文件。</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">在winnt.h中有Characterristics的信息</span><br><span class="line">IMAGE_FILE_RELOCS_STPIPPED 0X001</span><br><span class="line">IMAGE_FILE_EXECUATABLE_IMAGE 0X002</span><br><span class="line">IMAGE_FILE_LINE_NUMS_STRIPPED 0X004</span><br><span class="line">IMAGE_FILE_LOCAL_SYMS_STRIPPED 0X008</span><br><span class="line">IMAGE_FILE_AGGRSIVE_WS_TRIM 0X0010</span><br><span class="line">IMAGE_FILE_LARGE_ADDRESS_AWARE 0X0020</span><br><span class="line">IMAGE_FILE_BYTES_REVERSED_L0 0X0080</span><br><span class="line">IMAGE_FILE_32BIT_MACHINE 0X0100</span><br><span class="line">IMAGE_FILE_DEBUG_STRIPPED 0X200</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>可选头，结构体为IMAGE_OPTIONAL_HEADER32，重要成员有9个：</p><ul><li>Magic：IMAGE_OPTIONAL_HEADER32为10B，IMAGE_OPTIONAL_HEADER64为20B</li><li>AddressOfEntryPoint：持有EP的RVA值，指出程序最先执行的代码起始地址</li><li>ImageBase：指出文件的优先装入地址（32位进程虚拟内存范围为：0～7FFFFFFF）</li><li>SectionAlignment,FileAlignment：前者制定了节区在内存中的最小单位，后者制定了节区在磁盘文件中的最小单位</li><li>SizeOfImage：指定了PE Image在虚拟内存中所占空间的大小</li><li>SizeOfHeaders：指出整个PE头的大小</li><li>Subsystem：区分系统驱动文件和普通可执行文件</li><li>NumberOfRvaAndSize：指定DataDirectory数组的个数</li><li>DataDirectory：由IMAGE_DATA_DIRECTORY结构体组成的数组</li></ul><h3 id="节区头"><a class="markdownIt-Anchor" href="#节区头"></a> 节区头</h3><figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line">typedef <span class="class"><span class="keyword">struct</span> <span class="title">_MIAGE_SECTION_HEADER</span></span></span><br><span class="line">&#123;</span><br><span class="line">    BYTE Name[IMAGE_SIZEOF_SHORT_NAME];</span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        DWORD PhysicalAddress;</span><br><span class="line">        DWORD VirtualSize;</span><br><span class="line">    &#125;</span><br><span class="line">    DWORD VirtualAddress;</span><br><span class="line">    DWORD SizeOfRawData;</span><br><span class="line">    DWORD PointerToRawData;</span><br><span class="line">    DWORD PointerToRelacations;</span><br><span class="line">    DWORD PointerToLinenumbers;</span><br><span class="line">    WORD NumberOfRelocations;</span><br><span class="line">    WORD NumberOfLinenumbers;</span><br><span class="line">    DWORD Characteristics;</span><br><span class="line">&#125;IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;</span><br></pre></td></tr></table></figure><ul><li>VirtualSize: 节区所占大小</li><li>VirtualAddress： 节区起始位置</li><li>SizeOfRawData： 磁盘中的大小</li><li>PointerToRwaData： 磁盘中的位置</li><li>Characteristics： 节区.属性</li></ul><p>虚拟地址与内存地址之间的转换关系为<code>RAW - PointerToRawData = RVA - VirtualAddress</code></p><p>其中RAW是文件偏移，PointerToRawData是该节在文件中的首地址。RVA是在内存中的地址，VirtualAddress是在节在内存中的首地址</p><h2 id="iat导入地址表"><a class="markdownIt-Anchor" href="#iat导入地址表"></a> IAT（导入地址表）</h2><p>IAT是记录程序正在使用库中那些函数的表。</p><h3 id="dll"><a class="markdownIt-Anchor" href="#dll"></a> DLL</h3><p>为了理解IAT，首先要了解DLL（动态链接库，<a href="http://xn--linux-9n1hh05crl2a.so">在linux中是.so</a>).它是在程序运行时<a href="https://xinhecuican.github.io/post/4551c130.html">动态加载的，而不是在链接过程中加载的</a>。</p><h3 id="image_import_descriptor"><a class="markdownIt-Anchor" href="#image_import_descriptor"></a> IMAGE_IMPORT_DESCRIPTOR</h3><p>这个表记录了要导入那些头文件.它的结构体数组的首地址是IMAGE_OPTIONAL_HEADER32.DataDirectory[1].VirtualAddress</p><figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line">typedef <span class="class"><span class="keyword">struct</span> <span class="title">_IMAGE_IMPORT_DESCRIPTOR</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        DWORD Characteristics;</span><br><span class="line">        DWORD OriginalFirstThubk;</span><br><span class="line">    &#125;;</span><br><span class="line">    DWORD TimeDateStamp;</span><br><span class="line">    DWORD ForwarderChain;</span><br><span class="line">    DWORD Name;</span><br><span class="line">    DWORD FirstThunk;</span><br><span class="line">&#125;;IMAGE_IMPORT_DESCRIPTOR;</span><br><span class="line"></span><br><span class="line">typedef <span class="class"><span class="keyword">struct</span> <span class="title">_IMAGE_IMPORT_BY_NAME</span></span></span><br><span class="line">&#123;</span><br><span class="line">    WORD Hint;</span><br><span class="line">    BYTE Name[<span class="number">1</span>];</span><br><span class="line">&#125;IMAGE_IMPORT_BY_NAME, *PIMAGE_IMPORT_BY_NAME;</span><br></pre></td></tr></table></figure><p>每一个导入的库的信息使用用一个IMAGE_IMPORT_DESCRIPTOR进行描述</p><ul><li>OriginalFirstThunk： INT地址（RVA）</li><li>Nam： 库名称字符串的<strong>地址</strong>（RVA）</li><li>FirstThunk： IAT地址（RVA）</li><li>OriginalFirstThunk(INT): INT是包含导入函数信息的结构体指针数组，只有获得了这些信息才有可能在加载到进程的库中获得函数首地址。</li></ul><h2 id="eat"><a class="markdownIt-Anchor" href="#eat"></a> EAT</h2><p>EAT是dll库用来提供函数地址的，IAT记录了导入的dll库的函数地址。</p><p>与IAT不同EAT只有一个，位置在IMAGE_OPTIONAL_HEADER32.DataDirectory[0].VirtualAddress中</p><figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line">typedef struct _IMAGE_EXPORT_DIRECTORY</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">DWORD</span> Characteristics<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> TimeDateStamp<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> MajorVersion<span class="comment">;</span></span><br><span class="line">    <span class="built_in">WORD</span> MinorVersion<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> Name<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> Base<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> NumberOfFunctions<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> NumberOfNames<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> AddressOfFuctions<span class="comment">;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">DWORD</span> AddressOfNames<span class="comment">;</span></span><br><span class="line">    <span class="built_in">DWORD</span> AddressOfNameOrdinals<span class="comment">;</span></span><br><span class="line">&#125;IMAGE_EXPORT_DIRECTORY, *PIMAGE_EXPORT_DIRECTORY<span class="comment">;</span></span><br></pre></td></tr></table></figure><ul><li>NumberOfFunctions: 实际Export函数个数</li><li>NumberOfNames： 实际有名字函数个数</li><li>AddressOfFunctions： Export函数地址数组</li><li>AddressOfNames： 函数名称地址数组</li><li>AddressOfNameOrdinals： Ordinal地址数组</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;p&gt;PE文件时windows中的32位可执行文件。在linux中是&lt;a href</summary>
      
    
    
    
    <category term="计算机系统基础" scheme="http://xinhecuican.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/"/>
    
    
  </entry>
  
</feed>
